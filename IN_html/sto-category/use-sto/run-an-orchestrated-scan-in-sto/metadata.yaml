type: article
article_id: wk018r6x3g
user_id: xwmdbyp4x8
category_id: utstv3qzqt
author:
  name: Doug Bothwell
  email: douglas.bothwell@harness.io
  profile_image: https://www.gravatar.com/avatar/120de2cc624d7903cf3d83b86d0f1b5e?d=mm&s=150
title: Run an Orchestrated Scan in an STO Pipeline
slug: run-an-orchestrated-scan-in-sto
description: An orchestrated scan is a fully automated workflow that scans an object
  and ingests the results into Harness in one Security step. Orchestrated scans are
  the easiest to set up and are a great way to get started with STO.
short_version: An orchestrated scan is a fully automated workflow that scans an object
  and ingests the results into Harness in one Security step. Orchestrated scans are
  the easiest to set up and are a great way to get started with STO.
tags: []
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: ""
  source: API
  triggered_at: 2022-09-20T23:32:24.395426Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Run an Orchestrated Scan in an STO Pipeline
  description: An orchestrated scan is a fully automated workflow that scans an object
    and ingests the results into Harness in one Security step. Orchestrated scans
    are the easiest to set up and are a great way to get started with STO.
  short_version: An orchestrated scan is a fully automated workflow that scans an
    object and ingests the results into Harness in one Security step. Orchestrated
    scans are the easiest to set up and are a great way to get started with STO.
  body: '<p>An <em>orchestrated scan</em> is a fully automated workflow that scans
    an object and ingests the results into Harness in one Security step. Orchestrated
    scans are the easiest to set up and are a great way to get started with STO.</p><p>STO
    supports orchestrated scan for popular open-source scanners such as Aqua-Trivy
    and Bandit as well as commercial scanners such as SonarQube.</p><p>In the following
    example workflow, you will clone the base pipeline created in <a href="https://docs.harness.io/article/rlbw5luj4h"
    target="_blank">Set up Harness for STO</a> and configure it to scan a Docker image
    using Aqua Trivy.</p><ol><li>In the Pipeline Studio, go to the project where you
    create your base pipeline. Click the top-right menu, choose <strong>Clone</strong>,
    and save the new pipeline as <strong>Trivy Image Scan Orchestrated</strong>.</li><li>In
    your new pipeline, go to <strong>securityTestStage</strong> and open the <strong>banditScan</strong>
    step.</li><li>Rename the step to <strong>ScanContainerImage</strong>.</li></ol><h3>Scan
    settings</h3><p>Orchestrated scan settings generall fall into two categories:
    information about the scan operation, and information about the object to scan.</p><p>Specify
    the following:</p><ol><li>The scanner to use: <code>product_name</code> = <code>aqua-trivy</code></li><li>The
    scanner settings to use: <code>product_config_name</code> = <code>aqua-trivy</code></li><li>The
    scan type: <code>policy_type</code> = <code>orchestratedScan</code></li></ol><h3>Scanned
    object settings</h3><p>Now you can specify the object to scan. In this example,
    you&#39;ll scan an image on Docker Hub based on the <a href="https://github.com/anxolerd/dvpwa"
    target="_blank">DVPWA</a> GitHub project. Specify the following:</p><ol><li>The
    object type to scan: <code>scan_type</code> = <code>container</code></li><li>The
    type of container to scan â€” in this case, we&#39;re scanning a Docker v2 image:
    <code>container_type</code> = <code>docker_v2</code></li><li>The registry domain
    that hosts the image: <code>container_domain</code> = <code>docker.io</code></li><li>The
    image to pull (<code>container_project</code> setting).<br/>This is based on the
    image you would specify using the <code>docker pull</code> command. In this example,
    you will scan the latest <a href="https://hub.docker.com/_/ubuntu/tags" target="_blank">ubuntu
    image</a>. The command to pull this is:<br/><code>docker pull ubuntu:latest</code><br/>
    Therefore, specify: <code>container_project</code> = <code>ubuntu</code></li><li>The
    image tag. In this case, enter: <code>container_tag</code> = <code>latest</code></li></ol><h3>Save
    the pipeline and run the scan</h3><p>Now that you&#39;ve set up the Security step
    with the previous settings, you can save and run the pipeline. When the pipeline
    finishes, click <strong>Security Tests</strong> to view the results.</p><p></p><figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/wk018r6x3g/1663026232234/orchestrated-scan-results.png"/></figure><p></p><p></p><h3>See
    Also</h3><ul><li><a href="https://docs.harness.io/article/cjqnd71y07" target="_blank">STO
    Ingestion Workflows</a></li><li><a href="https://docs.harness.io/article/d24n34qdbk">Ingest
    Scan Results into an STO Pipeline</a></li><li><a href="https://docs.harness.io/article/0k0iubnzql"
    target="_blank">Security Step Settings Reference</a></li></ul><p></p>'
  slug: run-an-orchestrated-scan-in-sto
  tags: []
  is_live: true
