<p></p><p>You can ingest custom Issues from any scanning tool. This topic describes how to ingest data from scan tools that currently have no integration in STO.</p><p>By ingesting your custom Issues, you can benefit from STO&#39;s refinement, deduplication, and correlation features. Harness handles your issue data the same way as data from supported scanners.</p><h3> Requirements</h3><ul><li>You have a valid STO license and access to the Harness platform.</li><li>You have a JSON file of the issues you want to ingest. The data file must match the <a href="#json-data-format-reference">JSON format</a> specified below.</li></ul><h3>Required Steps</h3><ol><li>In your Harness pipeline, go to the Overview tab of the security stage and enter a shared path such as <code>/shared/customer_artifacts</code>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ijkyokxrot/1661880426879/sto-pipeline-shared-path.png" style="max-height:50%;max-width:50%;display:block;margin-left:0;margin-right:auto" data-hd-height="50%" data-hd-width="50%" data-hd-align="left"/></figure></li><li>Generate your issues data in the <a href="#jaon-data-format-reference">required JSON format</a> described below and then save it in the shared folder.<br/>You might want to set up a Run step to generate your scans automatically whenever the pipeline runs. Go to <a href="https://docs.harness.io/article/d24n34qdbk" target="_blank">Set up ingestionOnly in an STO pipeline</a> for an example.</li><li>Add a Security step and configure the scanner to ingest the results of the scan. These settings are required:<ol><li><code>policy_type</code> = <code>ingestionOnly</code></li><li><code>scan_type</code> — The type the scanned object: <code>container</code>, <code>repository</code>, <code>instance</code>, or <code>configuration</code></li><li><code>product_name</code> = <code>external</code></li><li><code>product_config_name</code> = <code>default</code></li><li><code>manual_upload_filename</code> — The filename of your issues data file.</li><li><code>customer_artifacts_path</code> — The shared folder for the issues data file.</li></ol></li></ol><h3 id="json-data-format-reference"> JSON data format reference</h3><p>The following example illustrates the required format for your data:</p><pre class="hljs json">{<br/>   &#34;meta&#34;:{<br/>      &#34;key&#34;:[<br/>         &#34;issueName&#34;,<br/>         &#34;fileName&#34;<br/>      ],<br/>      &#34;author&#34;:&#34;Jane Doe&#34;<br/>   },<br/>   &#34;issues&#34;:[<br/>      {<br/>         &#34;scanTool&#34;:&#34;MySastTool&#34;,<br/>         &#34;issueName&#34;:&#34;Cross Site Scripting&#34;,<br/>         &#34;issueDescription&#34;:&#34;Lorem ipsum...&#34;,<br/>         &#34;fileName&#34;:&#34;homepage-jobs.php&#34;,<br/>         &#34;remediationSteps&#34;:&#34;Fix me fast.&#34;,<br/>         &#34;risk&#34;:&#34;high&#34;,<br/>         &#34;severity&#34;:8,<br/>         &#34;status&#34;:&#34;open&#34;,<br/>         &#34;referenceIdentifiers&#34;:[<br/>            {<br/>               &#34;type&#34;:&#34;cwe&#34;,<br/>               &#34;id&#34;:&#34;79&#34;<br/>            }<br/>         ]<br/>      }<br/>   ]<br/>}</pre><p></p><p>The basic schema includes a <code>“meta”</code> section, which requires a <code>“key”</code> — this is the name of the attribute used to deduplicate multiple occurrences of an issue. In the example data file above, <code>&#34;key&#34;</code> = <code>&#34;issueName&#34;</code>. Thus if the data includes multiple occurrences of an issue with the same <code>&#34;issueName&#34;</code>, the pipeline combines these occurrences into one issue. The resulting issue includes a list of all occurrences and the data for each individual occurrence.</p><div class="note-callout">The key used for deduplication must be a Harness field. Do not try to deduplicate based on non-Harness fields.</div><p>The full JSON takes the form:</p><pre class="hljs json">&#34;meta&#34;: <br/>     { ... }, <br/>     &#34;issues&#34;: [ <br/>        { &#34;issue-1&#34; : &#34;data&#34; }, <br/>        { &#34;issue-2&#34; : &#34;data&#34; },<br/>        { &#34;issue-3&#34; : &#34;data&#34; }<br/>}</pre><p></p><h4><strong>Required fields</strong></h4><table><tbody><tr><td><p><strong>Name</strong></p></td><td><p><strong>Format</strong></p></td><td><p><strong>Description</strong></p></td></tr><tr><td><p><code>issueName</code></p></td><td><p>String</p></td><td><p>Name of vulnerability, license issue, compliance issue, etc.</p></td></tr><tr><td><p><code>issueDescription</code></p></td><td><p>String (long)</p></td><td><p>Description of vulnerability, license issue, compliance issue, etc.</p></td></tr><tr><td><p><code>scanTool</code></p></td><td><p>String</p></td><td><p>The name of the scanning tool (e.g. “SonarQube”)</p></td></tr><tr><td><p><code>severity</code></p></td><td><p>Float</p></td><td><p>CVSS 3.0 score (a number from 1.0-10.0)</p></td></tr></tbody></table><h4><strong>Recommended fields</strong></h4><table><tbody><tr><td><p><strong>Name</strong></p></td><td><p><strong>Format</strong></p></td><td><p><strong>Description</strong></p></td></tr><tr><td><p><code>confidence</code></p></td><td><p>Float</p></td><td><p>Derived from the tool output.</p></td></tr><tr><td><p><code>cvss</code></p></td><td><p>String (long)</p></td><td><p>Derived from the tool output.</p></td></tr><tr><td><p><code>fileName</code></p></td><td><p>String</p></td><td><p>Recommended to assist in triaging errors (if present).</p></td></tr><tr><td><p><code>host</code></p></td><td><p>String</p></td><td><p>Recommended to assist in triaging errors (if present).</p></td></tr><tr><td><p><code>ip</code></p></td><td><p>String</p></td><td><p>Recommended to assist in triaging errors (if present).</p></td></tr><tr><td><p><code>issueType</code></p></td><td><p>String</p></td><td><p>Type of issue (e.g. vulnerability, license issue, compliance issue, etc.)</p></td></tr><tr><td><p><code>lineNumber</code></p></td><td><p>String</p></td><td><p>Recommended to assist in triaging errors (if present).</p></td></tr><tr><td><p><code>link</code></p></td><td><p>String</p></td><td><p>Recommended to assist in triaging errors (if present).</p></td></tr><tr><td><p><code>port</code></p></td><td><p>Integer</p></td><td><p>Recommended to assist in triaging errors (if present).</p></td></tr><tr><td><p><code>product</code></p></td><td><p>String</p></td><td><p>Logical metadata field that can be used for tracking of product(s).</p></td></tr><tr><td><p><code>project</code></p></td><td><p>String</p></td><td><p>Logical metadata field that can be used for tracking of project(s)</p></td></tr><tr><td><p><code>remediationSteps</code></p></td><td><p>String (long)</p></td><td><p>Remediation instructions, often provided by the scan tool.</p></td></tr><tr><td><p><code>scanSeverity</code></p></td><td><p>String</p></td><td><p>The severity as reported by the scan tool.</p></td></tr><tr><td><p><code>scanStatus</code></p></td><td><p>String</p></td><td><p>Recommended for measuring scan duration and status.</p></td></tr><tr><td><p><code>tags</code></p></td><td><p>String</p></td><td><p>Logical metadata tags, which can be leveraged to describe asset owners, teams, business units, etc.</p></td></tr><tr><td><p><code>url</code></p></td><td><p>String</p></td><td><p>Recommended to assist in triaging errors (if present).</p></td></tr></tbody></table><h4><strong>Optional fields</strong></h4><table><tbody><tr><td><p><strong>Name</strong></p></td><td><p><strong>Format</strong></p></td><td><p><strong>Description</strong></p></td></tr><tr><td><p><code>author</code></p></td><td><p>String</p></td><td><p>Logical metadata field designed to track the owner of the scan result.</p></td></tr><tr><td><p><code>effort</code></p></td><td><p>String (long)</p></td><td><p>Logical metadata field designed to gauge the required effort to remediate a vulnerability.</p></td></tr><tr><td><p><code>exploitabilityScore</code></p></td><td><p>Float</p></td><td><p>Derived from the tool output.</p></td></tr><tr><td><p><code>imageLayerId</code></p></td><td><p>String</p></td><td><p>Metadata field to track image layer ID from containers.</p></td></tr><tr><td><p><code>imageNamespace</code></p></td><td><p>String</p></td><td><p>Logical metadata field.</p></td></tr><tr><td><p><code>impactScore</code></p></td><td><p>String</p></td><td><p>Derived from the tool output.</p></td></tr><tr><td><p><code>libraryName</code></p></td><td><p>String</p></td><td><p>Derived from the tool output.</p></td></tr><tr><td><p><code>license</code></p></td><td><p>String</p></td><td><p>Derived from the tool output.</p></td></tr><tr><td><p><code>linesOfCodeImpacted</code></p></td><td><p>String</p></td><td><p>Recommended to assist in triaging errors (if present).</p></td></tr><tr><td><p><code>referenceIdentifiers</code></p></td><td><p>Array</p></td><td><p>An array of Vulnerability identifiers, such as <code>cve</code>, <code>cwe</code>, etc. For example:</p><pre><br/>“referenceIdentifiers”: [<br/>     {“type” : “cve”,“id” : “79”},<br/>     {&#34;type&#34; : &#34;cwe&#34;, &#34;id&#34; : &#34;83&#34;}<br/>]</pre><p></p><div class="note-callout">The <code>type</code> value must be lowercase.</div></td></tr></tbody></table><p></p><h5>Custom fields</h5><p>You can add custom fields to an issue. The only restriction is that you cannot use any of the <a href="#reserved-keywords">reserved keywords</a> listed above. To include raw, unrefined data, add the prefix &#34;<code>_raw</code>&#34; to the field name. For example, you can add the following &#34;<code>_raw</code>&#34; fields to an issue:</p><pre class="hljs json">{<br/>   &#34;testName&#34;:&#34;hardcode_tmp_directory&#34;,<br/>     ......<br/>   &#34;referenceIdentifiers&#34;:[<br/>      {<br/>         &#34;type&#34;:&#34;cwe&#34;,<br/>         &#34;id&#34;:&#34;79&#34;<br/>      }<br/>    ],<br/>   &#34;_rawIssueCwe&#34;: {<br/>     &#34;id&#34; : 377,<br/>     &#34;link&#34; : &#34;https://cwe.mitre.org/data.definitions/377.html&#34;<br/>   },<br/>   &#34;_rawMoreInfo&#34; : &#34;https://bandit.readthedocs.io/en/1.7.4/plugins/b108_hardcoded_tmp_directory.html&#34;,<br/>   &#34;_rawColOffset&#34;:31<br/>}</pre><p></p><p>The custom fields will get grouped together at the end of the issue details like this:</p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ymkcm5lypf/1662134060300/issue-details-raw-fields-grouped.png" style="display:block;margin-left:0;margin-right:auto" data-hd-align="left"/></figure><p></p><h4 id="reserved-keywords">Reserved Keywords</h4><p>The following keywords are reserved and cannot be used in your JSON file:</p><ul><li><code>alertRulesets</code></li><li><code>customerId</code></li><li><code>discoveryIssueId</code></li><li><code>discoveryRunTime</code></li><li><code>discoveryTimespan</code></li><li><code>ignore</code></li><li><code>ignoreRulesets</code></li><li><code>jobId</code></li><li><code>policyId</code></li><li><code>policyName</code></li><li><code>refinementVersion</code></li><li><code>remediationRunTime</code></li><li><code>remediationTimespan</code></li><li><code>runTime</code></li><li><code>scenarioId</code></li><li><code>severityCode</code></li><li><code>target</code></li><li><code>targetId</code></li></ul><p></p>