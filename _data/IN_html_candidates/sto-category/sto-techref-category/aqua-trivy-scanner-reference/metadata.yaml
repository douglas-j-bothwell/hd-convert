type: article
article_id: 079248uzcu
user_id: xwmdbyp4x8
category_id: m01pu2ubai
author:
  name: Doug Bothwell
  email: douglas.bothwell@harness.io
  profile_image: https://www.gravatar.com/avatar/120de2cc624d7903cf3d83b86d0f1b5e?d=mm&s=150
title: Aqua Trivy Scanner Reference
slug: aqua-trivy-scanner-reference
description: You can set up a Security step with Aqua Trivy to detect vulnerabilities
  and misconfigurations in your container images.
short_version: You can set up a Security step with Aqua Trivy to detect vulnerabilities
  and misconfigurations in your container images.
tags: []
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: ""
  source: API
  triggered_at: 2022-09-30T11:36:32.625808Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Aqua Trivy Scanner Reference
  description: You can set up a Security step with Aqua Trivy to detect vulnerabilities
    and misconfigurations in your container images.
  short_version: You can set up a Security step with Aqua Trivy to detect vulnerabilities
    and misconfigurations in your container images.
  body: '<p> You can set up a Security step with <a href="https://aquasecurity.github.io/trivy">Aqua
    Trivy</a> to detect vulnerabilities and misconfigurations in your container images.</p><h3>Important
    Notes</h3><ul><li>STO supports container scans only with Aqua Trivy.</li></ul><h3>Scan
    types</h3><p>STO supports the following <code>policy_type</code> settings for
    Aqua-Trivy:</p><ul><li><code>orchestratedScan</code>  — A Security step in the
    pipeline runs the scan and ingests the results. This is the easiest to set up
    and supports scans with default or predefined settings.</li><li><code>ingestionOnly</code>
    — Run the scan in a Run step, or outside the pipeline, and then ingest the results.
    This is useful for advanced workflows that address specific security needs. See
    <a href="https://docs.harness.io/article/d24n34qdbk" target="_blank">Ingest scan
    results into an STO pipeline</a>.</li></ul><h3>Required Settings</h3><ul><li><code>product_name</code> = <code>aqua-trivy</code></li><li><code>scan_type</code>
    = <code>containerImage</code></li><li><code>product_config_name</code> — Specify
    one of the following:<ul><li><code>aqua-trivy</code> — Run the Trivy image scanner
    with default settings.</li><li><code>aqua-trivy-debug</code> — Run the Trivy image
    scanner in Debug mode.</li></ul></li><li><code>container_domain</code> — The image
    registry domain, for example <code>docker.io</code></li><li><code>container_project</code>
    — The image owner and project, for example <code>harness/delegate</code></li><li><code>container_tag</code>
    — The tag of the image to scan, for example <code>latest</code></li><li><code>container_type</code>
    — Set to <code>local_image</code>, <code>docker_v2</code>, <code>jfrog_artifactory</code>, or
    <code>aws_ecr</code><br/>The following settings are also required, depending on
    the container type:<ul><li>if <code>container_type</code> = <code>docker_v2</code><ul><li><code>container_access_id</code>:
    Username</li><li><code>container_access_token</code>: Password/Token</li></ul>if <code>container_type</code> = <code>aws_ecr</code><ul><li><code>container_access_id</code>:
    Username</li><li><code>container_access_token</code>: Password/Token</li><li><code>container_region</code>:
    Image registry AWS region</li></ul></li><li>if <code>container_type</code> = <code>jfrog_artifactory</code><ul><li><code>container_access_id</code>:
    Username</li><li><code>container_access_token</code>: Password/Token</li></ul></li></ul></li></ul><p></p>'
  slug: aqua-trivy-scanner-reference
  tags: []
  is_live: true
