<p></p><p>Harness 24/7 Service Guard monitors your live applications, catching problems that surface minutes or hours following deployment. For more information, see <a href="/article/dajt54pyxd-24-7-service-guard-overview">24/7 Service Guard Overview</a>.</p><p>You can add your Splunk monitoring to Harness 24/7 Service Guard in your Harness Application Environment. For a setup overview, see  <a href="/article/1ruyqq4q4p-1-splunk-connection-setup">Connect to Splunk</a>.</p><p>In this topic:</p><ul><li> <a href="#before_you_begin">Before You Begin</a></li><li> <a href="#visual_summary">Visual Summary</a></li><li> <a href="#simple_slug">Step 1: Set Up 24/7 Service Guard for Splunk</a></li><li> <a href="#step_2_display_name">Step 2: Display Name</a></li><li> <a href="#step_3_service">Step 3: Service</a></li><li> <a href="#step_4_splunk_server">Step 4: Splunk Server</a></li><li> <a href="#step_5_search_keywords">Step 5: Search Keywords</a></li><li> <a href="#step_6_field_name_for_host_container">Step 6: Field name for Host/Container</a></li><li> <a href="#step_7_baseline">Step 7: Baseline</a></li><li> <a href="#step_8_execute_with_previous_steps">Step 8: Execute with previous steps</a></li><li> <a href="#troubleshoot_splunk_connectivity_and_service_guard_configuration">Troubleshoot: Splunk Connectivity and Service Guard Configuration</a></li><li> <a href="#next_steps">Next Steps</a></li></ul><p></p><h3>Before You Begin</h3><ul><li>See the <a href="/article/dujtd6ek5p-splunk-verification-overview">Splunk Verification Overview</a>.</li><li>See <a href="/article/1ruyqq4q4p-1-splunk-connection-setup">Connect to Splunk</a>.</li></ul><p></p><h3>Visual Summary</h3><p>Here&#39;s an example configuration of 24/7 Service Guard for Splunk.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/feiv05dmnk/1580889362266/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><h3>Step 1: Set Up 24/7 Service Guard for Splunk</h3><p>To set up 24/7 Service Guard for Splunk:</p><ol><li>Ensure that you have added Splunk as a Harness Verification Provider, as described in  <a href="/article/1ruyqq4q4p-1-splunk-connection-setup">Connect to Splunk</a>.</li><li>In your Harness Application, ensure that you have added a Service, as described in  <a href="https://docs.harness.io/article/eb3kfl8uls-service-configuration">Services</a>. For 24/7 Service Guard, you do not need to add an Artifact Source to the Service, or configure its settings. You simply need to create a Service and name it. It will represent your application for 24/7 Service Guard.</li><li>In your Harness Application, click <strong>Environments</strong>.</li><li>In <strong>Environments</strong>, ensure that you have added an Environment for the Service you added. For steps on adding an Environment, see  <a href="https://docs.harness.io/article/n39w05njjv-environment-configuration">Environments</a>.</li><li>Click the Environment for your Service. Typically, the <strong>Environment Type</strong> is <strong>Production</strong>.</li><li>In the <strong>Environment</strong> page, locate <strong>24/7 Service Guard</strong>.</li><li>In <strong>24/7 Service Guard</strong>, click <strong>Add Service Verification</strong>, and then click <strong>Splunk</strong>. The <strong>Splunk</strong> dialog appears.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/feiv05dmnk/1580889362266/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Fill out the dialog. The dialog has the following fields.</li></ol><p>For 24/7 Service Guard, the queries you define to collect logs are specific to the application or service you want monitored. Verification is application/service level. This is unlike Workflows, where verification is performed at the host/node/pod level.</p><h3>Step 2: Display Name</h3><p>The name that will identify this service on the <strong>Continuous Verification</strong> dashboard. Use a name that indicates the environment and monitoring tool, such as <strong>Splunk</strong>.</p><h3>Step 3: Service</h3><p>The Harness Service to monitor with 24/7 Service Guard.</p><h3>Step 4: Splunk Server</h3><p>Select the Harness Verification Provider you configured using your Splunk account.</p><h3>Step 5: Search Keywords</h3><p>Enter a search term or query. To search for all exceptions, use asterisks (*) around <strong>exception</strong>, for example, <strong>*exception*</strong>. For more information, see <a href="http://docs.splunk.com/Documentation/Splunk/7.2.0/SearchTutorial/Startsearching#Retrieve_events_from_the_index" target="_blank">Retrieve events from the index</a> from Splunk.</p><p>When you enter a search such as <strong>*exception*</strong>, at runtime Harness will generate a query containing your search and information Harness needs to perform monitoring, such as the information following <strong>*exception*</strong> below:</p><pre class="hljs sql">search *exception* host = ip-172-31-81-88 | bin _time span=1m |<br/>  <br/><br/>  <br/>cluster t=0.9999 showcount=t labelonly=t|<br/>  <br/><br/>  <br/>table _time, _raw,cluster_label, host |<br/>  <br/><br/>  <br/>stats latest(_raw) as _raw count as cluster_count by _time,cluster_label,host</pre><p>If you want more flexibility in your search, or to repurpose Splunk searches you already have, you can click <strong>Advanced Query</strong> and enter whatever you like in <strong>Search Keywords</strong>. Simply copy and paste your Splunk query into Harness, such as <code>search index=*prod *exception*</code>.</p><p>Note that you will specify host field name and host/pod/container name in other settings so you do not need to include them in the search query.</p><h3>Step 6: Field name for Host/Container</h3><p>Typically, you will enter <strong>host</strong>. You can enter <strong>host</strong> into the Splunk <strong>Search</strong> field to see the host for your Harness deployment:</p><figure><a href="https://files.helpdocs.io/kw8ldg1itf/articles/fq1ompej1b/1539722168224/image.png"><img src="https://files.helpdocs.io/kw8ldg1itf/articles/fq1ompej1b/1539722168224/image.png"/></a></figure><h3>Step 7: Baseline</h3><p>Select the baseline for comparison.</p><h3>Step 8: Execute with previous steps</h3><p>Check this checkbox to run this verification step in parallel with the previous steps in <strong>Verify Service</strong>.</p><p> For more information, see <a href="/article/dajt54pyxd-24-7-service-guard-overview">24/7 Service Guard Overview</a>.</p><h3>Troubleshoot: Splunk Connectivity and Service Guard Configuration</h3><p>If you are able to test the connection while configuring Splunk, but unable to schedule a job while setting up 24/7 Service Guard:</p><ul><li>Make sure the permissions of the Splunk user are granted for REST API.</li><li>If all the permissions are granted, create a new user in Splunk and verify if the CURL call from this user works.</li><li>On Harness On-Prem, make sure the firewall port is open for the Splunk REST API access.</li></ul><h3>Next Steps</h3><ul><li> <a href="/article/zi7doy7zn8-3-verify-deployments-with-splunk">Verify Deployments with Splunk</a></li></ul><p></p>