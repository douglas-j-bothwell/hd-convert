<p>The Deploy Workflow takes the artifact build you built in <a href="/article/obqhjaabnl-3-build-workflow">Create the Build Workflow for Build and Deploy Pipelines</a> by using the Service you created for the Artifact Source. Then the Deploy Workflow installs the build into the nodes in the Environment. See the supported <a href="/article/m220i1tnia-workflow-configuration#workflow_types">Workflow Types</a>.</p><h3>Before You Begin</h3><ul><li><a href="/article/wqytbv2bfd-ci-cd-with-the-build-workflow">CI/CD with the Build Workflow</a></li></ul><h3>Step: Deploy Workflow</h3><p>To set up the Deploy Workflow, do the following:</p><ol><li>In your Application, click <strong>Workflows</strong>.</li><li>In <strong>Workflows</strong>, click <strong>Add Workflow</strong>. The <strong>Workflow</strong> dialog appears.</li><li>In <strong>Name</strong>, enter a name for the Deploy Workflow. For example, <strong>Deploy File</strong>.</li><li>In <strong>Workflow Type</strong>, select <strong>Basic Deployment</strong>.</li><li>In <strong>Environment</strong>, select the Environment you created earlier.</li><li>In <strong>Service</strong>, select the Service you created earlier.</li><li>In <strong>Infrastructure Definition</strong>, select the Infrastructure Definition you created earlier. If the Infrastructure Definition does not appear, ensure that you added the Service to the Infrastructure Definition <strong>Scope to specific Services</strong> setting.<br/><br/>When you are done, the dialog will look something like this.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1568331803338/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click <strong>Submit</strong>. The Deploy Workflow is created.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1568331856619/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li></ol><p></p><p>Let&#39;s look at the two commands created automatically.</p><h4>Configure Select Nodes</h4><p>The <strong>Select Nodes</strong> command simply selects the nodes in your Infrastructure Definition.</p><ol><li>Select <strong>Yes</strong> to specify specific hosts in the <strong>Host Name(s)</strong> field. Harness will add whatever hosts it can find using the criteria in your Infrastructure Definition. For example, the following image shows how the criteria in your Infrastructure Definition locates an EC2 instance, which is then displayed in the <strong>Node Select</strong>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/q6rtl33634/1580235173953/image.png"/></figure></li><li>Select <strong>No</strong> to specify the number of <strong>Desired Instances</strong> and <strong>Instance Unit Type</strong> you want.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/apwbji6gk5/1598891485455/screenshot-2020-08-31-at-9-45-12-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>When the <strong>Exclude instances from future phases</strong> setting is selected (recommended), the instance(s) selected by this Node Select step will not be eligible for selection by any future Node Select step. In cases where you want to perform a one-time operation using a node and then deploy to all nodes in later phases, you might want to leave this setting unselected.</li></ol><h4>Configure Install</h4><p>The Install step installs the artifact onto the nodes you selected.</p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/q6rtl33634/1580235247881/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p>The Install step uses the artifact build number obtained in the Artifact Collection step and the Artifact Source in the Harness Service. Basically, the Install step looks in the Artifact Source for the build number obtained by Artifact Collection by using artifact metadata. The logs for the step display the artifact copy to the target nodes.</p><pre>Begin file transfer harness7cbd2fa8dc9e2d9f634205b288811b27 to ip-10-0-0-87.ec2.internal:/tmp/AC3HcFy1QByir0UGIR09Zg<br/><br/>File successfully transferred<br/><br/>Connecting to ip-10-0-0-87.ec2.internal ....<br/><br/>Connection to ip-10-0-0-87.ec2.internal established</pre><p></p><p>Next, the Install step runs the scripts in the Harness Service to install and run the artifact in its runtime environment. For details about common script steps, see <a href="/article/6pwni5f9el-traditional-deployments-overview">Traditional Deployments Overview</a>.</p><p>Now that both Workflows are set up, you can create the Artifact Build and Deploy Pipeline.</p><h3>Use the Same Artifact Build/Tag Across Multiple Workflows in a Pipeline</h3><p>When using a Build Workflow followed by multiple Workflows in a Pipeline, you can now pass the same artifact from the first Build Workflow to rest of the Workflows in the Pipeline that deploy the same Harness Service.</p><p>Execution of each Workflow will use the artifact collected by the last run Build Workflow in the Pipeline that has collected the artifact from the same Service.</p><p>In the first Build Workflow&#39;s <strong>Artifact Collection</strong> step&#39;s <strong>Build/Tag</strong> setting, you specify the artifact to collect. For subsequent <strong>Artifact Collection</strong> steps in the same and subsequent Workflows in the Pipeline deploying the same Service, you can leave the <strong>Artifact Collection</strong> step&#39;s <strong>Build/Tag</strong> setting empty and Harness will use the artifact collected by the last Build Workflow in the Pipeline.</p><p>This functionality requires the Feature Flag <code>SORT_ARTIFACTS_IN_UPDATED_ORDER</code>.</p><h3>Next Step</h3><ul><li><a href="/article/slkhuejdkw-6-artifact-build-and-deploy-pipelines">Create the Build and Deploy Pipeline</a></li></ul><p></p>