type: article
article_id: e3ww34nu8g
user_id: wz6xkfcc9i
category_id: mizega9tt6
author:
  name: Chakravarthy Tenneti
  profile_image: https://www.gravatar.com/avatar/790db061bb8f8fb094e4d4b19a390f3b?d=mm&s=150
title: Configure Spotinst Traffic Shift Verification
slug: configure-traffic-split-verification
description: 'You can configure performance monitoring and log analysis verification
  of Spotinst traffic shifting. Currently, this feature is only supported for SpotInst
  Blue/Green deployments. In this topic: Befo…'
short_version: 'You can configure performance monitoring and log analysis verification
  of Spotinst traffic shifting. Currently, this feature is only supported for SpotInst
  Blue/Green deployments. In this topic: Befo…'
tags: []
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2021-05-12T17:21:20.815473Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Configure Spotinst Traffic Shift Verification
  description: ""
  short_version: ""
  body: '<p>You can configure performance monitoring and log analysis verification
    of Spotinst traffic shifting. </p><div class="note-callout">Currently, this feature
    is only supported for SpotInst Blue/Green deployments.</div><p>In this topic:</p><ul><li><a
    href="#before_you_begin">Before You Begin</a></li><li><a href="#step_1_add_the_workflow_with_traffic_shift_strategy">Step
    1: Add the Workflow with Traffic Shift Strategy</a></li><li><a href="#step_2_add_traffic_split_step">Step
    2: Add Traffic Split Step</a></li><li><a href="#step_3_add_verification_step">Step
    3: Add Verification Step</a></li><li><a href="#step_4_view_verification_results">Step
    4: View Verification Results</a></li></ul><p></p><h3>Before You Begin</h3><ul><li>Review
    the <a href="/article/bkxhdsur2z-ami-elastigroup#spotinst_prerequisites">prerequisites
    for configuring the Workflow using Traffic Split Strategy</a>.</li><li>Follow
    the deployment instructions for <a href="/article/bkxhdsur2z-ami-elastigroup#blue_green_with_incremental_traffic_shift">Blue/Green
    Deployment with Incremental Traffic Shift</a>.</li></ul><p></p><h3>Step 1: Add
    the Workflow with Traffic Shift Strategy</h3><ol><li>In the Harness Application
    containing the Service and Infrastructure Definition you want to use, click <strong>Workflows</strong>.</li><li>Click
    <strong>Add Workflow</strong>.</li><li>Enter a name for the Workflow.</li><li>In
    <strong>Workflow Type</strong>, select <strong>Blue/Green Deployment</strong>.</li><li>Select
    an <strong>Environment</strong> and <strong>Service</strong>, and the <strong>Infrastructure
    Definition</strong> containing your imported Elastigroup JSON Configuration.</li><li>In
    <strong>Traffic Shift Strategy</strong>, select Incrementally <strong>Shift Traffic
    using ELB</strong>.</li><li>Click <strong>Submit</strong>.</li></ol><p>Harness
    creates the Workflow and automatically adds the steps for deployment.</p><p>By
    default, only one <strong>Shift Traffic Weight</strong> step is added. Unless
    you want to shift the traffic in one step, you will likely add more <strong>Shift
    Traffic Weight</strong> steps to incrementally shift traffic.</p><p>For more information
    about Blue/Green Deployment and Workflow creation, see <a href="https://docs.harness.io/article/bkxhdsur2z-ami-elastigroup#blue_green_with_incremental_traffic_shift">Blue/Green
    Deployment with Incremental Traffic Shift</a>.</p><h3>Step 2: Add Traffic Split
    Step</h3><ol><li>Add the required steps in sections for deployment and staging
    verification.</li><li>Add traffic shift steps in the Route Update section after
    the Verify Staging section based on the percentage shift required.</li></ol><p></p><figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/e3ww34nu8g/1595996900071/configurephaseshift.png"
    style="max-height:75%;max-width:75%" data-hd-height="75%" data-hd-width="75%"/></figure><p></p><p>You
    can manipulate traffic shifting using as many Shift Traffic Weight steps as you
    like.</p><p>Typically, you add Approval steps between each Shift Traffic Weight
    step to ensure that everything is running smoothly. For example, you can test
    the new feature(s) of your app before approving. This is a simple way to incorporate
    A/B testing into your Workflow.</p><p>Approval steps are very useful because they
    enable you to cancel a deployment and return to the pre-deployment traffic weighting
    with a single step.</p><h3>Step 3: Add Verification Step</h3><p>In the <strong>Route
    Update</strong> section, after each traffic split step, you can add the verification
    step for one of the following:</p><ul><li><strong>Performance Monitoring</strong>—<strong>AppDynamics</strong>:
    For more information on configuring AppDynamics verification, see <a href="https://docs.harness.io/article/ehezyvz163-3-verify-deployments-with-app-dynamics">Verify
    Deployments with AppDynamics</a>.</li><li><strong>Log Analysis</strong>—<strong>ELK</strong>:
    For more information on configuring ELK verification see <a href="https://docs.harness.io/article/e2eghvcyas-3-verify-deployments-with-elasticsearch">Verify
    Deployments with Elasticsearch</a>.</li></ul><div class="note-callout">Make sure
    you add the verification steps for traffic split only in the <strong>Route Update</strong>
    section.</div><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/e3ww34nu8g/1595997062180/add-step-traffic-split-cv.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p>The
    configure AppDynamics/ELK procedure is similar to the regular configuration, except
    for the <strong>Baseline for Risk Analysis</strong> input. You can select only
    <strong>Canary Analysis</strong>.</p><div class="note-callout">Traffic split analysis
    will be performed only if the new traffic percentage is less than 50%. Analysis
    will not be performed if the traffic split is more than 50%.</div><h3>Step 4:
    View Verification Results</h3><p>Once you have executed the Workflow, Harness
    performs the verification you configured and displays the results in the <strong>Deployments</strong>
    and <strong>Continuous Verification</strong> pages. Verification is executed in
    real time, quantifying the business impact of every production deployment.</p><p>For
    a quick overview of the verification UI elements, see <a href="https://docs.harness.io/article/xldc13iv1y-meet-harness#continuous_verification_tools">Continuous
    Verification Tools</a>. For details about viewing and interpreting verification
    results, see <a href="https://docs.harness.io/article/2la30ysdz7-deployment-verification-results">Verification
    Results Overview</a>.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/e3ww34nu8g/1596093933437/cv-tsout-2.png"/></figure><p></p>'
  slug: configure-traffic-split-verification
  tags: []
  is_live: true
