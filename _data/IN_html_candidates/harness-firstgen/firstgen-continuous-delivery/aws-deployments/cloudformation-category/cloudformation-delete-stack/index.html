<div class="tip-callout">This content is for Harness <a href="/article/1fjmm4by22">FirstGen</a>. Switch to <a href="/article/vynj4hxt98">NextGen</a>.</div><p>You can add a CloudFormation Delete Stack Workflow step to remove any provisioned infrastructure, just like running the <code>cloudformation delete-stack</code> command. See <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/delete-stack.html" target="_blank">delete-stack</a> from AWS.</p><p>In this topic:</p><ul><li> <a href="#before_you_begin">Before You Begin</a></li><li> <a href="#review_what_gets_deleted">Review: What Gets Deleted?</a><ul><li> <a href="#delete_using_default_steps">Delete Using Default Steps</a></li><li> <a href="#delete_using_stack_name">Delete Using Stack Name</a></li></ul></li><li> <a href="#step_1_add_cloud_formation_delete_stack">Step 1: Add CloudFormation Delete Stack</a></li><li> <a href="#option_1_delete_stack_by_name">Option 1: Delete Stack by Name</a></li><li> <a href="#option_2_delete_stack_using_defaults">Option 2: Delete Stack Using Defaults</a></li></ul><p></p><h3>Before You Begin</h3><ul><li> <a href="/article/qj0ems5hmg-cloud-formation-provisioning-with-harness">CloudFormation Provisioning with Harness</a></li><li> <a href="/article/308nblm0vc-cloud-formation-account-setup">Set Up Your Harness Account for CloudFormation</a></li><li> <a href="/article/wtper654tn-add-cloud-formation-templates">Add CloudFormation Templates</a></li><li> <a href="/article/4xtxj2f88b-map-cloud-formation-infrastructure">Map CloudFormation Infrastructure</a></li><li> <a href="/article/5wdb3r765g-provision-cloudformation-create-stack">Provision using CloudFormation Create Stack</a></li><li> <a href="/article/ez8bgluqg5-using-cloudformation-outputs-in-workflow-steps">Using CloudFormation Outputs in Workflow Steps</a></li></ul><p></p><h3>Review: What Gets Deleted?</h3><p>CloudFormation Delete Stack can delete any CloudFormation stack. You identify the stack you want deleted using its stack name or by using the default settings in the Workflow CloudFormation steps.</p><p>Let&#39;s look at a couple examples:</p><h4>Delete Using Default Steps</h4><p>When you provision infrastructure using CloudFormation, you add a <strong>CloudFormation Create Stack</strong> step in the <strong>Workflow Pre-deployment Steps</strong> section. If you do not enter a custom name for that stack, Harness names the stack using the <code>HarnessStack-</code> prefix and the ID of the Environment used.</p><p>If you want to delete that stack, add the <strong>CloudFormation Delete Stack</strong> step to the <strong>Post-deployment Steps</strong> of the same Workflow.</p><p>In <strong>CloudFormation Delete Stack</strong>, do not enter a custom name, and ensure you specify the same settings as the CloudFormation Create Stack step (Provisioner, AWS Cloud Provider, Region).</p><p>The <strong>CloudFormation Delete Stack</strong> step will delete the stack created by the <strong>CloudFormation Create Stack</strong> step.</p><h4>Delete Using Stack Name</h4><p>You can also use the <strong>Use Custom Name</strong> setting in the <strong>CloudFormation Delete Stack</strong> step to delete any stack by name.</p><p>This is the same as the <a href="https://docs.aws.amazon.com/cli/latest/reference/cloudformation/delete-stack.html" target="_blank">delete-stack</a> API command.</p><p>To see the list of stacks and their names, you can simply run:</p><pre>aws cloudformation list-stacks --stack-status-filter CREATE_COMPLETE</pre><h3>Step 1: Add CloudFormation Delete Stack</h3><ol><li>In the <strong>Post-deployment Steps</strong> of the Workflow, click <strong>Add Step</strong>, and then select <strong>CloudFormation Delete Stack</strong>. The CloudFormation Delete Stack settings appear.</li></ol><h3>Option 1: Delete Stack by Name</h3><p>If you want to specify the name of a specific stack, do the following:</p><ol><li>In <strong>AWS Cloud Provider</strong>, select the AWS Cloud Provider with credentials to delete stacks. Typically, this is the same AWS Cloud Provider you selected in the <strong>CloudFormation Create Stack</strong> step that created the stack you want to delete.<br/><br/>For details on permissions, see <a href="/article/308nblm0vc-cloud-formation-account-setup">Set Up Your Harness Account for CloudFormation</a>.</li><li>In <strong>Region</strong>, select the same region you selected in the <strong>CloudFormation Create Stack</strong> step that created the stack you want to delete.</li><li>Select <strong>Use Custom Stack Name</strong> and enter the name of the stack to delete in <strong>Custom Stack Name</strong>.</li><li>Click <strong>Submit</strong>.</li></ol><h3>Option 2: Delete Stack Using Defaults</h3><p>If you want to delete the exact same stack you provisioned using the <strong>CloudFormation Create Stack</strong> step in this Workflow, do the following:</p><ol><li>In <strong>Provisioner</strong>, select the same CloudFormation Infrastructure Provisioner you selected in the <strong>CloudFormation Create Stack</strong> step that created the stack you want to delete.</li><li>In <strong>AWS Cloud Provider</strong>, select the same AWS Cloud Provider you selected in the <strong>CloudFormation Create Stack</strong> step that created the stack you want to delete.</li><li>In <strong>Region</strong>, select the same region you selected in the <strong>CloudFormation Create Stack</strong> step that created the stack you want to delete.</li><li>Click <strong>Submit</strong>.</li></ol><p></p><p></p>