type: article
article_id: rdk1j5s32z
user_id: mfr0nxh4be
category_id: df9vj316ec
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: 8 - ECS Troubleshooting
slug: ecs-troubleshooting
description: General troubleshooting steps for ECS deployments.
short_version: General troubleshooting steps for ECS deployments.
tags:
- Troubleshooting
- ECS Troubleshooting
- rate exceeded
- ARN format
- Invalid CPU or Memory Value Specified
- AmazonElasticLoadBalancingException
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2021-05-12T17:22:58.8331Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: 8 - ECS Troubleshooting
  description: General troubleshooting steps for ECS deployments.
  short_version: General troubleshooting steps for ECS deployments.
  body: '<p>The following errors might occur when setting up and deploying ECS in
    Harness:</p><ul><li><a href="https://docs.harness.io/article/rdk1j5s32z-ecs-troubleshooting#rate_exceeded">Rate
    Exceeded</a></li><li><a href="https://docs.harness.io/article/rdk1j5s32z-ecs-troubleshooting#new_arn_and_resource_id_format_must_be_enabled">New
    ARN and Resource ID Format Must be Enabled</a></li><li><a href="https://docs.harness.io/article/rdk1j5s32z-ecs-troubleshooting#unable_to_place_a_task_because_no_container_instance_met_all_of_its_requirements">Unable
    to Place a Task Because no Container Instance met all of its Requirements</a></li><li><a
    href="https://docs.harness.io/article/rdk1j5s32z-ecs-troubleshooting#cannot_pull_container_image">Cannot
    Pull Container Image</a></li><li><a href="https://docs.harness.io/article/rdk1j5s32z-ecs-troubleshooting#invalid_cpu_or_memory_value_specified">Invalid
    CPU or Memory Value Specified</a></li><li><a href="https://docs.harness.io/article/rdk1j5s32z-ecs-troubleshooting#client_exception_fargate_requires_that_cpu_be_defined_at_the_task_level">ClientException:
    Fargate requires that &#39;cpu&#39; be defined at the task level</a></li><li><a
    href="https://docs.harness.io/article/rdk1j5s32z-ecs-troubleshooting#client_exception_the_memory_setting_for_container_is_greater_than_for_the_task">ClientException:
    The &#39;memory&#39; setting for container is greater than for the task</a></li><li><a
    href="https://docs.harness.io/article/rdk1j5s32z-ecs-troubleshooting#amazon_elastic_load_balancing_exception_rate_exceeded">AmazonElasticLoadBalancingException:
    Rate exceeded</a></li></ul><div class="note-callout">For information on ECS troubleshooting,
    see <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/troubleshooting.html">Amazon
    ECS Troubleshooting</a> from AWS.</div><p></p><h3>Rate Exceeded</h3><p>A common
    issue with AWS deployments is exceeding an AWS rate limit for some AWS component,
    such as ECS clusters per region or maximum number of scaling policies per Auto
    Scaling Groups.</p><p>For steps to increase any AWS limits, see <a href="https://docs.aws.amazon.com/general/latest/gr/aws_service_limits.html"
    target="_blank">AWS Service Limits</a> from AWS.</p><h3>New ARN and Resource ID
    Format Must be Enabled</h3><p>Harness uses tags for Blue/Green deployment, but
    ECS requires the new ARN and resource ID format to be enabled in order to add
    tags to the ECS service.</p><p>If you have not opted into the new ECS ARN and
    resource ID format before you attempt Blue/Green deployment, you might receive
    the following error:</p><p><code>InvalidParameterException: The new ARN and resource
    ID format must be enabled to add tags to the service. Opt in to the new format
    and try again.</code></p><p>To solve this issue, opt into the new format and try
    again. For more information, see <a href="https://aws.amazon.com/blogs/compute/migrating-your-amazon-ecs-deployment-to-the-new-arn-and-resource-id-format-2/"
    target="_blank">Migrating your Amazon ECS deployment to the new ARN and resource
    ID format</a> from AWS.</p><h3>Unable to Place a Task Because no Container Instance
    met all of its Requirements</h3><p>The Upgrade Containers step might show the
    following message:</p><p><code>(service service-name) was unable to place a task
    because no container instance met all of its requirements.</code></p><p>Review
    the CPU requirements in both the task size and container definition parameters
    of the task definition.</p><p>See <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/service-event-messages.html#service-event-messages-list"
    target="_blank">Service Event Messages</a> from AWS.</p><h3>Cannot Pull Container
    Image</h3><p>You might see Docker errors indicating that when creating a task,
    the container image specified could not be retrieved.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/az9h2n0usr/1560362552896/image.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>See
    <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task_cannot_pull_image.html"
    target="_blank">Cannot Pull Container Image Error</a> from AWS.</p><h3>Invalid
    CPU or Memory Value Specified</h3><p>See the required settings in <a href="https://docs.aws.amazon.com/AmazonECS/latest/developerguide/task-cpu-memory-error.html">Invalid
    CPU or Memory Value Specified</a> from AWS.</p><h3>ClientException: Fargate requires
    that &#39;cpu&#39; be defined at the task level</h3><p>Ensure that you add the
    CPU and Memory settings in the Harness Service Container Specification section—for
    example:</p><pre class="hljs json">&#34;cpu&#34; : &#34;1&#34;,<br/><br/>&#34;memory&#34;
    : &#34;512&#34;</pre><h3>ClientException: The &#39;memory&#39; setting for container
    is greater than for the task</h3><p>In the Harness Service <strong>Container Specification</strong>
    JSON, there are two settings for memory. The memory setting for the container
    must not be greater than the memory setting for the task:</p><pre class="hljs
    json">{<br/><br/>  &#34;containerDefinitions&#34; : [ {<br/><br/>    &#34;name&#34;
    : &#34;${CONTAINER_NAME}&#34;,<br/><br/>    &#34;image&#34; : &#34;${DOCKER_IMAGE_NAME}&#34;,<br/><br/>
       &#34;memory&#34; : 512,<br/><br/>    ...<br/><br/>  } ],<br/><br/>  &#34;executionRoleArn&#34;
    : &#34;${EXECUTION_ROLE}&#34;,<br/><br/>  ...<br/><br/>  &#34;cpu&#34; : &#34;1&#34;,<br/><br/>
     &#34;memory&#34; : &#34;512&#34;,<br/><br/>  &#34;networkMode&#34; : &#34;awsvpc&#34;<br/><br/>}</pre><h3>AmazonElasticLoadBalancingException:
    Rate exceeded</h3><p>You might receive this error as a result of AWS Load Balancer
    rate limiting. For more information, see <a href="https://docs.aws.amazon.com/elasticloadbalancing/latest/application/load-balancer-limits.html"
    target="_blank">Limits for Your Application Load Balancers</a> from AWS.</p>'
  slug: ecs-troubleshooting
  tags:
  - Troubleshooting
  - ECS Troubleshooting
  - rate exceeded
  - ARN format
  - Invalid CPU or Memory Value Specified
  - AmazonElasticLoadBalancingException
  is_live: true
