type: article
article_id: va3trqfy49
user_id: mfr0nxh4be
category_id: n03qfofd5w
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: Scale Kubernetes Pods
slug: scale-kubernetes-pods
description: Update the number of Kubernetes pods running.
short_version: Update the number of Kubernetes pods running.
tags: []
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2021-05-12T17:21:49.12377Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Scale Kubernetes Pods
  description: Update the number of Kubernetes pods running.
  short_version: Update the number of Kubernetes pods running.
  body: '<p>When you deploy a Kubernetes workload using Harness, you set the number
    of pods you want in your manifests and in the deployment steps.</p><p>With the
    Scale step, you can scale this number of running pods up or down, by count or
    percentage.</p><p>In this topic:</p><ul><li> <a href="#before_you_begin">Before
    You Begin</a></li><li> <a href="#step_1_add_scale_step">Step 1: Add Scale Step</a></li><li>
    <a href="#step_2_pick_count_or_percentage">Step 2: Pick Count or Percentage</a></li><li>
    <a href="#step_3_set_the_number_of_pods">Step 3: Set the Number of Pods</a></li><li>
    <a href="#step_4_specify_resources_to_scale">Step 4: Specify Resources to Scale</a></li><li><a
    href="#option_delegate_selector">Option: Delegate Selector</a></li><li><a href="#option_skip_steady_state_check">Option:
    Skip Steady State Check</a></li><li> <a href="#notes">Notes</a></li><li> <a href="#next_steps">Next
    Steps</a></li></ul><h3>Before You Begin</h3><ul><li><a href="/article/2j2vi5oxrq-define-kubernetes-manifests">Define
    Kubernetes Manifests</a></li><li><a href="/article/2xp0oyubjj-create-a-kubernetes-canary-deployment">Create
    a Kubernetes Canary Deployment</a></li><li><a href="/article/dl0l34ge8l-create-a-kubernetes-rolling-deployment">Create
    a Kubernetes Rolling Deployment</a></li><li><a href="/article/ukftzrngr1-create-a-kubernetes-blue-green-deployment">Create
    a Kubernetes Blue/Green Deployment</a></li><li><a href="/article/7bpdtvhq92-workflow-variables-expressions">Kubernetes
    Workflow Variable Expressions</a></li></ul><h3>Step 1: Add Scale Step</h3><p>In
    your Harness Workflow, click <strong>Add Step</strong>, and select <strong>Scale</strong>.
    The <strong>Scale</strong> settings appear.</p><p>Name the step and then provide
    the scaling strategy, described below.</p><h3>Step 2: Pick Count or Percentage</h3><p>The
    Scale step updates the number of instances running, either by count or percentage.</p><p>In
    <strong>Instance Unit Type</strong>, select <strong>COUNT</strong> or <strong>PERCENTAGE</strong>.</p><ul><li><strong>COUNT</strong>
    — The number is simply the number of pods.</li><li><strong>PERCENTAGE</strong>
    — A percentage of the pods defined in your Harness Service <strong>Manifests</strong>
    files or a previous Workflow step.</li></ul><h3>Step 3: Set the Number of Pods</h3><p>Enter
    the number of pods to scale up or down compared to the number of instances specified
    <em>before</em> the Scale step.</p><p>The number may come from the Harness Service
    manifest or a previous Workflow step, whichever set the number of pods right before
    the Scale step.</p><p>For example, in you have <code>replicas: 4</code> in a manifest
    in your Service, and you enter <strong>50</strong> <strong>PERCENT</strong> in
    <strong>Instances</strong>, then 2 pods are deployed in this step.</p><div class="note-callout">If
    you have an odd number of instances, such as 3 instances, and then enter 50% in
    Scale, the number of instances is scaled down to 2.</div><h3>Step 4: Specify Resources
    to Scale</h3><p>Enter the Harness built-in variable <code>${k8s.canaryWorkload}</code> or
    the name of the resource in the format <code>[namespace/]Kind/Name</code>, with <code>namespace</code> optional.
    For example: </p><p><code>my-namespace/Deployment/harness-example-deployment-canary</code></p><p>You
    can scale Deployment, DaemonSet, or StatefulSet.</p><p>You can only enter one
    resource in <strong>Workload</strong>. To scale another resource, add another
    Scale step.</p><p>Here is what a completed step looks like:</p><p></p><figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/va3trqfy49/1619460458124/image.png"/></figure><h3>Option:
    Delegate Selector</h3><p>If your Workflow Infrastructure Definition&#39;s Cloud
    Provider uses a Delegate Selector (supported in Kubernetes Cluster and AWS Cloud
    Providers), then the Workflow uses the selected Delegate for all of its steps.</p><p>In
    these cases, you shouldn&#39;t add a Delegate Selector to any step in the Workflow.
    The Workflow is already using a Selector via its Infrastructure Definition&#39;s
    Cloud Provider.</p><p>If your Workflow Infrastructure Definition&#39;s Cloud Provider
    isn&#39;t using a Delegate Selector, and you want this Workflow step to use a
    specific Delegate, do the following:</p><p>In <strong>Delegate Selector</strong>,
    select the Selector for the Delegate(s) you want to use. You add Selectors to
    Delegates to make sure that they&#39;re used to execute the command. For more
    information, see <a href="/article/c3fvixpgsl-select-delegates-for-specific-tasks-with-selectors">Select
    Delegates with Selectors</a>.</p><p>Harness will use Delegates matching the Selectors
    you add.</p><p>If you use one Selector, Harness will use any Delegate that has
    that Selector.</p><p>If you select two Selectors, a Delegate must have both Selectors
    to be selected. That Delegate might also have other Selectors, but it must have
    the two you selected.</p><div class="note-callout">You can use expressions for
    Harness built-in variables or Account Default variables in <strong>Delegate Selectors</strong>.
    When the variable expression is resolved at deployment runtime, it must match
    an existing Delegate Selector.<br/><br/>For example, if you have a Delegate Selector <strong>prod</strong> and
    the Workflow is using an Environment also named <strong>prod</strong>, the Delegate
    Selector can be <code>${env.name}</code>. This is very useful when you match Delegate
    Selectors to Application component names such as Environments, Services, etc.
    It&#39;s also a way to template the Delegate Selector setting.</div><p></p><h3>Option:
    Skip Steady State Check</h3><p>If you select this, Harness will not check to see
    if the workload has reached steady state.</p><h3>Notes</h3><ul><li>You can scale
    down to <strong>0</strong> to remove all instances.</li></ul><h3>Next Steps</h3><ul><li><a
    href="/article/78oginrhsh-delete-kubernetes-resources">Delete Kubernetes Resources</a></li><li><a
    href="/article/7bpdtvhq92-workflow-variables-expressions">Kubernetes Workflow
    Variable Expressions</a></li></ul><p></p>'
  slug: scale-kubernetes-pods
  tags: []
  is_live: true
