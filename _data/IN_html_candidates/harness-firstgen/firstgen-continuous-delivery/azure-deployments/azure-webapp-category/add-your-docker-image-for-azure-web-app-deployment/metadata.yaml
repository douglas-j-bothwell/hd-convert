type: article
article_id: 8s766bhiec
user_id: mfr0nxh4be
category_id: mfdyp6tf0v
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: Add Your Docker Image for Azure Web App Deployment
slug: add-your-docker-image-for-azure-web-app-deployment
description: Add Docker Images for Azure Web App deployments.
short_version: Add Docker Images for Azure Web App deployments.
tags: []
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2022-08-26T21:41:56.349428Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Add Your Docker Image for Azure Web App Deployment
  description: Add Docker Images for Azure Web App deployments.
  short_version: Add Docker Images for Azure Web App deployments.
  body: '<div class="note-callout">Currently, this feature is behind the Feature Flag
    <code>AZURE_WEBAPP</code>. Contact <a href="https://mail.google.com/mail/?view=cm&amp;fs=1&amp;tf=1&amp;to=support@harness.io"
    target="_blank">Harness Support</a> to enable the feature.</div><p>Setting up
    a Harness Azure Web App deployment is a simple process. You add your Web App&#39;s
    Docker repo and image settings to a Harness Service, and then add any of the Web
    App&#39;s application settings and connection strings.</p><p>These Docker image
    and settings are used when Harness deploys your Web App.</p><div class="note-callout">This
    topic covers adding a Docker image. For steps on adding a non-containerized artifact
    for Web App Deployment, see <a href="/article/rflkjqxod2-add-a-non-containerized-artifacts-for-azure-web-app-deployment">Add
    Non-Containerized Artifacts for Azure Web App Deployment</a>.</div><p></p><h3>Before
    You Begin</h3><ul><li><a href="/article/lluikqw7q7-azure-web-app-deployments-overview">Azure
    Web App Deployments Overview</a></li><li>Make sure that you have connected Harness
    to your Azure subscription as described in <a href="/article/e9k7ngaqiu-connect-to-azure-for-web-app-deployments">Connect
    to Azure and Artifact Repo for Your Web App Deployments</a>.</li></ul><h3>Visual
    Summary</h3><p></p><div class="hd--embed" data-provider="YouTube" data-thumbnail="https://i.ytimg.com/vi/psYt_mYKPFY/hqdefault.jpg"><iframe
    width="200" height="150" src="https://www.youtube.com/embed/psYt_mYKPFY?feature=oembed"
    frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media;
    gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><h3>Supported
    Platforms and Technologies</h3><p>See <a href="/article/220d0ojx5y-supported-platforms">Supported
    Platforms and Technologies</a>.</p><p></p><h3>Limitations</h3><p>The Harness Azure
    Web Application Service type supports the following repos:</p><ul><li><strong>Docker
    Registry:</strong> see <a href="/article/tdj2ghkqb0-add-docker-registry-artifact-servers">Add
    Docker Registry Artifact Servers</a>.</li><li><strong>Artifactory:</strong> see
    <a href="/article/nj3p1t7v3x-add-artifactory-servers">Add Artifactory Servers</a>.</li><li><strong>Azure
    Container Registry:</strong> see <a href="/article/4n3595l6in-add-microsoft-azure-cloud-provider">Add
    Microsoft Azure Cloud Provider</a>.</li><li><strong>Amazon S3:</strong> see <a
    href="/article/wt1gnigme7-add-amazon-web-services-cloud-provider">Add Amazon Web
    Services (AWS) Cloud Provider</a>.</li><li><strong>Jenkins:</strong> see <a href="/article/qa7lewndxq-add-jenkins-artifact-servers">Add
    Jenkins Artifact Servers</a>.</li></ul><h3>Step 1: Create the Harness Service</h3><p>The
    Harness Service represents your Azure Web App.</p><p>You identify the Docker image
    artifact for the app, configuration settings, and any secrets and configuration
    variables.</p><p>In your Harness Application, click <strong>Services</strong>.</p><p>Click
    <strong>Add Service</strong>. The Service settings appear.</p><p>Enter a name
    for your Service. Typically, the same name as the Web App.</p><p>In <strong>Deployment
    Type</strong>, select <strong>Azure Web Application</strong>.</p><p>Click <strong>Submit</strong>.
    The Service is created.</p><h3>Step 2: Add the Docker Image Artifact</h3><p>You
    will add the same Docker image you use in your Web App.</p><p>Ensure you have
    set up a Harness Artifact Server or Azure Cloud Provider that connects to the
    image&#39;s repo. See <a href="/article/e9k7ngaqiu-connect-to-azure-for-web-app-deployments">Connect
    to Azure and Artifact Repo for Your Web App Deployments</a>.</p><p>In the Harness
    Service, click <strong>Add Artifact Source</strong>.</p><p>Select the Artifact
    Server type.</p><p>Fill out the Artifact Source settings.</p><p>For details on
    configuring the supported Artifact Source types, see <a href="/article/gxv9gj6khz-add-a-docker-image-service">Add
    a Docker Image</a>.</p><p>The settings for the Harness Artifact Server and Artifact
    Source are a combination of the container settings in your Azure Web App.</p><p>For
    example, here are the Docker Hub settings in an Azure Web App:</p><div class="note-callout">Container
    Settings is deprecated and will be removed in March of 2021. The Deployment Center
    replaces it. Both options are below.</div><p></p><table><tbody><tr><td><p><strong>Container
    Settings</strong></p></td><td><p><strong>Deployment Center</strong></p></td></tr><tr><td><figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/e9k7ngaqiu/1611873166606/image.png"/></figure></td><td><figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/e9k7ngaqiu/1611873098987/image.png"/></figure></td></tr></tbody></table><p></p><p>Here&#39;s
    the Harness <a href="/article/tdj2ghkqb0-add-docker-registry-artifact-servers">Docker
    Registry Artifact Server</a>:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/e9k7ngaqiu/1611872765502/image.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>The
    above example uses a public repo, and it requires no username or password.</p><p>In
    the Harness Service, the Artifact Source uses this Artifact Server and points
    to the Docker Image Name:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/e9k7ngaqiu/1611872861939/image.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><div
    class="note-callout">The above example uses a <a href="https://hub.docker.com/r/harness/todolist-sample/tags?page=1&amp;ordering=last_updated"
    target="_blank">publicly available Docker image from Harness</a>. You might want
    to use that the first time you set up an Azure Web App deployment.</div><p>When
    are done, click <strong>Submit</strong>.</p><p>Next, click <strong>Artifact History</strong>
    to see the artifacts and builds Harness pulls from the repo.</p><h3>Option: Startup
    Script</h3><p>You can use <strong>Script</strong> to add a startup script for
    your app.</p><p>See <a href="https://docs.microsoft.com/en-us/azure/app-service/faq-app-service-linux#what-are-the-expected-values-for-the-startup-file-section-when-i-configure-the-runtime-stack-"
    target="_blank">What are the expected values for the Startup File section when
    I configure the runtime stack?</a> from Azure.</p><h3>Option: App Service Configuration</h3><p>In
    Azure App Service, app settings are variables passed as environment variables
    to the application code.</p><p>See <a href="https://docs.microsoft.com/en-us/azure/app-service/configure-common"
    target="_blank">Configure an App Service app in the Azure portal</a> from Azure.</p><p>You
    can set these using the Azure CLI:</p><pre>az webapp config appsettings set --resource-group
    &lt;group-name&gt; --name &lt;app-name&gt; --settings DB_HOST=&#34;myownserver.mysql.database.azure.com&#34;</pre><p></p><p>Or
    via the portal:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/8s766bhiec/1611949944061/image.png"/></figure><p>You
    can also set <strong>Application settings</strong> and <strong>Connection strings</strong>
    in the Harness Service.</p><p>Here&#39;s an example of setting <strong>Application
    settings</strong> in the Harness Service:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/8s766bhiec/1611950312799/image.png"/></figure><p>This
    is the same as setting them in the Azure portal <strong>Advanced edit</strong>.</p><p></p><figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/8s766bhiec/1611950462551/image.png"/></figure><h4>Important
    Notes</h4><ul><li>If you add App Service Configuration settings in the Harness
    Service, you must include a <strong>name</strong> (<code>&#34;name&#34;:</code>),
    and the name must be unique. This is the same requirement in Azure App Services.</li><li>Do
    <u>not</u> set Docker settings in the Harness Service <strong>App Service Configuration</strong>.
    Harness will override these using the Docker settings in the Harness Artifact
    Server and Artifact Source.</li></ul><p></p><h4>Using Secrets and Variables Settings</h4><p>You
    can use Harness secrets and Service or Workflow variables in the <strong>Application
    settings</strong> and <strong>Connection strings</strong> in the Harness Service.</p><p>These
    settings use JSON, so ensure that you use quotes around the variable or secret
    reference:</p><pre>  {<br/>    &#34;name&#34;: &#34;PASSWORD&#34;,<br/>    &#34;value&#34;:
    &#34;${$secret.getValue(&#39;secret_key&#39;)}&#34;,<br/>    &#34;slotSetting&#34;:
    false<br/>  },</pre><p></p><h3>Next Step</h3><ul><li><a href="/article/2n35dber6l-define-your-azure-web-app-infrastructure">Define
    Your Azure Web App Infrastructure</a></li></ul><h3>Configure As Code</h3><p>To
    see how to configure the settings in this topic using YAML, configure the settings
    in the UI first, and then click the YAML editor button (<span style="color:#fb9e00"
    data-hd-color="#fb9e00"><strong>&lt;/&gt;</strong></span>).</p>'
  slug: add-your-docker-image-for-azure-web-app-deployment
  tags: []
  is_live: true
