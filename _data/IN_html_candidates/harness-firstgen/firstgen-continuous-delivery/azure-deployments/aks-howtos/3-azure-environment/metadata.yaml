type: article
article_id: 7qsyj7wvpq
user_id: mfr0nxh4be
category_id: mkyr84ulx3
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: 3 - Define Your AKS Target Infrastructure
slug: 3-azure-environment
description: Define the target deployment environment for your application.
short_version: Define the target deployment environment for your application.
tags:
- Azure
- Environment
- Infrastructure Definition
- Service Infrastructure
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2022-07-18T22:29:00.046094Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: 3 - Define Your AKS Target Infrastructure
  description: Define the target deployment environment for your application.
  short_version: Define the target deployment environment for your application.
  body: <div class="tip-callout">This content is for Harness <a href="/article/1fjmm4by22">FirstGen</a>.
    Switch to <a href="/article/m7nkbph0ac">NextGen</a>.</div><p></p><p>Once you&#39;ve
    added a Service to your Application, you can define Environments where your Service
    can be deployed.</p><ul><li><a href="https://docs.harness.io/article/7qsyj7wvpq-3-azure-environment#create_a_new_harness_environment">Create
    a New Harness Environment</a></li><li><a href="https://docs.harness.io/article/7qsyj7wvpq-3-azure-environment#add_an_infrastructure_definition">Add
    an Infrastructure Definition</a></li><li><a href="https://docs.harness.io/article/7qsyj7wvpq-3-azure-environment#next_step">Next
    Step</a></li></ul><h3>Create a New Harness Environment</h3><p>In an Environment,
    you specify the following:</p><ul><li>A Harness Service, such as the Service with
    a Docker image artifact you configured.</li><li>A Cloud Provider, such as the
    Kubernetes Cluster Cloud Provider that you added in <a href="https://docs.harness.io/article/z75kx7sur5-1-harness-account-setup#cloud_providers_setup">Cloud
    Providers Setup</a>.</li></ul><p>An Environment can be a Dev, QA, Production,
    or other environment. You can deploy one or many Services to each Environment.</p><p>The
    following procedure creates an Environment for the Service we set up earlier.</p><ol><li>In
    your Harness Application, click <strong>Environments</strong>. The <strong>Environments</strong>
    page appears.</li><li>Click <strong>Add Environment</strong>. The <strong>Environment</strong>
    dialog appears.</li><li>In <strong>Name</strong>, enter a name that describes
    the deployment environment, for example, <strong>AKS</strong>.</li><li>In <strong>Environment
    Type</strong>, select <strong>Non-Production</strong>.</li><li>Click <strong>SUBMIT</strong>.
    The new <strong>Environment</strong> page appears.</li></ol><h3>Add an Infrastructure
    Definition</h3><p><a href="/article/v3l3wqovbe-infrastructure-definitions">​Infrastructure
    Definitions</a> specify the target deployment infrastructure for your Harness
    Services, and the specific infrastructure details for the deployment, like VPC
    settings. </p><p>To add the Infrastructure Definition, do the following:</p><ol><li>In
    the Harness Environment, click <strong>Add Infrastructure Definition</strong>.
    The <strong>Infrastructure Definition</strong> dialog appears.</li><li>In <strong>Name</strong>,
    enter the name you will to select this Infrastructure Definition when you create
    a Workflow.</li><li>In <strong>Cloud Provider Type</strong>, select <strong>Kubernetes
    Cluster</strong>.</li><li>In <strong>Deployment Type</strong>, select <strong>Kubernetes</strong>.</li><li>Click <strong>Use
    Already Provisioned Infrastructure</strong>. If you were using a Harness <a href="https://docs.harness.io/article/o22jx8amxb-add-an-infra-provisioner">Infrastructure
    Provisioner</a>, you would select <strong>Map Dynamically Provisioned Infrastructure</strong>.</li><li>In
    <strong>Cloud Provider</strong>, select the Cloud Provider you added earlier.
    Ensure that you select the <strong>Kubernetes Cluster Cloud Provider</strong>
    you set up for the AKS connection and not the Azure Cloud Provider you set up
    for the ACR connection.</li><li>In <strong>Namespace</strong>, enter the name
    of the cluster namespace you want to use. As we noted in <a href="https://docs.harness.io/article/jjd1wrre7g-2-service-and-artifact-source#namespace_variable">Namespace
    Variable</a>, you can enter any value here and the Service will use it in its
    Namespace manifest to create the namespace at runtime.</li><li>In <strong>Release
    Name</strong>, you can see the expression Harness uses for tracking a release.
    The release name must be unique across the cluster. The Harness-generated unique
    identifier <code>${infra.kubernetes.infraId}</code> can be used as a suffix to
    ensure a unique release name.</li><li>In <strong>Scope to specific Services</strong>,
    select the Harness Service you created earlier.</li><li>Click <strong>Submit</strong>.</li></ol><p>That
    is all you have to do to set up the deployment Environment in Harness.</p><p>Now
    that you have the Service and Environment set up. Now you can create the deployment
    Workflow in Harness.</p><div class="note-callout">Your Environment can overwrite
    Service Config Variables, Config Files, and other settings. This enables you to
    have a Service keep its settings but have them changed when used with this Environment.
    For example, you might have a single Service but an Environment for QA and an
    Environment for Production, and you want to overwrite the values.yaml setting
    in the Service depending on the Environment. We don&#39;t overwrite any Services
    variables in this guide. For more information, see <a href="https://docs.harness.io/article/2gffsizl8u-kubernetes-environments#override_service_settings">Override
    Service Settings</a> in the <a href="/article/pc6qglyp5h-kubernetes-deployments-overview">Kubernetes
    Deployments</a> doc.</div><h3>Next Step</h3><ul><li><a href="/article/x87732ti68-4-azure-workflows-and-deployments">4
    - Azure Workflows and Deployments</a></li></ul><p></p>
  slug: 3-azure-environment
  tags:
  - Azure
  - Environment
  - Infrastructure Definition
  - Service Infrastructure
  is_live: true
