<div class="tip-callout">This content is for Harness <a href="/article/1fjmm4by22">FirstGen</a>. Switch to <a href="/article/lbhf2h71at">NextGen</a>.</div><div class="note-callout">Currently, this feature is behind the Feature Flag <code>CUSTOM_MANIFEST</code>. Contact <a href="mailto:support@harness.io" target="_blank">Harness Support</a> to enable the feature.</div><p>Typically, you add Helm Charts and manifests to a Harness Kubernetes or Native Helm Service from a Helm or Source Repository by simply pointing at the chart repo.</p><p>You can see how this is done using Harness Kubernetes integration in <a href="/article/2aaevhygep-helm-quickstart">Helm Quickstart</a>, or using Harness Native Helm integration in <a href="/article/ii558ppikj-helm-deployments-overview">Helm Native Deployment Guide Overview</a>.</p><p>Harness also supports less common use cases:</p><ul><li><strong>Packaged charts:</strong> your charts, manifests, templates, etc are in a packaged archive and you simply wish to extract them and use then at runtime.</li><li><strong>Preprocessing charts:</strong> you want to perform some preprocessing or manipulation on the fetched files at runtime.</li><li><strong>Custom chart storage:</strong> your chart is stored using a custom method and you want a generic interface to fetch and pass files to Harness.</li><li><strong>3rd party tools:</strong> you use 3rd party tooling to fetch the files and simply want to integrate in with Harness.</li></ul><p>For these less common use cases, you can use the <strong>Custom Remote Manifests</strong> setting in a Harness Native Helm Service. You add a script to the Service that pulls the package and extracts its contents or performs whatever processing you require. Next, you simply supply the path to the Helm chart to Harness.</p><div class="note-callout"><strong>Looking for other methods?</strong> See <a href="/article/2j2vi5oxrq-define-kubernetes-manifests">Define Kubernetes Manifests</a> and <a href="/article/53qqnebrak-deploy-kubernetes-manifests-packaged-with-artifacts">Add Packaged Kubernetes Manifests</a>.</div><p>In this topic:</p><p></p><ul><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#before_you_begin">Before You Begin</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#supported_platforms_and_technologies">Supported Platforms and Technologies</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#limitations">Limitations</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#review_what_workloads_can_i_deploy">Review: What Workloads Can I Deploy?</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#option_add_secrets_for_script">Option: Add Secrets for Script</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#step_1_create_a_harness_native_helm_service">Step 1: Create a Harness Native Helm Service</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#step_2_use_custom_remote_manifests">Step 2: Use Custom Remote Manifests</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#step_3_add_script_for_chart_file">Step 3: Add Script for Chart File</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#step_4_add_path_to_helm_charts">Step 4: Add Path to Helm Charts</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#option_delegate_selector">Option: Delegate Selector</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#option_override_values_yaml_in_service">Option: Override Values.yaml in Service</a><ul><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#inherit_script_from_service">Inherit Script from Service</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#define_new_script">Define new Script</a></li></ul></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#option_override_values_yaml_in_environment">Option: Override Values.yaml in Environment</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#option_use_a_harness_artifact_source">Option: Use a Harness Artifact Source</a></li><li><a href="https://docs.harness.io/article/xxwna12fso-add-packaged-helm-charts#see_also">See Also</a></li></ul><h3>Before You Begin</h3><ul><li><a href="/article/ii558ppikj-helm-deployments-overview">Helm Native Deployment Guide Overview</a></li><li><a href="/article/2aaevhygep-helm-quickstart">Helm Quickstart</a>: this is not a Native Helm Quickstart. This quickstart shows you how to use your own Kubernetes manifests or a Helm chart (remote or local), and have Harness execute the Kubernetes kubectl calls to build everything without Helm and Tiller needing to be installed in the target cluster.</li></ul><h3>Supported Platforms and Technologies</h3><p>See <a href="/article/220d0ojx5y-supported-platforms">Supported Platforms and Technologies</a>.</p><ul><li>Harness certifies its Helm support using <a href="https://github.com/helm/helm/releases/tag/v3.1.2" target="_blank">Helm 3.1.2</a>.</li><li>Helm chart dependencies are not supported in Git source repositories (Harness <a href="https://docs.harness.io/article/ay9hlwbgwa-add-source-repo-providers">Source Repo Providers</a>). Helm chart dependencies are supported in <a href="https://docs.harness.io/article/0hrzb1zkog-add-helm-repository-servers" target="_blank">Helm Chart Repositories.</a></li></ul><h3>Limitations</h3><ul><li><strong>Custom Remote Manifests</strong> scripts use Bash only.</li><li>Native Helm deployments in Harness use the Basic Workflow strategy only.</li><li>The Delegate that runs the script must have all the software needed for the scripts to execute. You can use <a href="https://docs.harness.io/article/yd4bs0pltf-run-scripts-on-the-delegate-using-profiles">Delegate Profiles</a> to add software to Delegates from Harness.<br/>Typically, when you perform a Native Helm deployment in Harness, Harness checks its Delegates to see which Delegates have Helm installed.<br/>For custom fetching and preprocessing of Helm charts described in this topic, Harness does not perform this check. Use <a href="/article/yd4bs0pltf-run-scripts-on-the-delegate-using-profiles">Delegate Profiles</a> and the <strong>Delegate Selector</strong> option described below to ensure that your deployment uses a Delegate running Helm.</li></ul><h3>Review: What Workloads Can I Deploy?</h3><p>Harness Native Helm supports Deployment, StatefulSet, or DaemonSet as <strong>managed</strong> workloads, but not Jobs.</p><h3>Option: Add Secrets for Script</h3><p>You might pull your chart by simply using cURL, like this:</p><pre>git clone https://github.com/johndoe/Helm-Chart.git</pre><p></p><p>In some cases, your script to pull the remote package will use a user account. For example:</p><pre>curl -sSf -u &#34;johndoe:mypwd&#34; -O &#39;https://mycompany.jfrog.io/module/example/chart.zip&#39;</pre><p></p><p>You can use Harness secrets for the username and password in your script. For example:</p><pre>curl -sSf -u &#34;${secrets.getValue(&#34;username&#34;)}:${secrets.getValue(&#34;password&#34;)}&#34; -O &#39;https://mycompany.jfrog.io/module/example/chart.zip&#39;</pre><p></p><p>For more information, see <a href="/article/ygyvp998mu-use-encrypted-text-secrets">Use Encrypted Text Secrets</a>.</p><h3>Step 1: Create a Harness Native Helm Service</h3><p>Create a Harness Native Helm Service.</p><p>In Harness, click <strong>Setup</strong>, and then click <strong>Add Application</strong>.</p><p>Enter a name for the Application and click <strong>Submit</strong>.</p><p>Click <strong>Services</strong>, and then click <strong>Add Service</strong>. The <strong>Add Service</strong> settings appear.</p><p>In <strong>Name</strong>, enter a name for the Service.</p><p>In <strong>Deployment Type</strong>, select Native Helm, and then ensure <strong>Enable Helm V3</strong> is selected.</p><p>Click <strong>Submit</strong>. The new Harness Native Helm Service is created.</p><h3>Step 2: Use Custom Remote Manifests</h3><p>In your Harness Native Helm Service, in <strong>Chart Specification</strong>, click more options (︙) and select <strong>Custom Remote Manifests</strong>.</p><p>In <strong>Manifest Format</strong>, you can see <strong>Helm Charts</strong>.</p><p>Now you can add your custom script to fetch and/or preprocess your Helm chart and files.</p><h3>Step 3: Add Script for Chart File</h3><p>In <strong>Script</strong>, enter the script that pulls the chart files or package containing your chart file. If you are pulling a package, your script must also extract the files from the package. For example:</p><pre>curl -sSf -u &#34;${secrets.getValue(&#34;username&#34;)}:${secrets.getValue(&#34;password&#34;)}&#34; -O &#39;https://mycompany.jfrog.io/module/example/chart.zip&#39;<br/><br/>unzip chart.zip</pre><p></p><p>You can use Harness Service, Workflow, secrets, and built-in variables in the script.</p><p>The script is run on the Harness Delegate selected in <strong>Delegate Selector</strong> or, if you leave this option empty, the Delegate used by the Kubernetes Cluster Cloud Provider in the Workflow&#39;s Infrastructure Definition.</p><p>Harness creates a temporary working directory on the Delegate host for the downloaded files/package. You can reference the working directory in your script with <code>WORKING_DIRECTORY=$(pwd)</code> or <code>cd $(pwd)/some/other/directory</code>.</p><h3>Step 4: Add Path to Helm Charts</h3><p>Once you have a script that fetches your files and, if needed, extracts your package, you provide Harness with the path to the Helm chart in the expanded folders and files.</p><p>You can enter a path to the chart folder or to the chart file. For example, here is a repo with the chart and related files and how it is referenced in Harness:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/xxwna12fso/1623108530953/image.png"/></figure><p>You can use Harness Service, Workflow, and built-in variables in the path.</p><p>For example, here is the same script using a Service Config Variable:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/xxwna12fso/1623108745340/image.png"/></figure><p>As you can see, there are also Service Config Variables for values.yaml overrides. You can reference these in Harness Environments <strong>Service Configuration Overrides</strong>. This is discussed later in this topic.</p><h3>Option: Delegate Selector</h3><p>Typically, when you perform a Native Helm deployment in Harness, Harness checks its Delegates to see which Delegates have Helm installed.</p><p>For custom fetching and preprocessing of Helm charts described in this topic, Harness does not perform this check. Use <a href="/article/yd4bs0pltf-run-scripts-on-the-delegate-using-profiles">Delegate Profiles</a> and the <strong>Delegate Selector</strong> option described below to ensure that your deployment uses a Delegate running Helm.</p><p>In <strong>Delegate Selector</strong>, select the Selector for the Delegate(s) you want to use. You add Selectors to Delegates to make sure that they&#39;re used to execute the command. For more information, see <a href="/article/c3fvixpgsl-select-delegates-for-specific-tasks-with-selectors">Select Delegates with Selectors</a>.</p><p>Harness will use Delegates matching the Selectors you add.</p><p>If you use one Selector, Harness will use any Delegate that has that Selector.</p><p>If you select two Selectors, a Delegate must have both Selectors to be selected. That Delegate might also have other Selectors, but it must have the two you selected.</p><div class="note-callout">You can use expressions for Harness built-in variables or Account Default variables in <strong>Delegate Selectors</strong>. When the variable expression is resolved at deployment runtime, it must match an existing Delegate Selector.<br/><br/>For example, if you have a Delegate Selector <strong>prod</strong> and the Workflow is using an Environment also named <strong>prod</strong>, the Delegate Selector can be <code>${env.name}</code>. This is very useful when you match Delegate Selectors to Application component names such as Environments, Services, etc. It&#39;s also a way to template the Delegate Selector setting.</div><h3>Option: Override Values.yaml in Service</h3><p>You can override the values.yaml in the remote folder you specified in <strong>Path to Helm Charts</strong> using the <strong>Values YAML Override</strong> option in <strong>Configuration</strong>.</p><p>In <strong>Values YAML Override</strong>, click edit. The <strong>Values YAML Override</strong> settings appear.</p><p>For Custom Remote Manifests, in <strong>Store Type</strong>, click <strong>Custom</strong>.</p><p>Choose from the following options.</p><h4>Inherit Script from Service</h4><p>Select this option if you want to use an alternative values.yaml file from the one in the folder/package you pulled in <strong>Custom Remote Manifest</strong>.</p><p>Enter the path to the override values.yaml from the root of the source repo.</p><p>You can use Harness Service, Workflow, and built-in variables in the path. For example, <code>${serviceVariable.overridesPath}/values-production.yaml</code>.</p><p>You can enter multiple values separated by commas.</p><h4>Define new Script</h4><p>Enter a script to override the script entered in <strong>Custom Remote Manifest</strong>. The new script can download and extract a different package.</p><p>In <strong>Path to Values YAML</strong>, provide the path to the override values.yaml file.</p><p>You can use Harness Service, Workflow, and built-in variables in the script and path. You can enter multiple values separated by commas.</p><h3>Option: Override Values.yaml in Environment</h3><p>You can override Harness Service settings at the Harness Environment level using <strong>Service Configuration Overrides</strong>. See <a href="/article/134kx1k89d-3-helm-environments">Helm Environments</a>.</p><p>In the Harness Environment, in <strong>Service Configuration Override</strong>, click <strong>Add Configuration Overrides</strong>. The Service Configuration Override settings appear.</p><p>In <strong>Service</strong>, select the Native Helm Service using the values.yaml you want to override.</p><p>In <strong>Override Type</strong>, select <strong>Values YAML</strong>.</p><p>Click the <strong>Custom</strong> option.</p><p>The <strong>Custom Manifest Override Configuration</strong> section follows the same guidelines as overriding settings using the Service&#39;s <strong>Values YAML Override</strong> section: <strong>Inherit Script from Service</strong> and <strong>Define new Script</strong>.</p><p>For <strong>Inherit Script from Service</strong>, Harness will use the script you entered to fetch your folder/package and then override the values.yaml file in the folder/package using the value you enter in <strong>Inherit Script from Service</strong>. You can use values or variables.</p><p>Here&#39;s an example overriding the values.yaml using a Service <strong>Config Variable</strong> from the Service you selected:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/xxwna12fso/1623185211754/clean-shot-2021-06-08-at-13-46-24.png"/></figure><h3>Option: Use a Harness Artifact Source</h3><p>The values.yaml file you use can have the image and/or dockercfg values hardcoded. In this case, you don&#39;t need to use a Harness Artifact Source in your Harness Service.</p><p>If you want to use a Harness Service Artifact Source, simply add the artifact in <strong>Artifact Source</strong> as described in <a href="/article/svso08ogpb-2-helm-services">Helm Services</a>.</p><p>In your values.yaml, you must reference the Harness Artifact Source using the Harness built-in variable:</p><ul><li><code>image: ${artifact.metadata.image}</code></li><li>For example, in the values.yaml you would add these variables:</li></ul><pre>...<br/>image: ${artifact.metadata.image}<br/><br/>createNamespace: true<br/>...</pre><p></p><p>And then in the manifest for a deployment, you would reference these variables:</p><pre>...<br/>    spec:<br/>      containers:<br/>        - name: {{ .Chart.Name }}<br/>          image: &#34;{{ .Values.image.repository }}:{{ .Values.image.tag }}&#34;<br/>          imagePullPolicy: {{ .Values.image.pullPolicy }}<br/>...</pre><p></p><h3>See Also</h3><ul><li><a href="/article/p5om530pe0-deploy-a-helm-chart-as-an-artifact">Deploy Helm Charts</a></li><li><a href="/article/53qqnebrak-deploy-kubernetes-manifests-packaged-with-artifacts">Add Packaged Kubernetes Manifests</a></li></ul><p></p>