type: article
article_id: cqidzwbzaa
user_id: mfr0nxh4be
category_id: 7gqn6m2t46
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: Upgrade Native Helm 2 Deployments to Helm 3
slug: upgrade-native-helm-2-deployments-to-helm-3
description: Upgrade native Helm 2 deployments to Helm 3.
short_version: Upgrade native Helm 2 deployments to Helm 3.
tags: []
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2022-07-18T22:32:41.650828Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Upgrade Native Helm 2 Deployments to Helm 3
  description: Upgrade native Helm 2 deployments to Helm 3.
  short_version: Upgrade native Helm 2 deployments to Helm 3.
  body: '<div class="tip-callout">This content is for Harness <a href="/article/1fjmm4by22">FirstGen</a>.
    Switch to <a href="/article/lbhf2h71at">NextGen</a>.</div><div class="note-callout">For
    Kubernetes deployments that use Helm charts, see <a href="/article/lk57k7irla-upgrade-to-helm-3-charts-in-kubernetes-services">Upgrade
    to Helm 3 Charts in Kubernetes Services</a>.</div><p>When you create your native
    <a href="/article/ii558ppikj-helm-deployments-overview">Helm deployments</a> in
    Harness, you can choose to use Helm 2 or <a href="https://helm.sh/blog/helm-3-released/"
    target="_blank">Helm 3</a>.</p><p>If you have already created native Helm 2 deployments,
    you can upgrade your deployments to Helm 3 by following the steps in this topic.</p><div
    class="note-callout"><strong>What&#39;s a native Helm deployment in Harness?</strong>
    Harness provides Kubernetes deployments that use Helm charts without requiring
    Helm or Tiller be installed in your target environment. These are called Harness
    Kubernetes deployments. This is the recommended method. If you want to deploy
    to a Kubernetes cluster using Helm explicitly, you can use native Helm deployments.
    You simply choose <strong>Helm</strong> as the <strong>Deployment Type</strong>
    when you create a Harness Service.</div><p>In this topic:</p><ul><li><a href="/article/cqidzwbzaa-upgrade-native-helm-2-deployments-to-helm-3#before_you_begin">Before
    You Begin</a></li><li><a href="#blog_post">Blog Post</a></li><li><a href="/article/cqidzwbzaa-upgrade-native-helm-2-deployments-to-helm-3#optional_migrate_your_release_history_from_tiller">Optional:
    Migrate Your Release History From Tiller</a></li><li><a href="/article/cqidzwbzaa-upgrade-native-helm-2-deployments-to-helm-3#step_1_add_a_new_delegate_with_helm_3_installed">Step
    1: Add a new Delegate with Helm 3 Installed</a></li><li><a href="/article/cqidzwbzaa-upgrade-native-helm-2-deployments-to-helm-3#step_2_enable_helm_3_on_harness_services">Step
    2: Enable Helm 3 on Harness Services</a></li><li><a href="#notes">Notes</a></li><li><a
    href="/article/cqidzwbzaa-upgrade-native-helm-2-deployments-to-helm-3#troubleshooting">Troubleshooting</a></li></ul><h3>Before
    You Begin</h3><ul><li><a href="/article/ii558ppikj-helm-deployments-overview">Helm
    Deployments Overview</a></li><li><a href="/article/pc6qglyp5h-kubernetes-deployments-overview">Kubernetes
    Deployments Overview</a></li></ul><h3>Blog Post</h3><p>The following blog post
    walks you through creating a Helm 3 deployment from scratch using Harness, including
    a video walkthrough:</p><p><a href="https://harness.io/2020/02/welcome-to-the-harness-family-helm-v3/?wvideo=1adpr2fxl1">Welcome
    to the Harness Family, Helm V3!</a></p><h3>Optional: Migrate Your Release History
    From Tiller</h3><div class="note-callout">This section is not necessary for Harness
    Kubernetes deployments that use Helm charts. For Kubernetes Services, see <a href="/article/lk57k7irla-upgrade-to-helm-3-charts-in-kubernetes-services">Upgrade
    to Helm 3 Charts in Kubernetes Services</a>.</div><p>Helm 3 uses a new data data
    model that impacts your native Helm deployment release history. If you upgrade
    Harness native Helm 2 deployments to Helm 3 without migrating your target cluster
    to Helm 3, your Helm 3 deployments will not include your Helm 2 release history.</p><p>If
    maintaining continuity between your Helm 2 and Helm 3 releases is not required,
    you do not need to migrate your release history to Helm 3. Simply move onto the
    next steps.</p><div class="warning-callout">If you do not migrate your release
    history to Helm 3, the first time you deploy to it using a Harness native Helm
    3 deployment, Harness cannot perform rollback because there will no release history
    available.</div><ol><li>If you want to maintain release continuity between Helm
    2 and Helm 3, migrate your release history to Helm 3 using the steps in <a href="https://helm.sh/blog/migrate-from-helm-v2-to-helm-v3/"
    target="_blank">How to migrate from Helm v2 to Helm v3</a> from Helm.<br/><br/>In
    particular, pay attention to the steps in the <a href="https://helm.sh/blog/migrate-from-helm-v2-to-helm-v3/#migrate-helm-v2-releases"
    target="_blank">Migrate Helm v2 Releases</a>.</li></ol><p>Once you are done migrating,
    follow the steps below.</p><h3>Step 1: Add a new Delegate with Helm 3 Installed</h3><p>If
    you are upgrading your native Helm deployments to Helm 3, you will need to add
    a new Harness Delegate.</p><ol><li>Install and run a new Kubernetes Cluster Delegate
    or Helm Delegate in your target cluster, or install a new Helm Delegate using
    the Kubernetes management platform, Rancher. For steps on setting up a new Delegate,
    use one of the following:</li></ol><ul><li><a href="/article/h9tkwmkrm7-delegate-installation">Delegate
    Installation and Management</a></li><li><a href="/article/6n7fon8rit-using-the-helm-delegate">Using
    the Helm Delegate</a></li></ul><p>You do not need to add a Delegate Profile for
    Helm 3. Harness includes Helm 3 support in any Delegate that can connect to the
    target Kubernetes cluster.</p><p>Harness adds Helm within the Delegate directory
    path, in <strong>/client-tools/helm/v3.0.2</strong>.</p><h3>Step 2: Enable Helm
    3 on Harness Services</h3><ol><li>Log into Harness.</li><li>Click <strong>Setup</strong>,
    and open your Harness Application.</li><li>Open the Harness Service you use for
    native Helm 2 deployments.</li><li>In the Harness Service, click vertical ellipsis
    (<strong>ï¸™</strong>) and then click <strong>Edit</strong>:<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/go8rv7a8jf/1580340686188/image.png"
    style="max-height:25%;max-width:25%" data-hd-height="25%" data-hd-width="25%"/></figure></li><li>Select
    the <strong>Enable Helm V3</strong> setting and click <strong>Submit</strong>.</li></ol><p></p><p></p><figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/cqidzwbzaa/1590689801501/image.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>That&#39;s
    it. Now your Harness Service is upgraded for Helm 3 and you can start using Helm
    3 charts.</p><h3>Notes</h3><h4>Custom Helm Binaries and Delegates</h4><p>Harness
    ships Helm binaries with all Harness Delegates.</p><p>If you want the Delegate
    to use a specific Helm binary, see the steps in <a href="/article/ymw96mf8wy-use-custom-helm-binaries-on-harness-delegates">Use
    Custom Helm Binaries on Harness Delegates</a>.</p><h3>Troubleshooting</h3><p>If
    your deployment uses Helm 3, Harness will select a Delegate that has Helm 3 installed.
    You do not need to make any changes.</p><p>However, if the Infrastructure Definition
    used by the Workflow is configured with a Cloud Provider that uses the Delegate
    Selector of a Delegate that is running Helm 2, your Helm 3 deployment might fail.</p><p>After
    you have installed and run your new Delegate, and installed and run Helm 3 on
    it, add a Selector to your new Delegate and change your Cloud Provider to use
    its Delegate Selector.</p>'
  slug: upgrade-native-helm-2-deployments-to-helm-3
  tags: []
  is_live: true
