type: article
article_id: ulhl7sjxva
user_id: mfr0nxh4be
category_id: noj782z9is
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: Set Up Your Harness Account for Terragrunt
slug: set-up-your-harness-account-for-terragrunt
description: This topic describes how to set up the necessary Harness account components
  for Terragrunt.
short_version: This topic describes how to set up the necessary Harness account components
  for Terragrunt.
tags: []
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2021-11-18T19:44:57.293238Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Set Up Your Harness Account for Terragrunt
  description: This topic describes how to set up the necessary Harness account components
    for Terragrunt.
  short_version: This topic describes how to set up the necessary Harness account
    components for Terragrunt.
  body: '<p>The first step in integrating your Terragrunt files and processes is setting
    up the necessary Harness account components: Delegates, Cloud Providers, and Source
    Repo Providers.</p><p>This topic describes how to set up these components for
    Terragrunt.</p><p>Once your account is set up, you can begin integrating your
    Terragrunt files. See <a href="/article/mkjxbkglih-add-terragrunt-configuration-files">Add
    Terragrunt Configuration Files</a>.</p><p>In this topic:</p><ul><li><a href="https://docs.harness.io/article/ulhl7sjxva-set-up-your-harness-account-for-terragrunt#before_you_begin">Before
    You Begin</a></li><li><a href="https://docs.harness.io/article/ulhl7sjxva-set-up-your-harness-account-for-terragrunt#visual_summary">Visual
    Summary</a></li><li><a href="https://docs.harness.io/article/ulhl7sjxva-set-up-your-harness-account-for-terragrunt#step_1_set_up_harness_delegates">Step
    1: Set Up Harness Delegates</a><ul><li><a href="https://docs.harness.io/article/ulhl7sjxva-set-up-your-harness-account-for-terragrunt#delegate_selectors">Delegate
    Selectors</a></li><li><a href="https://docs.harness.io/article/ulhl7sjxva-set-up-your-harness-account-for-terragrunt#permissions">Permissions</a></li></ul></li><li><a
    href="https://docs.harness.io/article/ulhl7sjxva-set-up-your-harness-account-for-terragrunt#step_2_install_terragrunt_and_terraform_on_delegates_using_delegate_profiles">Step
    2: Install Terragrunt and Terraform on Delegates using Delegate Profiles</a></li><li><a
    href="https://docs.harness.io/article/ulhl7sjxva-set-up-your-harness-account-for-terragrunt#step_3_set_up_the_cloud_provider">Step
    3: Set Up the Cloud Provider</a></li><li><a href="https://docs.harness.io/article/ulhl7sjxva-set-up-your-harness-account-for-terragrunt#step_4_connect_harness_to_your_script_repo">Step
    4: Connect Harness to Your Script Repo</a></li><li><a href="https://docs.harness.io/article/ulhl7sjxva-set-up-your-harness-account-for-terragrunt#next_steps">Next
    Steps</a></li></ul><h3>Before You Begin</h3><ul><li><a href="https://docs.harness.io/article/4o7oqwih6h-harness-key-concepts">Harness
    Key Concepts</a></li><li>Get an overview of how Harness integrates Terragrunt: <a
    href="/article/a6onutvbem-terragrunt-provisioning-with-harness">Terragrunt Provisioning
    with Harness</a>.</li><li><a href="https://docs.harness.io/article/h9tkwmkrm7-delegate-installation">Delegate
    Installation and Management</a></li><li><a href="https://docs.harness.io/article/whwnovprrb-cloud-providers">Add
    Cloud Providers</a></li><li><a href="https://docs.harness.io/article/ay9hlwbgwa-add-source-repo-providers">Add
    Source Repo Providers</a></li></ul><h3>Visual Summary</h3><p>Here&#39;s a 6 minute
    video walkthrough of Harness-Terragrunt integration that shows how each component
    is used:</p><p></p><div class="hd--embed" data-provider="YouTube" data-thumbnail="https://i.ytimg.com/vi/HYSi2LAaYdc/hqdefault.jpg"><iframe
    width="200" height="150" src="https://www.youtube.com/embed/HYSi2LAaYdc?feature=oembed"
    frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media;
    gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><h3>Step 1: Set
    Up Harness Delegates</h3><p>A Harness Delegate performs the Terragrunt provisioning
    in your Terragrunt files. When installing the Delegate for Terragrunt provisioning,
    consider the following:</p><ul><li>The Delegate should be installed where it can
    connect to the target infrastructure. Ideally, this is the same subnet.</li><li>The
    Delegate should have Terragrunt and Terraform installed on its host. For details
    on supported versions, see <a href="/article/a6onutvbem-terragrunt-provisioning-with-harness">Terragrunt
    Provisioning with Harness</a>.</li><li>If you are provisioning the subnet dynamically,
    then you can put the Delegate in the same VPC and ensure that it can connect to
    the provisioned subnet using security groups.</li><li>The Delegate must also be
    able to connect to your file repo. The Delegate will pull the files and related
    scripts at deployment runtime.</li><li>While all Harness Delegates can use Terragrunt,
    you might want to select a Delegate type (Shell Script, Kubernetes, ECS, etc)
    similar to the type of infrastructure you are provisioning.<ul><li>If you are
    provisioning AWS AMIs and ASGs, you&#39;ll likely use Shell Script Delegates on
    EC2 instances or ECS Delegates.</li><li>If you are provisioning Kubernetes clusters,
    you will likely use Kubernetes Delegates.</li></ul></li></ul><ol><li>To install
    a Delegate, follow the steps in <a href="https://docs.harness.io/article/h9tkwmkrm7-delegate-installation">Delegate
    Installation and Management</a>. Once the Delegate is installed, it will be listed
    on the Harness Delegates page.</li></ol><h4>Delegate Selectors</h4><p>If needed,
    add a Delegate Selector to your Delegates. When you add a <strong>Terragrunt</strong>
    <strong>Provisioner</strong> step to your Harness Workflows, you can use the Delegate
    Selector to ensure specific Delegates perform the operations.</p><p>If you do
    not specify a Selector in the <strong>Terragrunt</strong> <strong>Provisioner</strong> step,
    Harness will try all Delegates and then assign the Terragrunt tasks to the Delegates
    with Terragrunt installed.</p><p>To add Selectors, see <a href="https://docs.harness.io/article/h9tkwmkrm7-delegate-installation">Delegate
    Installation and Management</a>.</p><h4>Permissions</h4><p>The Harness Delegate
    requires permissions according to the deployment platform and the operations of
    the Terragrunt and Terraform scripts.</p><p>In many cases, all credentials are
    provided by the account used to set up the Harness Cloud Provider.</p><p>In some
    cases, access keys, secrets, and SSH keys are needed. You can add these in Harness <a
    href="https://docs.harness.io/article/au38zpufhr-secret-management">Secrets Management</a>.
    You can then select them in the <strong>Terragrunt</strong> <strong>Provisioner</strong> step
    in your Harness Workflows.</p><p>For ECS Delegates, you can add an IAM role to
    the ECS Delegate task definition. For more information, see  <a href="https://docs.harness.io/article/h9tkwmkrm7-delegate-installation#trust_relationships_and_roles">Trust
    Relationships and Roles</a>.</p><p></p><h3>Step 2: Install Terragrunt and Terraform
    on Delegates using Delegate Profiles</h3><p>The Delegate should have Terragrunt
    and Terraform installed on its host. For details on supported versions, see <a
    href="/article/a6onutvbem-terragrunt-provisioning-with-harness">Terragrunt Provisioning
    with Harness</a>.</p><p>You can install Terragrunt and Terraform on the Delegate
    using Delegate Profiles.</p><p>For example, here is a Delegate Profile script
    to install Terragrunt and Terraform:</p><pre>##terraform update<br/>set +x<br/>apt-get
    update<br/>apt-get install wget<br/>apt-get -y install git<br/>wget https://releases.hashicorp.com/terraform/0.13.3/terraform_0.13.3_linux_amd64.zip
    apt-get install unzip<br/>unzip terraform_0.13.3_linux_amd64.zip<br/>cp terraform
    /usr/bin/<br/>terraform --version<br/><br/>wget https://github.com/gruntwork-io/terragrunt/releases/download/v0.28.0/terragrunt_linux_amd64<br/>mv
    terragrunt_linux_amd64 terragrunt<br/>chmod u+x terragrunt<br/>mv terragrunt /usr/local/bin/terragrunt<br/>terragrunt
    --version</pre><p></p><p>See <a href="/article/yd4bs0pltf-run-scripts-on-the-delegate-using-profiles">Run
    Scripts on Delegates using Profiles</a>.</p><div class="note-callout">The Delegate
    needs to be able to obtain any providers you specify in modules. For example, <code>provider
    &#34;acme&#34;</code>. On the Delegate, Terraform will download and initialize
    any providers that are not already initialized.</div><h3>Step 3: Set Up the Cloud
    Provider</h3><p>Add a Harness Cloud Provider to connect Harness to your target
    platform (AWS, Kubernetes cluster, etc).</p><p>Later, when you use Terragrunt
    to define a Harness Infrastructure Definition, you will also select the Cloud
    Provider to use when provisioning.</p><p>When you create the Cloud Provider, you
    can enter the platform account information for the Cloud Provider to use as credentials,
    or you can use the Delegate(s) running in your infrastructure to provide the credentials
    for the Cloud Provider.</p><p>If you are provisioning infrastructure on a platform
    that requires specific permissions, the account used by the Cloud Provider needs
    the required policies. For example, to create AWS EC2 AMIs, the account needs
    the <strong>AmazonEC2FullAccess</strong> policy. See the list of policies in <a
    href="https://docs.harness.io/article/whwnovprrb-cloud-providers">Add Cloud Providers</a>.</p><p>When
    the Cloud Provider uses the installed Delegate for credentials (via its Delegate
    Selector), it assumes the permissions/roles used by the Delegate (service accounts,
    etc).</p><h3>Step 4: Connect Harness to Your Script Repo</h3><p>To use your Terragrunt
    and Terraform files in Harness, you host the files in a Git repo and add a Harness
    Source Repo Provider that connects Harness to the repo. For steps on adding the
    Source Repo Provider, see <a href="https://docs.harness.io/article/ay9hlwbgwa-add-source-repo-providers">Add
    Source Repo Providers</a>.</p><p>Here is an example of a Source Repo Provider
    and the GitHub repo for Terragrunt. The Terragrunt configuration file in the repo
    points to a Terraform module in another repo.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ulhl7sjxva/1619124990605/image.png"/></figure><h3>Next
    Steps</h3><ul><li><a href="/article/mkjxbkglih-add-terragrunt-configuration-files">Add
    Terragrunt Configuration Files</a></li></ul><p></p>'
  slug: set-up-your-harness-account-for-terragrunt
  tags: []
  is_live: true
