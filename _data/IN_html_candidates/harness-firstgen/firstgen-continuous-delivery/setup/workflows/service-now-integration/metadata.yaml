type: article
article_id: 7vsqnt0gch
user_id: mfr0nxh4be
category_id: a8jhf8hizv
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: ServiceNow Integration (FirstGen)
slug: service-now-integration
description: Using ServiceNow (SNOW) tickets from one or more ServiceNow instances,
  you can track and audit the progress of Harness deployments and Pipelines, and can
  approve or reject Pipeline stages.
short_version: Integrate Harness with ServiceNow (SNOW) to track and audit the progress
  of Harness deployments, and to approve or reject Pipeline stages from within ServiceNow.
tags:
- SNOW
- variable
- custom field
- Collaboration Provider
- issueNumber
- transformationValues
- Import Set
- transformation table
- Change Request
- Change Task
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2022-09-12T19:11:54.462471Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: ServiceNow Integration (FirstGen)
  description: Using ServiceNow (SNOW) tickets from one or more ServiceNow instances,
    you can track and audit the progress of Harness deployments and Pipelines, and
    can approve or reject Pipeline stages.
  short_version: Integrate Harness with ServiceNow (SNOW) to track and audit the progress
    of Harness deployments, and to approve or reject Pipeline stages from within ServiceNow.
  body: |-
    <p>Using <a href="https://docs.servicenow.com/">ServiceNow</a> (SNOW) tickets from one or more ServiceNow instances, you can track and audit the progress of Harness deployments and Pipelines, and can approve or reject Pipeline stages.</p><h3>Video Summary</h3><div class="hd--html"><iframe width="560" height="315" src="https://www.youtube.com/embed/pN3H5RMlfWg" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe></div><h3>ServiceNow Collaboration Provider</h3><p>To use ServiceNow integration in your Workflow or Pipeline, you must first add a ServiceNow account as a Harness Collaboration Provider. For instructions and required permissions, see <a href="/article/vftxcr51xx-add-service-now-collaboration-provider">Add ServiceNow Collaboration Provider</a>.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1556224360246/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Once you have added a ServiceNow account to Harness, you can integrate ServiceNow into your Workflows and Pipelines.</p><h3>UTC Timezone Only</h3><p>The ServiceNow API only allows date time and time values in the UTC timezone. Consequently, input for any datetime/time fields in Harness ServiceNow steps must be provided in UTC format irrespective of time zone settings in your ServiceNow account.</p><p>The timezone settings govern the <u>display value</u> of the settings not their <u>actual</u> value.</p><div class="note-callout">The display values in the Harness UI depend on ServiceNow timezone settings.</div><div class="hd--md" data-hd-markdown="&lt;span id=&#34;create_and_update_tickets_in_a_workflow&#34;&gt;&lt;/span&gt;"><p><span id="create_and_update_tickets_in_a_workflow"></span></p>
    </div><h3>Create ServiceNow Tickets in a Workflow</h3><p>You can create and update ServiceNow tickets during the execution of a Harness Pipeline Stage or Workflow. This section will cover creating and updating tickets in a Workflow. We will create a ServiceNow ticket in an existing Workflow&#39;s <strong>Pre-deployment Steps</strong>, and then update the same ticket in the <strong>Post-deployment Steps</strong> as the Workflow completes.</p><p>To use a ServiceNow ticket as part of a Workflow, do the following:</p><ol><li>Ensure that you have added a ServiceNow account as a Harness Collaboration Provider, as described in <a href="/article/vftxcr51xx-add-service-now-collaboration-provider">Add ServiceNow Collaboration Provider</a>.</li><li>Open an existing Harness Workflow, or create a new one. In this example, we are using a Canary Deployment Workflow.</li><li>In <strong>Pre-deployment Steps</strong>, click <strong>Add Step</strong>.</li><li>In the <strong>Add Command</strong> dialog, click <strong>ServiceNow</strong>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564471342516/image.png" style="max-height:15%;max-width:15%" data-hd-height="15%" data-hd-width="15%"/></figure>The <strong>ServiceNow</strong> dialog appears.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564471385138/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li></ol><p>The <strong>ServiceNow</strong> dialog has the following fields:</p><ul><li><strong>Title</strong> – By default, the step is titled ServiceNow. If you are creating a ServiceNow ticket, you might want to rename the step ServiceNow Creation, for example.</li><li><strong>Request Type</strong> – Select <strong>Create an Issue</strong>. (The <a href="#update">Update an Issue</a> and <a href="#import_set">Import Set</a> options are discussed below.)</li><li><strong>Connector</strong> – Select the ServiceNow account to use, by selecting the ServiceNow Collaboration Provider set up for that account. For more information, see <a href="/article/cv98scx8pj-collaboration-providers#service_now">ServiceNow</a>.<br/><br/>When you select the ServiceNow Collaboration Provider, any account-specific fields in that ServiceNow account are pulled into the dialog. For example, here are the <strong>Impact</strong> and <strong>Urgency fields</strong>, with their values displayed:<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1556228512017/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li><strong>Ticket Type</strong> – Select a ServiceNow ticket type from the list of types.</li><li><strong>Short Description</strong> – Add a description for the ticket you are creating. This will be the ticket title. (You can use Harness variables in the <strong>Short Description</strong> and <strong>Description</strong> fields. Simply type <strong>$</strong> and a list of available variables appears, as shown below.)<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1556226370535/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li><strong>Description</strong> – Add the ticket description.</li><li><strong>Output in the Context</strong> – Select this option to create a variable for the ServiceNow issue. You can reference this variable in another step in this Workflow, or in a Pipeline.</li></ul><ol><li style="counter-increment:li 4" start="5">Select <strong>Output in the Context</strong>, and in <strong>Variable Name</strong>, enter a name, such as <strong>snow</strong>.</li><li>In <strong>Scope</strong>, select <strong>Pipeline</strong>, <strong>Workflow</strong>, or <strong>Phase</strong>. The <strong>Pipeline</strong> scope is the widest, and includes the <strong>Workflow</strong> and <strong>Phase</strong> scopes. Next widest is <strong>Workflow</strong>, which includes any phases within that Workflow. And finally, <strong>Phase</strong> scopes the variable to the Workflow phase in which it was created.<br/><br/>For example, a variable with a <strong>Pipeline</strong> scope can be used by any step in the Pipeline which uses this Workflow, such as an <strong>Approval Step</strong>. For this example, we will use the <strong>Pipeline</strong> scope.<br/><br/>Now that there is an output variable, you can add activity to the same ServiceNow ticket using the variable name. We will use this variable when we <a href="#update">update</a> this ticket, but for now, note that the syntax to reference the variable is <code>${variable_name.issueNumber}</code>. For example, <code>${snow.issueNumber}</code>.</li></ol><div class="note-callout">Presently, the only ServiceNow issue element you can reference is the issue ID, using <code>issueNumber</code>. Harness will be adding more issue element variables in the near future.</div><p>When the <strong>ServiceNow</strong> dialog is complete, it will look something like this:</p><p></p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564441052919/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p>Note the use of Harness variables in the <strong>Description</strong> field:</p><pre>Deploying Workflow: ${workflow.name}<br/>Deployment URL: ${deploymentUrl}</pre><p>The variables will be replaced at runtime with deployment information. For more information on Harness variables, see <a href="/article/9dvxcegm90-variables">Variables and Expressions in Harness</a>.</p><p>Once the Workflow is deployed, the Harness Manager <strong>Deployments</strong> page displays a link to the ServiceNow ticket that the ServiceNow step created:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1556227091556/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p>Click this link to view the ticket in ServiceNow.</p><p>To see the variables you used in the <strong>Descriptions</strong> field, click the <strong>Details</strong> section&#39;s More Options ⋮ menu, and select <strong>View Execution Context</strong>.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1556227165341/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>The runtime output is displayed:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1556227229257/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><div class="hd--md" data-hd-markdown="&lt;span id=&#34;configure_fields&#34;&gt;&lt;/span&gt; &lt;span id=&#34;custom_fields&#34;&gt;&lt;/span&gt;"><p><span id="configure_fields"></span> <span id="custom_fields"></span></p>
    </div><h4>Configure Custom Fields</h4><p>A Workflow&#39;s <strong>ServiceNow</strong> dialog includes the <strong>Configure Fields</strong> option shown below. This multi-select drop-down enables you to access multiple custom fields from your ServiceNow integration.</p><div class="note-callout">Harness only shows English (EN) language fields fetched from your ServiceNow server. It does not support fields in other languages.</div><p>Type the first few characters of a field name to quickly jump to that field. You can also scroll the list.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564443788668/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p>Select each field that you want to add. You can also toggle the <strong>Select All</strong> check box to add, or remove, all custom fields.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564445363086/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p>When you close the drop-down, all of your selected fields are added to the dialog. You can now write static values, or variables, to these fields.</p><p></p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564445758255/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p></p><div class="hd--md" data-hd-markdown="&lt;span id=&#34;update&#34;&gt;&lt;/span&gt;"><p><span id="update"></span></p>
    </div><h3>Update ServiceNow Tickets</h3><p>This section shows how to update the ServiceNow ticket in the <strong>Post-deployment Steps</strong> of the Workflow we used above.</p><ol><li>In <strong>Post-deployment Steps</strong>, click <strong>Add Step</strong>, and click <strong>ServiceNow</strong>. The <strong>ServiceNow</strong> dialog appears.</li><li>In <strong>Request Type</strong>, click <strong>Update an Issue</strong>. The dialog changes to display the update settings.</li></ol><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1556230819013/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><ol><li style="counter-increment:li 2" start="3">In <strong>Connector</strong>, select the same ServiceNow Collaboration Provider you used to create the ticket.</li><li>In <strong>Ticket Type</strong>, select the same type.</li><li>In <strong>Issue Number</strong>, use the output variable expression to identity the ticket you created in the ServiceNow step where you created the ticket. The output variable name was <strong>snow</strong>, so the variable is <code>${snow.issueNumber}</code>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1556231308226/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>In <strong>Update State</strong>, update the ticket information.</li><li>In <strong>Add work notes</strong>, add any notes. You can also use Harness variables, for example: <strong>Started progress on Workflow:</strong> <code>${deploymentUrl}</code>.</li><li>You can also output this issue number using <strong>Output in the Context</strong> and change the scope.</li></ol><p>When you are done, the dialog will look something like this:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564442027203/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p>Click <strong>SUBMIT</strong>. Your Workflow now has a ServiceNow step in its <strong>Pre</strong> and <strong>Post-deployment Steps</strong>:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1556231736497/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>When Workflow is deployed, the ServiceNow steps are displayed.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1620862652166/image.png"/></figure><p>Clicking the link to the ServiceNow ticket takes you directly to the ticket in ServiceNow, and reveals all the activity logged during the Workflow steps:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/7vsqnt0gch/1620862702833/image.png"/></figure><p>Now you know how to create and update ServiceNow tickets in your Workflows. The following sections cover additional ticket creation and update options. Later, this topic will cover how to use ServiceNow tickets for <a href="#approvals">Pipeline Approval stages</a>.</p><p></p><div class="hd--md" data-hd-markdown="&lt;span id=&#34;import_set&#34;&gt;&lt;/span&gt;"><p><span id="import_set"></span></p>
    </div><h3>Import Set</h3><p>The ServiceNow (Workflow) dialog&#39;s <strong>Import Set</strong> option is an alternative to <strong>Create an Issue</strong> or <strong>Update an Issue</strong>. This option invokes ServiceNow&#39;s Import Set API to create or update tickets via a ServiceNow staging table.</p><p></p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564516596067/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>As shown in the Workflow step above, enabling the <strong>Import Set</strong> radio button exposes the following Import Set–specific fields in the dialog&#39;s body:</p><h4>Staging Table Name</h4><p>Specifies the staging table that will be used to import Harness data into ServiceNow. These intermediate tables&#39; names are prefixed with <strong>u_</strong>.</p><h4>JSON Body</h4><p>Contains the JSON that this Workflow step will pass when it makes a call to ServiceNow&#39;s Import Set API. The example above creates a Change Request with comment based on the <strong>u_harness</strong> table&#39;s transformation map.</p><p>You can use <a href="/article/9dvxcegm90-variables">Harness variable expressions</a> in the JSON of <strong>JSON Body</strong>. For example, you could create a Workflow variable named <code>importset</code> and then reference it in <strong>JSON Body</strong> as <code>{&#34;u_example&#34;:&#34;${workflow.variables.importset}&#34;}</code>.</p><div class="note-callout">For details on the table requirements and naming, see <a href="https://docs.servicenow.com/en-US/bundle/sandiego-platform-administration/page/administer/table-administration/task/t_CreateATable.html" target="_blank">Create a table</a> from ServiceNow.</div><h4>Transform Table Maps</h4><p>Within ServiceNow, Transform Table Maps determine how data will be written from the staging table to existing target tables. Map rows determine whether the transformation will create or update a ticket, and determine the ticket type.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564518543666/image.png"/></figure><p></p><p>Here, Harness&#39; Deployments page shows successful execution of the Workflow step configured above:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564684213554/image.png"/></figure><p></p><p>The highlighted <strong>Transformation Values</strong> field indicates the import set&#39;s output values. These values are available in the Harness variable <code>myVar.transformationValues[0]</code> . The same Workflow&#39;s steps 1–4 will access this variable, under <a href="#changes">Change Requests/Change Tasks</a> below.</p><p></p><div class="hd--md" data-hd-markdown="&lt;span id=&#34;changes&#34;&gt;&lt;/span&gt;"><p><span id="changes"></span></p>
    </div><h3>Change Requests/Change Tasks</h3><p>Harness incorporates ServiceNow&#39;s hierarchy of Change Requests and linked Change Tasks. Shown below is a Workflow step that creates a new ticket of type <strong>Change Task</strong>, linked to an existing Change Request.</p><p>We&#39;ve specified the <strong>Change Request Number</strong> using the <code>myVar</code> variable shown in earlier the <a href="#import_set">Import Set</a> example, and have also created a new output variable, <code>myVar2</code>:</p><p></p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564522696745/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p></p><p>Once the Change Task is created in ServiceNow, we can update it in a later Workflow step, by selecting <strong>Update an Issue</strong> and <strong>Ticket Type: Change Task</strong>. To identify the Change Task ticket to update, we can either enter an <strong>Issue Number</strong>, or (as shown in this example) we can use the output variable <code>myVar.transformationValues[0]</code> created in the <a href="#import_set">previous Workflow step</a>.</p><p></p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564522098363/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>For Change Tasks only, you can select the <strong>Update Multiple</strong> check box. This exposes the <strong>Change Task Type</strong> drop-down shown below. In this example, all Change Tasks of type <strong>Planning</strong> will be updated with the selected <strong>Update State</strong>, and with the contents of the <strong>Add Work Notes</strong> field.</p><p></p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564522839817/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p>Once all Change Tasks have been resolved, you can close the associated Change Request by selecting <strong>Update an Issue</strong> and <strong>Ticket Type: Change</strong>. Here, we&#39;re specifying the <strong>Issue Number</strong> using our original variable.</p><p></p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pd577nwcx3/1564522116340/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p></p><div class="hd--md" data-hd-markdown="&lt;span id=&#34;approvals&#34;&gt;&lt;/span&gt;"><p><span id="approvals"></span></p>
    </div><h3>ServiceNow-based Approvals</h3><p>You can use a ServiceNow ticket as an approval stage in a Harness Pipeline and, when the ticket is updated, the Pipeline stage can be approved or rejected. For example, changing the <strong>State attribute</strong> of a ServiceNow ticket from <strong>Resolved</strong> to <strong>Approved</strong> could automatically approve the execution of a Pipeline stage or Workflow deployment in Harness.</p><p>For more information, see <a href="/article/9nkuhm8moo-service-now-ticketing-system">ServiceNow Approvals</a>.</p><p></p>
  slug: service-now-integration
  tags:
  - SNOW
  - variable
  - custom field
  - Collaboration Provider
  - issueNumber
  - transformationValues
  - Import Set
  - transformation table
  - Change Request
  - Change Task
  is_live: true
