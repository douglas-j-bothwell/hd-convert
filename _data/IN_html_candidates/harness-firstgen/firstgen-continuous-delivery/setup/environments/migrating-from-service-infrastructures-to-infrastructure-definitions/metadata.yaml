type: article
article_id: okjgg4hcve
user_id: mfr0nxh4be
category_id: 1eqg76ac72
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: Migrating from Service Infrastructures to Infrastructure Definitions
slug: migrating-from-service-infrastructures-to-infrastructure-definitions
description: Harness Infrastructure Definitions replace Service Infrastructures and
  provide several benefits described in this topic.
short_version: Harness Infrastructure Definitions replace Service Infrastructures
  and provide several benefits described in this topic.
tags:
- Infrastructure Definition
- Service Infrastructure
- migration
- migrate
- Scope to specific Services
- Environment
- Service Mapping
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2021-05-12T17:22:35.071582Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Migrating from Service Infrastructures to Infrastructure Definitions
  description: Harness Infrastructure Definitions replace Service Infrastructures
    and provide several benefits described in this topic.
  short_version: Harness Infrastructure Definitions replace Service Infrastructures
    and provide several benefits described in this topic.
  body: <p>Harness <a href="/article/v3l3wqovbe-infrastructure-definitions">Infrastructure
    Definitions</a> replace Service Infrastructures and provide the benefits described
    below.</p><p><strong>How do I migrate?</strong> Contact Harness Support at <a
    href="mailto:support@harness.io?subject=Migrating to Infrastructure Definitions">support@harness.io</a>.</p><p>In
    this topic:</p><ul><li><a href="https://docs.harness.io/article/okjgg4hcve-migrating-from-service-infrastructures-to-infrastructure-definitions#overview_of_changes">Overview
    of Changes</a></li><li><a href="https://docs.harness.io/article/okjgg4hcve-migrating-from-service-infrastructures-to-infrastructure-definitions#what_will_happen_when_i_migrate">What
    Will Happen When I Migrate?</a></li><li><a href="https://docs.harness.io/article/okjgg4hcve-migrating-from-service-infrastructures-to-infrastructure-definitions#optimize_infrastructure_setup">Optimize
    Infrastructure Setup</a></li><li><a href="https://docs.harness.io/article/okjgg4hcve-migrating-from-service-infrastructures-to-infrastructure-definitions#infrastructure_provisioner_service_mappings_moved_to_infrastructure_definitions">Infrastructure
    Provisioner Service Mappings moved to Infrastructure Definitions</a></li></ul><h3>Overview
    of Changes</h3><p>Here is a quick summary of the changes from Service Infrastructures
    to Infrastructure Definitions:</p><table style="table-layout:fixed"><tbody><tr><td><p><strong>Service
    Infrastructure</strong></p></td><td><p><strong>Infrastructure Definitions</strong></p></td></tr><tr><td><p><strong>One-to-One:</strong></p><p>Each
    Service Infrastructure is tied to one Harness Service.</p></td><td><p><strong>One-to-Many:</strong></p><p>Each
    Infrastructure Definition can be used by multiple Harness Services of the same
    Deployment Type.</p></td></tr><tr><td><p><strong>Single-Cluster Infrastructure:</strong></p><p>Need
    to create multiple Service Infrastructures for the same ECS or Kubernetes cluster.</p></td><td><p><strong>Multi-Cluster
    Infrastructure:</strong></p><p>A single Infrastructure Definition for a cluster
    can be shared by all the microservices you want deployed to the cluster.</p></td></tr><tr><td><p><strong>Cannot
    Control Scope:</strong></p><p>Cannot scope two or more Services to the same Service
    Infrastructure.</p></td><td><p><strong>Scope Control:</strong></p><p>You can choose
    to scope the Infrastructure Definition to one or more Services, manually or automatically
    following deployment.</p></td></tr><tr><td><p><strong>Manual Mapping:</strong></p><p>You
    must manually set up each Service Infrastructure for each Service.</p></td><td><p><strong>Mapped
    Automatically:</strong></p><p>If the Infrastructure Definition is <em>unscoped</em>
    (not limited to specific Services), when a Workflow using a Service and Infrastructure
    Definition is deployed, the Service is automatically mapped to the Infrastructure
    Definition.</p></td></tr></tbody></table><p></p><div class="note-callout">To avoid
    collisions when multiple Workflows are deploying to the same Infrastructure Definition,
    Harness employs <a href="/article/hui1k7seo1-workflow-queuing">Workflow Queuing</a>.</div><h3>What
    Will Happen When I Migrate?</h3><p>Once you migrate to Infrastructure Definitions,
    the following changes will appear in your Harness account.</p><h4>Service Infrastructures
    Replaced by Infrastructure Definitions</h4><p>New Infrastructure Definitions will
    be scoped to the Service that was used by the Service Infrastructure. See <a href="/article/v3l3wqovbe-infrastructure-definitions#scope_to_specific_services">Scope
    to Specific Services</a>.</p><p>For example, if you had two Service Infrastructures
    for the same Service, you will now have two Infrastructure Definitions, each scoped
    to that Service.</p><h4>Service Mappings Moved to Infrastructure Definitions</h4><p>Service
    Mappings in an Infrastructure Provisioner used by a Service Infrastructure are
    moved into the Infrastructure Definition that replaced the Service Infrastructure.</p><p>See
    <a href="https://docs.harness.io/article/okjgg4hcve-migrating-from-service-infrastructures-to-infrastructure-definitions#infrastructure_provisioner_service_mappings_moved_to_infrastructure_definitions">Infrastructure
    Provisioner Service Mappings moved to Infrastructure Definitions</a> below.</p><h3>Optimize
    Infrastructure Setup</h3><p>Service Infrastructures were a one-to-one mapping
    of one Harness Service and one Harness Service Infrastructure. You had to create
    a separate Service Infrastructure for each Service. If you wanted to deploy many
    Services to the same infrastructure, you had to create a new Service Infrastructure
    for each Serviceâ€”a repetitive process.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1570571726038/image.png"/></figure><p>Infrastructure
    Definitions decouple infrastructures from Harness Services, allowing you to create
    one Infrastructure Definition and share it with <em>many</em> Services. There
    is no need to repeatedly set up Service Infrastructures for multiple Services.</p><p>You
    can scope an Infrastructure Definition to as many Services as needed, or leave
    the Infrastructure Definition <em>unscoped</em>, which allows it to be used by
    any Workflow deploying a Service of the same Deployment Type (Kubernetes, AMI,
    ECS, etc).</p><h3>Infrastructure Provisioner Service Mappings moved to Infrastructure
    Definitions</h3><p>Infrastructure Definitions also replace the Service Mappings
    that were previously set up in Harness <a href="/article/o22jx8amxb-add-an-infra-provisioner">Infrastructure
    Provisioners</a>.</p><p>Service Mappings mapped provisioner outputs to the required
    settings Harness needs to provision infrastructure, such as VPC regions and Kubernetes
    namespaces.</p><p>With Infrastructure Definitions, provisioner outputs are mapped
    in Infrastructure Definitions that use Harness Infrastructure Provisioners. This
    way, mappings are part of the Infrastructure Definitions that use the provisioner
    and mappings are performed once and applied to any Services that use the Infrastructure
    Definitions.</p><p>Here is an example of a Terraform Service Mapping using the
    old Service Infrastructure method, and how the same mapping is now performed using
    an Infrastructure Definition:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1569870678945/image.png"/></figure><p>The
    YAML settings for Service Mappings are also moved to the new Infrastructure Definitions:</p><p></p><figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/other/1568932259518/image.png" style="max-height:50%;max-width:50%"
    data-hd-height="50%" data-hd-width="50%"/></figure><p></p>
  slug: migrating-from-service-infrastructures-to-infrastructure-definitions
  tags:
  - Infrastructure Definition
  - Service Infrastructure
  - migration
  - migrate
  - Scope to specific Services
  - Environment
  - Service Mapping
  is_live: true
