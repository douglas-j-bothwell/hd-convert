<p>For GitHub, GitLab, and Bitbucket, you can trigger <a href="/article/wqytbv2bfd-ci-cd-with-the-build-workflow">Build Workflows</a> or a <a href="/article/0tphhkfqx8-artifact-build-and-deploy-pipelines-overview">Build and Deploy Pipeline</a> in response to a Git event using Webhooks using a Harness <a href="/article/ys3cvwm5gc-trigger-a-deployment-on-git-event">On Webhook Event</a> Trigger. </p><p>For Custom Git providers, you can trigger any type of Workflow using a Harness <a href="/article/ys3cvwm5gc-trigger-a-deployment-on-git-event">On Webhook Event</a> Trigger. This is described in <a href="/article/ys3cvwm5gc-trigger-a-deployment-on-git-event">Trigger Deployments using Git Events</a>.</p><p>Once you have created a Harness On Webhook Event Trigger, Harness creates a <strong>Manual Trigger</strong> for it.</p><p>You can do the following with a Manual Trigger:</p><ul><li>Start a deployment using a cURL command.</li><li>Use a REST call to get deployment status. See <a href="/article/uccck6kq5m-get-deployment-status-using-rest">Get Deployment Status using REST</a>.</li><li>Start a deployment using a URL provided by Harness. See <a href="/article/3key6nybou-trigger-a-deployment-using-a-url">Trigger a Deployment using a URL</a>.</li></ul><p>This topic describes how to obtain and use the cURL command.</p><div class="note-callout">For GitHub, GitLab, and Bitbucket, this option is used to execute a Build Workflow or a Build Pipeline only.</div><h3>Before You Begin</h3><ul><li> <a href="/article/wqytbv2bfd-ci-cd-with-the-build-workflow">Build Workflows</a></li><li> <a href="/article/0tphhkfqx8-artifact-build-and-deploy-pipelines-overview">Build and Deploy Pipeline</a></li><li> <a href="/article/eb3kfl8uls-service-configuration">Add a Service</a></li><li> <a href="/article/m220i1tnia-workflow-configuration">Workflows</a></li><li> <a href="/article/n39w05njjv-environment-configuration">Add Environment</a></li><li> <a href="/article/zc1u96u6uj-pipeline-configuration">Create a Pipeline</a></li></ul><h3>Limitations</h3><ul><li>In the <strong>Actions</strong> section of the Trigger, the <strong>Deploy only if files have changed</strong> option is available for Workflows deploying Kubernetes or Native Helm Services only.</li></ul><h4>Data retention</h4><p>Data retention for Webhook event details is 3 days.</p><h4>Trigger Processing Details</h4><p>To see the event details, in the response of a Webhook request the <code>data</code> field contains the Id of the registered WebHook event. You can use the following API and the <code>eventId</code> to get the details of the WebHook Event:</p><pre>curl -i -X GET \<br/>  &#39;https://app.harness.io/gateway/pipeline/api/webhook/triggerProcessingDetails?accountIdentifier=&lt;account Id&gt;&amp;eventId=&lt;data Id&gt;&#39; \<br/>  -H &#39;x-api-key: &lt;Harness API key&gt;&#39;</pre><p></p><p>If you want to access the <code>triggerProcessingDetails</code> endpoint, you should sleep your cURL command for up to 1 minute after the Trigger is fired. The result should be non-null quickly, but sleeping the cURL command ensures that you receive the data.</p><p>The process happens asynchronously: upon receiving the Trigger call, Harness registers it to a queue which is consumed every 5 seconds by one of its iterators. It is only after the event is consumed by the iterator that the data returned in <code>triggerProcessingDetails</code> is populated.</p><h3>Step 1: Create the Git Webhook Trigger</h3><p>Follow the steps in <a href="/article/ys3cvwm5gc-trigger-a-deployment-on-git-event">Trigger Deployments using Git Events</a>.</p><p>When you are finished, the Trigger is displayed in the Triggers list, and includes a Manual Trigger option.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/mc2lxsas4c/1601932550822/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><h3>Step 2: Get and Run the cURL Command</h3><p>Click <strong>Manual Trigger</strong>.</p><p>In the Manual Trigger, click <strong>Show Curl Command</strong>.</p><p>The curl command is displayed. It will look something like the this (private information has been replaced with <strong>xxxxxx</strong>):</p><pre class="hljs makefile">curl -X POST -H &#39;content-type: application/json&#39; \<br/> --url https://app.harness.io/api/webhooks/xxxxxx \<br/> -d &#39;{&#34;application&#34;:&#34;xxxxxx&#34;,&#34;artifacts&#34;:[{&#34;service&#34;:&#34;micro-service&#34;,&#34;buildNumber&#34;:&#34;micro-service_BUILD_NUMBER_PLACE_HOLDER&#34;}]}&#39;</pre><p></p><p>Copy the curl command, replace the placeholders with actual values, and run it in a terminal.</p><p>To avoid a <code>zsh: no matches found</code> error, add quotes to the URL if it includes a <code>?</code>. For example:</p><pre>curl -X POST -H &#39;content-type: application/json&#39; --url &#39;https://app.harness.io/gateway/api/webhooks/2LdxLfQ71nZaOV4P3kluS3EBJb4TnFW7tS3KMMNM?accountId=xxxx&#39; -d &#39;{&#34;application&#34;:&#34;SgF_NViyTSKf74WkhGd0ZA&#34;}&#39;</pre><h3>Review: Placeholders and Manual Settings</h3><p>When you created a Trigger, if you selected values for parameters that are represented by placeholders in the cURL command, you do not need to add values for the cURL placeholders.</p><p>If you add values for the cURL placeholders, you will override manual settings in the Trigger.</p><p>This is also true for Triggers that execute templated Workflows and Pipelines. If you create a Trigger that executes a templated Workflow or Pipeline, you can select values for the templated settings in the Trigger, but you can still override them in the cURL command.</p><p>Let&#39;s look at a placeholder example:</p><pre>curl -X POST -H &#39;content-type: application/json&#39; \<br/> --url https://app.harness.io/api/webhooks/xxxxxx \<br/> -d &#39;{&#34;application&#34;:&#34;xxxxxx&#34;,&#34;artifacts&#34;:[{&#34;service&#34;:&#34;micro-service&#34;,&#34;buildNumber&#34;:&#34;micro-service_BUILD_NUMBER_PLACE_HOLDER&#34;}]}&#39;</pre><p></p><div class="note-callout">The <code>artifacts</code> setting is optional. If you have an artifact hardcoded in your manifest and do not use a Harness Artifact Source, you will not need <code>artifacts</code>. Remove the <strong>entire</strong> <code>artifacts</code> section: <code>&#34;artifacts&#34;:[{&#34;service&#34;:&#34;micro-service&#34;,&#34;buildNumber&#34;:&#34;micro-service_BUILD_NUMBER_PLACE_HOLDER&#34;}]}&#39;</code></div><p>For <code>service</code>, enter the name of the Harness Service.</p><p>For <code>buildNumber</code>, enter the artifact build number from the Artifact History in the Service.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/xerirloz9a/1582094031206/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>For example:</p><pre>curl -X POST -H &#39;content-type: application/json&#39; \<br/> --url https://app.harness.io/api/webhooks/xxxxxx \<br/> -d &#39;{&#34;application&#34;:&#34;xxxxxx&#34;,&#34;artifacts&#34;:[{&#34;service&#34;:&#34;Service-Example&#34;,&#34;buildNumber&#34;:&#34;1.17.8-perl&#34;}]}&#39;</pre><p></p><p>The output will be something like this (private information has been replaced with <strong>xxxxxx</strong>):</p><p></p><pre>{<br/> &#34;requestId&#34;:&#34;-tcjMxQ_RJuDUktfl4AY0A&#34;,<br/> &#34;status&#34;:&#34;RUNNING&#34;,<br/> &#34;error&#34;:null,<br/> &#34;uiUrl&#34;:&#34;https://app.harness.io/#/account/xxxxxx/app/xxxxxx/pipeline-execution/-xxxxxx/workflow-execution/xxxxxx/details&#34;,<br/> &#34;apiUrl&#34;:&#34;https://app.harness.io/gateway/api/external/v1/executions/-xxxxxx/status?accountId=xxxxxx&amp;appId=xxxxxx&#34;<br/> }<br/></pre><p></p><div class="note-callout">If the Service has multiple Artifact Sources, then you will have to enter the artifact you want to use.</div><p>The <strong>uiUrl</strong> can be used directly in a browser.</p><p>See <a href="/article/3key6nybou-trigger-a-deployment-using-a-url">Trigger a Deployment using a URL</a>.</p><p><strong>apiUrl</strong> can be used to track deployment status programmatically, such as using a REST call.</p><p>See <a href="/article/uccck6kq5m-get-deployment-status-using-rest">Get Deployment Status using REST</a>.</p><h4>Placeholders and Workflow Variables</h4><p>In the cURL command, placeholder values are added for any Workflow variables rather than the variables selected when creating the Trigger.</p><p>The placeholder values added to the cURL command override any existing values, including Workflow variables selected in the Trigger.</p><p>You can choose to ignore the placeholders and not pass values for any variables in the cURL command.</p><h3>Review: Workflow and Pipeline Links in Response</h3><p>In the JSON response of a Workflow/Pipeline executed by a Webhook Trigger, the <code>uiSetupUrl</code> label displays the URL or the Workflow/Pipeline that was run.</p><p>Workflow example:</p><pre>{<br/>   &#34;requestId&#34;:&#34;wmuS6c2pQBaiX38eOcN5fg&#34;,<br/>   &#34;status&#34;:&#34;RUNNING&#34;,<br/>   &#34;error&#34;:null,<br/>   &#34;uiUrl&#34;:&#34;https://qa.harness.io/#/account/xxxxx/app/jL7IEwaKTPmfTlAVWIlHKQ/env/emINy3NOS-ONA1iTqf7wyQ/executions/wmuS6c2pQBaiX38eOcN5fg/details&#34;,<br/>   &#34;uiSetupUrl&#34;:&#34;https://qa.harness.io/#/account/xxxxx/app/jL7IEwaKTPmfTlAVWIlHKQ/workflows/X8rbeQ2oTDWkCyza3DR3Hg/details&#34;,<br/>   &#34;apiUrl&#34;:&#34;https://qa.harness.io/api/external/v1/executions/wmuS6c2pQBaiX38eOcN5fg/status?accountId=xxxxx&amp;appId=jL7IEwaKTPmfTlAVWIlHKQ&#34;,<br/>   &#34;message&#34;:null<br/>}</pre><p></p><p>Pipeline example:</p><pre>{<br/>   &#34;requestId&#34;:&#34;KmbgijMHQ76qyoRhtW-oBA&#34;,<br/>   &#34;status&#34;:&#34;RUNNING&#34;,<br/>   &#34;error&#34;:null,<br/>   &#34;uiUrl&#34;:&#34;https://qa.harness.io/#/account/xxxxx/app/jL7IEwaKTPmfTlAVWIlHKQ/pipeline-execution/KmbgijMHQ76qyoRhtW-oBA/workflow-execution/undefined/details&#34;,<br/>   &#34;uiSetupUrl&#34;:&#34;https://qa.harness.io/#/account/xxxxx/app/jL7IEwaKTPmfTlAVWIlHKQ/pipelines/oMD0__89TpWAUQiru0jSpw/edit&#34;,<br/>   &#34;apiUrl&#34;:&#34;https://qa.harness.io/api/external/v1/executions/KmbgijMHQ76qyoRhtW-oBA/status?accountId=xxxxx&amp;appId=jL7IEwaKTPmfTlAVWIlHKQ&#34;,<br/>   &#34;message&#34;:null<br/>}</pre><h3>Option: Enforce API Keys for Manual Triggers</h3><p></p><div class="note-callout">Currently, this feature is behind the feature flag <code>WEBHOOK_TRIGGER_AUTHORIZATION</code>. Contact <a href="mailto:support@harness.io" target="_blank">Harness Support</a> to enable the feature.</div><p></p><p></p><p>Once you have On Webhook Event Trigger you can use a Manual Trigger to start a deployment using a cURL command provided by Harness.</p><p>By default, the cURL command does not require that you include Harness API keys. Harness provides the option to enforce the use of API keys in Manual Trigger cURL commands per Application.</p><p>By using Harness API keys in your cURL commands, you can enforce <strong>authorization</strong> on manual execution of your Triggers. Harness API keys let you select which Harness User Groups can run the Trigger.</p><h4>Permissions Required</h4><ul><li><strong>Account Permissions:</strong> to enforce API keys for manual triggers, your Harness User account must belong to a User Group with the <strong>Manage Applications</strong> Account Permissions option enabled. See <a href="/article/ven0bvulsj-users-and-permissions">Managing Users and Groups (RBAC)</a>.</li><li><strong>Application Permissions:</strong> to initiate any manual triggers (with or without using API keys), the Harness User account must belong to a User Group with the <strong>Deployments</strong> Permission Type and the <strong>Execute Workflow</strong> and/or <strong>Execute Pipeline</strong> Application Permissions.</li></ul><h4>Enforce API Keys for Manual Triggers</h4><p>To enforce API keys for manual triggers, do the following:</p><p>In Harness, in <strong>Security</strong>, click <strong>Access Management</strong>.</p><p>Click <strong>API Keys</strong>, and then follow the steps in <a href="/article/smloyragsm-api-keys">API Keys</a> to create an API key. Or you can select an existing key.</p><p>Make sure your API key is assigned a User Group that only contains the Harness Users that you want to use this API key to run the Manual Trigger cURL command.</p><p>In the new or existing Harness Application containing your Triggers, click more options (︙) and select <strong>Edit</strong>.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/mc2lxsas4c/1617142807026/image.png"/></figure><p>Select <strong>Authorize Manual Triggers</strong>. Harness presents a warning:</p><blockquote>Warning: When you select &#34;Authorize Manual Triggers&#34; it will become mandatory to provide API keys in headers to authorize Manual Triggers invocation.</blockquote><p></p><p>This means that every Manual Trigger cURL command now includes a placeholder for the API key (<code>x-api-key_placeholder</code>):</p><pre>curl -X POST -H &#39;content-type: application/json&#39; <br/>-H &#39;x-api-key: x-api-key_placeholder&#39; <br/>--url https://app.harness.io/trigger-authorization/api/webhooks/o5w0h6H8Xmllbdp?accountId=wAwixrZwvnhuGVQOJ3sD <br/>-d &#39;{&#34;application&#34;:&#34;T6fPlBO4TWKT-fCPXxamxA&#34;}&#39;</pre><p></p><p>Replace the <code>x-api-key_placeholder</code> with the Harness API key.</p><p>That&#39;s it. Now you have authorization set up on your Manual Trigger.</p><p>Let&#39;s look at the two use cases:</p><ul><li><strong>Authorize Manual Triggers</strong> <strong>is disabled:</strong> the standard Manual Trigger cURL command configuration is used. Manual Trigger cURL commands will not contain the API placeholder or require an API key. If an API key is still provided, Harness checks if the provided key is authorized to invoke the Trigger. Meaning, it checks to see if the User Group assigned to the key has the required Application Permissions (listed above). If User Group assigned to the key does not have the required Application Permissions, then the Trigger cannot be invoked and an error message appears.</li><li><strong>Authorize Manual Triggers is enabled:</strong> if the User Group assigned to the API key has the required Application Permissions (listed above), then the Trigger is invoked.</li></ul><h3>Configure As Code</h3><p>To see how to configure the settings in this topic using YAML, configure the settings in the UI first, and then click the YAML editor button (<span style="color:#fb9e00" data-hd-color="#fb9e00"><strong>&lt;/&gt;</strong></span>).</p><h3>Related Topics</h3><ul><li> <a href="/article/revc37vl0f-passing-variable-into-workflows">Passing Variables into Workflows from Triggers</a></li><li> For information on using Triggers as part of Harness GitOps, see <a href="/article/khbt0yhctx-harness-git-ops">Harness GitOps</a>.</li><li> <a href="/article/s2m2ksxn6a-trigger-a-deployment-on-new-artifact">Trigger Deployments When a New Artifact is Added to a Repo</a></li><li> <a href="/article/tb66fmh4iz-trigger-a-deployment-on-a-time-schedule">Schedule Deployments using Triggers</a></li><li> <a href="/article/nihs2y2z61-trigger-a-deployment-on-pipeline-completion">Trigger Deployments when Pipelines Complete</a></li><li> <a href="/article/uccck6kq5m-get-deployment-status-using-rest">Get Deployment Status using REST</a></li><li> <a href="/article/zr4tgwrzlb-trigger-a-deployment-when-a-file-changes">Trigger a Deployment when a File Changes</a></li><li> <a href="/article/ys3cvwm5gc-trigger-a-deployment-on-git-event">Trigger Deployments using Git Events</a></li><li><a href="/article/3key6nybou-trigger-a-deployment-using-a-url">Trigger a Deployment using a URL</a></li><li> <a href="/article/6vlut5qvlf-freeze-triggers">Pause All Triggers using Deployment Freeze</a></li></ul><p></p>