<p>For GitHub, GitLab, and Bitbucket, you can trigger <a href="https://docs.harness.io/article/wqytbv2bfd-ci-cd-with-the-build-workflow">Build Workflows</a> or a <a href="https://docs.harness.io/article/0tphhkfqx8-artifact-build-and-deploy-pipelines-overview">Build and Deploy Pipeline</a> in response to a Git event using Webhooks using a Harness On Webhook Event Trigger.</p><p>For example, the first stage of the Build and Deploy Pipeline is a Build Workflow that builds the artifact from a Git repo. You can set a Harness Trigger to run once the artifact is built.</p><p>For Custom Git providers, you can trigger any type of Harness Workflow using a Harness On Webhook Event Trigger.</p><div class="note-callout">For GitHub, GitLab, and Bitbucket, this option is used to execute a Build Workflow or a Build Pipeline only. GitHub, GitLab, and Bitbucket Webhook-based Triggers are not intended for Workflows and Pipelines that <strong>deploy</strong> artifacts. They are designed for Build Workflows and Pipelines that build artifacts in response to Gt events.</div><p>In this topic:</p><ul><li> <a href="#before_you_begin">Before You Begin</a></li><li> <a href="#limitations">Limitations</a></li><li> <a href="#review_git_webhook_triggers">Review: Git Webhook Triggers</a></li><li> <a href="#step_1_add_a_trigger">Step 1: Add a Trigger</a></li><li> <a href="#step_2_select_repo_and_event_type">Step 2: Select Repo and Event Type</a></li><li> <a href="#review_payload_and_event_type_matrix">Review: Payload and Event Type Matrix</a></li><li><a href="https://docs.harness.io/article/ys3cvwm5gc-trigger-a-deployment-on-git-event#option_authenticate_the_webhook">Option: Authenticate the Webhook</a></li><li> <a href="#step_3_select_the_workflow_or_pipeline_to_deploy">Step 3: Select the Workflow or Pipeline to Deploy</a></li><li> <a href="#step_4_provide_values_for_workflow_variables">Step 4: Provide Values for Workflow Variables</a></li><li> <a href="#option_manual_triggers">Option: Manual Triggers</a></li><li><a href="https://docs.harness.io/article/ys3cvwm5gc-trigger-a-deployment-on-git-event#step_5_set_up_the_github_webhook">Step 5: Set Up the Github Webhook</a></li><li> <a href="#configure_as_code">Configure As Code</a></li><li> <a href="#related_topics">Related Topics</a></li></ul><h3>Before You Begin</h3><ul><li> <a href="https://docs.harness.io/article/wqytbv2bfd-ci-cd-with-the-build-workflow">Build Workflows</a></li><li> <a href="/article/0tphhkfqx8-artifact-build-and-deploy-pipelines-overview">Build and Deploy Pipeline</a></li><li> <a href="/article/eb3kfl8uls-service-configuration">Add a Service</a></li><li> <a href="/article/m220i1tnia-workflow-configuration">Workflows</a></li><li> <a href="/article/n39w05njjv-environment-configuration">Add Environment</a></li><li> <a href="/article/zc1u96u6uj-pipeline-configuration">Create a Pipeline</a></li></ul><p></p><h3>Limitations</h3><ul><li>In the <strong>Actions</strong> section of the Trigger, the <strong>Deploy only if files have changed</strong> option is available for Workflows deploying Kubernetes or Native Helm Services only.</li><li>Data retention for Webhook event details is 3 days. <br/>To see the event details, in the response of a Webhook request the <code>data</code> field contains the Id of the registered WebHook event. You can use the following API and the <code>eventId</code> to get the details of the WebHook Event:<pre>curl -i -X GET \<br/>  &#39;https://app.harness.io/gateway/pipeline/api/webhook/triggerProcessingDetails?accountIdentifier=&lt;account Id&gt;&amp;eventId=&lt;data Id&gt;&#39; \<br/>  -H &#39;x-api-key: &lt;Harness API key&gt;&#39;</pre></li></ul><h3>Review: Git Webhook Triggers</h3><p>You can create Harness Triggers that respond to certain Git events, and then add the Harness Trigger Git Webhook to your repo. When the specified event happens in your repo, the Harness Trigger is run.</p><p>Let&#39;s review Git Webhooks.</p><div class="note-callout">For GitHub, GitLab, and Bitbucket, this option is used to execute a Build Workflow or a Build Pipeline only.</div><p>GitHub, GitLab, and Bitbucket Webhook-based Triggers are not intended for Workflows and Pipelines that <strong>deploy</strong> artifacts. They are designed for Build Workflows and Pipelines that build artifacts in response to Gt events.</p><div class="note-callout">For Custom Git providers, you can trigger any type of Workflow using a Harness On Webhook Event Trigger.</div><p>Git Webhooks allow you to build or set up apps which subscribe to certain events in your git repo on github.com, bitbucket.org, and gitlab.com.</p><p>Each event corresponds to a certain set of actions that can happen to your organization and/or repository.</p><p>When one of those events is triggered, Git sends a HTTP POST payload to the Webhook&#39;s configured URL.</p><p>You can use a Harness Trigger <strong>GitHub/Bitbucket/Gitlab Webhook</strong> URL and execute a Harness deployment in response to a Git event.</p><p>The most common example: A Git event that merges code initiates the Trigger for a Harness Build and Deploy Pipeline.</p><p>The first stage of the Pipeline is a Build Workflow that builds and collects the artifact from the Artifact Source (which is linked to the Git repo). The final stage deploys the newly built artifact from the artifact source.</p><div class="note-callout">For details on the payloads of the different repo Webhooks, see GitHub <a href="https://developer.github.com/v3/activity/events/types/" target="_blank">Event Types &amp; Payloads</a>, Bitbucket <a href="https://confluence.atlassian.com/bitbucket/event-payloads-740262817.html" target="_blank">Event Payloads</a>, and Gitlab <a href="https://docs.gitlab.com/ee/user/project/integrations/webhooks.html#events" target="_blank">Events</a>.</div><p></p><h3>Step 1: Add a Trigger</h3><p>Typically, Triggers are set up after you have successfully deployed and tested a Workflow or Pipeline.</p><p>To add a trigger, do the following:</p><ol><li>Ensure that you have a Harness Service, Environment, and Workflow set up. If you want to Trigger a Pipeline, you&#39;ll need one set up also.</li><li>In your Harness Application, click <strong>Triggers</strong>.</li><li>Click <strong>Add Trigger</strong>. The <strong>Trigger</strong> settings appear.</li><li>In <strong>Name</strong>, enter a name for the Trigger. This name will appear in the <strong>Deployments</strong> page to indicate the Trigger that initiated a deployment.</li><li>Click <strong>Next</strong>.</li></ol><h3>Step 2: Select Repo and Event Type</h3><p>A Git event that merges code initiates the Trigger for the Build and Deploy Pipeline.</p><p>The first stage of the Pipeline is a Build Workflow that builds and collects the artifact from the Artifact Source (which is linked to the Git repo).</p><p>In the Actions section, you select the Git repo provider and the event type you want to run the Trigger.</p><ol><li>In <strong>Condition</strong>, select <strong>On Webhook Event</strong>.</li><li>In <strong>Payload Type</strong>, select the repository type (GitHub, Bitbucket, GitLab).</li><li>In <strong>Event Type</strong>, select the event type for the Webhook event.<br/>There are different options depending on the repo selected in <strong>Payload Type</strong>. See <a href="#review_payload_and_event_type_matrix">Review: Payload and Event Type Matrix</a> below.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ys3cvwm5gc/1600120360152/image.png"/></figure></li></ol><p>If you are using a repo other than GitHub, Bitbucket, or Gitlab (such as Jenkins or Bamboo), leave the <strong>Payload Type</strong> menu blank.</p><p>Harness will still generate a Webhook that you can use in your repo.</p><h3>Review: Payload and Event Type Matrix</h3><p>The following table displays the payload and event types supported when you select the <strong>On Webhook Event</strong> option in a Trigger&#39;s <strong>Condition</strong> setting.</p><div class="note-callout">This option is used to execute a  <a href="https://docs.harness.io/article/wqytbv2bfd-ci-cd-with-the-build-workflow">Build Workflow</a> or a  <a href="https://docs.harness.io/article/181zspq0b6-build-and-deploy-pipelines-overview">Build Pipeline</a> only.</div><p>For details on each event type and its actions, please consult the provider&#39;s documentation.</p><p></p><div class="hd--html"><table class="table table-responsive" border="0" bordercolor="#eee">
  <tbody>
    <tr>
      <td width="50%">
        <p><strong>Payload Type</strong></p>
      </td>
      <td>
        <p><strong>Event Type</strong></p>
      </td>
    </tr>
    <tr>
      <td>
        <p>BitBucket</p>
      </td>
      <td>
        <p>On Pull Request</p>
        <p>On Repository</p>
        <p>On Issue</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>GitHub</p>
      </td>
      <td>
        <p>On Pull Request</p>
        <p>On Push</p>
        <p>On Delete</p>
        <p>On Release</p>
        <p>On Package</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>GitLab</p>
      </td>
      <td>
        <p>On Pull Request</p>
        <p>On Push</p>
      </td>
    </tr>
    <tr>
      <td>
        <p>Custom or no selection.</p>
        <p>This option is for repos other than the default Git providers.</p>
        <p>For example, Bamboo or Jenkins.</p>
      </td>
      <td>
        <p>On Pull Request</p>
        <p>On Push</p>
      </td>
    </tr>
  </tbody>
</table></div><p></p><p></p><h3>Option: Authenticate the Webhook</h3><div class="note-callout">Currently, this feature is behind a Feature Flag. Contact <a href="mailto:support@harness.io" target="_blank">Harness Support</a> to enable the feature. Feature Flags can only be removed for Harness Professional and Essentials editions. Once the feature is released to a general audience, it&#39;s available for Trial and Community Editions.<br/><br/>See <a href="https://changelog.harness.io/?categories=fix,improvement,new" target="_blank">New features added to Harness</a> and <a href="https://changelog.harness.io/?categories=early-access" target="_blank">Features behind Feature Flags</a> (Early Access) for Feature Flag information.</div><p>Your Git provider includes secret tokens that enable you to validate requests.</p><p>You can use a Harness secret in your Webhook secret setting. When the Git provider sends a POST request to the Harness URL in the Webhook, Harness will use the secret to validate the request.</p><p>In <strong>Select Encrypted Webhook Secret</strong>, create or select a Harness secret. See <a href="/article/ygyvp998mu-use-encrypted-text-secrets">Use Encrypted Text Secrets</a>.</p><p>Later, when you set up the Webhook for this Trigger in your Git provider, enter the <u>value</u> of the Harness secret in the Webhook secret&#39;s settings. <u>Do not enter the secret name.</u></p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ys3cvwm5gc/1625595697846/clean-shot-2021-07-06-at-11-20-36.png"/></figure><p>If the secret value in the Webhook does not match the secret value in the Trigger, you will get a 400 response in your Git provider:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ys3cvwm5gc/1621036120583/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>For more information on Webhook secrets, see the following Git provider docs:</p><ul><li><a href="https://developer.github.com/webhooks/securing/" target="_blank">GitHub</a></li><li><a href="https://docs.gitlab.com/ee/user/project/integrations/webhooks.html" target="_blank">GitLab</a></li><li><a href="https://confluence.atlassian.com/bitbucketserver/managing-webhooks-in-bitbucket-server-938025878.html" target="_blank">Bitbucket</a></li></ul><p>For details on using the Harness API to set up Trigger authentication, see <a href="/article/u21rkuzfod-use-trigger-apis">Use Trigger APIs</a>.</p><h4>Authentication and Delegate Scoping</h4><p>When Harness authenticates the Trigger, the Harness Delegate you have installed in your environment connects to the Secrets Manager you have set up in Harness.</p><p>If you have scoped the Delegate in anyway (such as to specific Applications), it might be too limited to retrieve the secret.</p><p>Either remove the limitation (remove all scopes) or map the <strong>Key Management Service</strong> task to the Delegate. See <a href="/article/nzuhppobyg-map-tasks-to-delegates-and-profiles">Delegate Task Category Mapping</a>.</p><div class="note-callout">The <strong>Task Category Map</strong> feature replaces the <strong>Command</strong> setting in Delegate Scopes, which is deprecated and will be removed soon.</div><h3>Step 3: Select the Workflow or Pipeline to Deploy</h3><p>For GitHub, GitLab, and Bitbucket, you can trigger <a href="https://docs.harness.io/article/wqytbv2bfd-ci-cd-with-the-build-workflow">Build Workflows</a> or a <a href="https://docs.harness.io/article/0tphhkfqx8-artifact-build-and-deploy-pipelines-overview">Build and Deploy Pipeline</a> in response to a Git event using Webhooks using a Harness On Webhook Event Trigger.</p><p>For Custom Git providers, you can trigger any type of Workflow using a Harness  Trigger.</p><ol><li>In <strong>Execution Type</strong>, select <strong>Workflow</strong> or <strong>Pipeline</strong>.</li><li>In <strong>Execute Workflow</strong>/<strong>Pipeline</strong>, select the Workflow or Pipeline to deploy.</li></ol><h3>Step 4: Provide Values for Workflow Variables</h3><p>If the Workflow or Pipeline you selected to deploy uses Workflow variables, you will need to provide values for these variables.</p><p>You can also use variable expressions for these values. See <a href="/article/revc37vl0f-passing-variable-into-workflows">Passing Variables into Workflows from Triggers</a>.</p><h3>Option: Manual Triggers</h3><p>You can manually deploy a Harness Workflow or Pipeline using a Manual Trigger. You can run a Trigger manually in the following ways:</p><ul><li>Using a URL provided by Harness.</li><li>Using a curl command.</li><li>Use a REST call to get deployment status.</li></ul><p>See the following:</p><ul><li> <a href="/article/uccck6kq5m-get-deployment-status-using-rest">Get Deployment Status using REST</a></li><li> <a href="/article/mc2lxsas4c-trigger-a-deployment-using-c-url">Trigger a Deployment using cURL</a></li></ul><p></p><h3>Step 5: Set Up the Github Webhook</h3><p>Once your On Webhook Event Trigger is completed, the next step is to integrate it into your Git repo so that the Trigger is executed in response to the Git event.</p><ol><li>In your Harness application, click <strong>Triggers</strong>.</li><li>In the bottom of each listed Trigger is a link for <strong>GitHub Webhook</strong>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/xerirloz9a/1534984103440/image.png"/></figure></li><li>For the Trigger you want to use, click <strong>GitHub Webhook</strong>. The Trigger dialog appears.</li><li>Copy the Webhook and use it in GitHub to trigger the deployment.</li><li>Add the webhook to your Git repo.<br/>In GitHub and the other Git repos, when configuring the Webhook, you can choose which events you would like to receive payloads for. You can even opt-in to all current and future events.</li><li>In Content type, ensure you select <strong>application/json</strong>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ys3cvwm5gc/1605639440101/image.png"/></figure></li></ol><div class="note-callout">When you set up the Webhook in GitHub, modify the <strong>Content type</strong> to <strong>application/json</strong>. In <strong>Which events would you like to trigger this webhook?</strong>, you can select <strong>Push events</strong> and/or <strong>Pull requests</strong>.</div><p></p><table><tbody><tr><td><p><strong>Just the Push Event</strong></p></td><td><p><strong>Pushes and Pull Requests</strong></p></td></tr><tr><td><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/xerirloz9a/1544203764020/image.png"/></figure></td><td><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/xerirloz9a/1544203630104/image.png"/></figure></td></tr></tbody></table><p></p><div class="note-callout">Harness will examine any incoming payload to ensure that it meets the <strong>Action</strong> you set. You do not need to use the repo&#39;s Webhook event settings to match the <strong>Action</strong>. Simply use the Harness Webhook URL in the repo Webhook URL field.</div><p></p><h3>Configure As Code</h3><p>To see how to configure the settings in this topic using YAML, configure the settings in the UI first, and then click the YAML editor button (<span style="color:#fb9e00" data-hd-color="#fb9e00"><strong>&lt;/&gt;</strong></span>).</p><h3>Related Topics</h3><ul><li> <a href="/article/u21rkuzfod-use-trigger-apis">Use Trigger APIs</a></li><li> <a href="/article/revc37vl0f-passing-variable-into-workflows">Passing Variables into Workflows from Triggers</a></li><li> For information on using Triggers as part of Harness GitOps, see <a href="/article/khbt0yhctx-harness-git-ops">Harness GitOps</a>.</li><li> <a href="/article/s2m2ksxn6a-trigger-a-deployment-on-new-artifact">Trigger Deployments When a New Artifact is Added to a Repo</a></li><li> <a href="/article/tb66fmh4iz-trigger-a-deployment-on-a-time-schedule">Schedule Deployments using Triggers</a></li><li> <a href="/article/nihs2y2z61-trigger-a-deployment-on-pipeline-completion">Trigger Deployments when Pipelines Complete</a></li><li> <a href="/article/mc2lxsas4c-trigger-a-deployment-using-c-url">Trigger a Deployment using cURL</a></li><li> <a href="/article/zr4tgwrzlb-trigger-a-deployment-when-a-file-changes">Trigger a Deployment when a File Changes</a></li><li> <a href="/article/uccck6kq5m-get-deployment-status-using-rest">Get Deployment Status using REST</a></li><li> <a href="/article/6vlut5qvlf-freeze-triggers">Pause All Triggers using Deployment Freeze</a></li></ul><p></p>