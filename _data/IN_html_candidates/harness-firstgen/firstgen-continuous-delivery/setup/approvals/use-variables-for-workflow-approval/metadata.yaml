type: article
article_id: 5pspec1apl
user_id: slcpusem6b
category_id: 4edbfn50l8
author:
  name: Archana Singh
  profile_image: https://www.gravatar.com/avatar/e323facc5a711ac44c46e58dcb52aa3e?d=mm&s=150
title: Using Variables in Workflow Approvals
slug: use-variables-for-workflow-approval
description: Describes how to use variables in a Workflow approval step.
short_version: Describes how to use variables in a Workflow approval step.
tags:
- Workflow Approval
- approval
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2021-11-03T17:06:54.440596Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Using Variables in Workflow Approvals
  description: Describes how to use variables in a Workflow approval step.
  short_version: Describes how to use variables in a Workflow approval step.
  body: '<p>You can add predefined or user-defined variables in a Workflow Approval
    step. When the Workflow is deployed, these variables become available as inputs
    for logging and auditing and can be overwritten by approvers.</p><p>The available
    approval mechanisms are:</p><ul><li> <a href="/article/qxki6o7y31-jira-based-approvals">Jira
    Approvals</a></li><li> <a href="/article/9nkuhm8moo-service-now-ticketing-system">ServiceNow
    Approvals</a></li><li> <a href="/article/0ajz35u2hy-approvals">Harness UI Approvals</a></li><li>
    <a href="/article/lf79ixw2ge-shell-script-ticketing-system">Custom Shell Script
    Approvals</a></li></ul><p>In this topic:</p><ul><li> <a href="#before_you_begin">Before
    You Begin</a></li><li> <a href="#step_1_add_an_approval_step_in_a_workflow">Step
    1: Add an Approval Step in a Workflow</a></li><li> <a href="#step_2_approve_workflows">Step
    2: Approve Workflows</a></li><li> <a href="#option_use_approval_variables_in_other_workflow_steps">Option:
    Use Approval Variables in Other Workflow Steps</a></li><li> <a href="#see_also">See
    Also</a></li></ul><h3>Before You Begin</h3><ul><li> <a href="/article/m220i1tnia-workflow-configuration">Workflows</a></li><li>
    <a href="/article/zc1u96u6uj-pipeline-configuration">Pipelines</a></li><li> <a
    href="/article/60j7391eyy-templatize-pipelines">Create Pipeline Templates</a></li></ul><h3>Step
    1: Add an Approval Step in a Workflow</h3><ol><li>In your Workflow, click <strong>Add
    Step</strong>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/qfv84bqk0p/1588928768167/image.png"
    style="max-height:25%;max-width:25%" data-hd-height="25%" data-hd-width="25%"/></figure></li><li>Select
    <strong>Approval</strong>. You can search or click <strong>Flow Control</strong>
    and select <strong>Approval</strong>.</li><li>Click <strong>Next</strong>.<br/>The
    Add Step settings appear.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/qfv84bqk0p/1588929510709/screenshot-2020-05-08-at-2-45-33-pm.png"
    style="max-height:60%;max-width:60%" data-hd-height="60%" data-hd-width="60%"/></figure></li><li>In
    <strong>Configure Approval</strong>, enter <strong>Name</strong>.</li><li>Select
    <strong>Harness UI</strong> in the <strong>Ticketing System</strong>.<div class="note-callout">You
    can use <strong>Jira Service Desk</strong>, <strong>ServiceNow</strong>, and <strong>Custom
    Shell Script</strong> based approvals as well. For more information on how to
    add these approvals, see <a href="/article/qxki6o7y31-jira-based-approvals">Jira
    Approvals</a>, <a href="/article/9nkuhm8moo-service-now-ticketing-system">ServiceNow
    Approvals</a>, and <a href="/article/lf79ixw2ge-shell-script-ticketing-system">Custom
    Shell Script Approvals</a>.</div></li><li>Select one or more <strong>User Group(s)</strong> to
    notify for the approval requests.</li><li>Enter the time duration that Harness
    should wait for the approval or rejection before killing the deployment process.
    You can use <code><strong>w</strong></code>  for week, <code><strong>d</strong></code>  for
    day, <code><strong>h</strong></code>  for hour, <code><strong>m</strong></code>  for
    minutes, <code><strong>s</strong></code>  for seconds and <code><strong>ms</strong></code> for
    milliseconds. For example, 1d for one day.</li><li>Click <strong>Advanced Settings</strong>
    to set the additional settings.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/qfv84bqk0p/1588930433006/screenshot-2020-05-08-at-3-03-34-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click
    <strong>Add Variable</strong> to define variables. To define a new variable, enter
    a <strong>Name</strong> and a <strong>Default Value</strong>. You can use this
    variable combined with its parent variable name to reference the variable elsewhere.</li><li>In <strong>Publish
    Variable Name</strong>, enter a parent name for the collection of subordinate
    variables that you can reference with its child variables (as you defined in the
    previous step). This parent name helps to avoid conflicts when there are subordinate
    variables of the same name within the same scope.</li><li>Set the <strong>Scope</strong>
    for the variables that you defined in the previous step. You can choose, <strong>Phase</strong>,
    <strong>Workflow</strong>, or <strong>Pipeline</strong>.</li><li>Click <strong>Submit</strong> to
    save this Approval step, along with its variables.</li></ol><h3>Step 2: Approve
    Workflows</h3><p>Workflow uses the Approval variables as defined in the <strong>Add
    an Approval Step in a Workflow</strong> option, when it deploys. Deployment pauses
    at the Approval step.</p><p></p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/070lpwdosa/1574325037521/image.png"
    style="max-height:35%;max-width:35%" data-hd-height="35%" data-hd-width="35%"/></figure><ol><li>Click
    <strong>Approval</strong> step.<br/>A user (in one of the User Groups configured
    as approvers) can click the Approval step. The <strong>Needs Approval</strong>
    settings appear.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/070lpwdosa/1574325986794/image.png"
    style="max-height:70%;max-width:70%" data-hd-height="70%" data-hd-width="70%"/></figure></li><li>Enter
    your comments, and click <strong>Approve.</strong></li></ol><p>Once this step
    is approved, the Workflow can continue deployment.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/070lpwdosa/1574326518201/image.png"
    style="max-height:80%;max-width:80%" data-hd-height="80%" data-hd-width="80%"/></figure><h3>Option:
    Use Approval Variables in Other Workflow Steps</h3><p>Approval variables can be
    defined only within Workflow Approval steps, but they can be referenced in other
    Workflow steps, such as the <a href="/article/1fjrjbau7x-capture-shell-script-step-output">Shell
    Script</a> step.</p><p>For all of the following examples, <code>published_name</code>
    refers to the name you entered in the <strong>Publish Variable Name</strong> setting
    in the Approval step.</p><p><code>${published_name.variables.var_name}</code></p><ul><li>Use
    the <code>.variables.</code> prefix when referring to an <strong>Additional Input
    Variable</strong> that was defined in a Workflow Approval step.</li></ul><p><code>${approvedBy.name}</code> —
    (Deprecated)</p><ul><li>The name of the Harness user that approved a Workflow
    approval step.</li></ul><p><code>${approvedBy.email}</code> — (Deprecated)</p><ul><li>The
    email address of the Harness user that approved a Workflow approval step.</li></ul><p><code>${published_name.approvedBy.name}</code></p><ul><li>The
    name of the Harness user that approved a Workflow approval step.</li><li>As of
    December, 2019, this—and the other Approval variables below—must be preceded by
    a published output variable name (<code>published_name</code>).</li></ul><p><code>${published_name.approvedBy.email}</code></p><ul><li>The
    email address of the Harness user that approved a Workflow approval step.</li></ul><p><code>${published_name.approvedOn}</code></p><ul><li>The
    epoch time at which a Workflow approval step was approved.</li></ul><p><code>${published_name.comments}</code></p><ul><li>Free-text
    comments that a user entered when approving (or rejecting) a Workflow approval
    step.</li></ul><p><code>${published_name.timeoutMillis}</code></p><ul><li>Timeout
    (in milliseconds) set for this approval step.</li></ul><p><code>${published_name.approvalStateType}</code></p><ul><li>The
    ticketing system used for this approval: USER_GROUP, JIRA, SERVICENOW, and SHELL_SCRIPT.</li></ul><p><code>${published_name.approvalStatus}</code></p><ul><li>The
    approval&#39;s outcome. Can take the values SUCCESS or REJECTED.</li></ul><p><code>${published_name.userGroups[&lt;index&gt;].name}</code></p><ul><li>An
    array of User Groups that were added in a Workflow&#39;s approval step.</li><li>For
    example, if two User Groups were added, you can access those groups&#39; names
    as <code>${published_name.userGroups[0].name}</code> and <code>${published_name.userGroups[1].name}</code>.</li></ul><h3>See
    Also</h3><ul><li> <a href="/article/gkmgrz9shh-how-to-pass-variables-between-workflows">Pass
    Variables between Workflows</a></li><li> <a href="/article/revc37vl0f-passing-variable-into-workflows">Passing
    Variables into Workflows and Pipelines from Triggers</a></li></ul><p></p><p></p>'
  slug: use-variables-for-workflow-approval
  tags:
  - Workflow Approval
  - approval
  is_live: true
