<p></p><div class="note-callout">Currently, this feature is behind the Feature Flag <code>CF_CUSTOM_EXTRACTION</code>. Contact <a href="mailto:support@harness.io" target="_blank">Harness Support</a> to enable the feature. </div><p>Harness supports the most common Tanzu Application Services (formerly PCF) artifact package types.</p><p>If your artifact doesn&#39;t match the supported types, you can run a script to preprocess the artifact (unzip, untar, etc). Preprocessing occurs when setting up the app during deployment.</p><p>In this topic:</p><ul><li> <a href="#before_you_begin">Before You Begin</a></li><li> <a href="#limitations">Limitations</a></li><li> <a href="#review_supported_artifact_types">Review: Supported Artifact Types</a></li><li> <a href="#step_1_select_preprocessing_in_app_setup_step">Step 1: Select Preprocessing in App Setup Step</a></li><li> <a href="#step_2_add_preprocessing_script">Step 2: Add Preprocessing Script</a></li><li> <a href="#step_3_view_the_preprocessing_in_the_deployment_logs">Step 3: View the Preprocessing in the Deployment Logs</a></li><li> <a href="#see_also">See Also</a></li></ul><p></p><h3>Before You Begin</h3><ul><li><a href="/article/jxsna1a0mi-add-container-images-for-pcf-deployments">Add Container Images for Tanzu Deployments</a></li><li><a href="/article/c92izkztka-create-a-basic-pcf-deployment">Create a Basic Tanzu Deployment</a></li><li> <a href="/article/hy819vmsux-pivotal-cloud-foundry-quickstart">Pivotal Cloud Foundry Quickstart</a></li></ul><h3>Limitations</h3><ul><li>Preprocessing is for non-Docker artifacts.</li></ul><h3>Review: Supported Artifact Types</h3><p>Harness supports the following TAS artifact servers/types.</p><p>Metadata-only Sources:</p><ul><li>Jenkins</li><li>AWS (Amazon Web Services) S3</li><li>Artifactory (includes Docker)</li><li>Nexus</li><li>Bamboo</li></ul><p>File-based Sources:</p><ul><li>Docker Registry</li><li>Artifactory (Tgz files)</li><li>Nexus (Tgz files)</li><li>Google Container Service (GCS)</li><li>AWS Elastic Container Registry (ECR)</li><li>SMB</li><li>SFTP</li><li>Custom Repository</li></ul><div class="note-callout">Harness supports any single file (non-folder) deployed usingÂ <code>cf push</code>. TAR, WAR, JAR, ZIP, and Docker are supported.</div><h3>Step 1: Select Preprocessing in App Setup Step</h3><p>This step assumes you&#39;ve created a TAS Workflow before. If not, see:</p><ul><li><a href="/article/c92izkztka">Create a Basic Tanzu Deployment</a></li><li><a href="/article/99bxiqfi1u">Create a Canary Tanzu Deployment</a></li><li><a href="/article/52muxcsr1v">Create a Blue/Green Tanzu Deployment</a></li></ul><p>Open the <strong>App Setup</strong> step in the Workflow.</p><p>Select <strong>Pre-Process Package for TAS Deployment</strong>. The script option appears.</p><h3>Step 2: Add Preprocessing Script</h3><p>Enter a script to perform preprocessing on the downloaded artifact before deployment.</p><p>Reference the downloaded artifact using the expression <code>${downloadedArtifact}</code>.</p><p>For example:</p><pre>tar -xvf ${downloadedArtifact}</pre><p>Copy the processed artifact to a directory using <code>${processedArtifactDir}</code>.</p><p>For example:</p><pre>cp myfolder/helloworld.war ${processedArtifactDir}</pre><p>The entire preprocessing script might look like this:</p><pre>tar -xvf ${downloadedArtifact}<br/><br/>cp myfolder/helloworld.war ${processedArtifactDir}</pre><p>Let&#39;s look at another example:</p><p>Let&#39;s say you have a zip archive that contains a folder named <strong>myArtifact</strong>. Inside the myArtifact folder is an artifact named <strong>myArtifact.war</strong>.</p><p>You unzip the archive:</p><pre>unzip ${downloadedArtifact}</pre><p>Once you unzip the archive the result is <strong>myArtifact/myArtifact.war</strong>.</p><p>Next, you need to copy myArtifact.war to a directory. The directory is identified using the expression <code>${processedArtifactDir}</code>.</p><p>For example:</p><pre>cp myArtifact/myArtifact.war ${processedArtifactDir}</pre><h3>Step 3: View the Preprocessing in the Deployment Logs</h3><p>When you deploy the Workflow the preprocessing is shown in the logs for the <strong>App Setup</strong> step.</p><p>Here&#39;s an example:</p><pre># Executing artifact processing script: <br/>._package2<br/>package2/<br/>package2/._index.js<br/>package2/index.js<br/>package2/._package.json<br/>package2/package.json<br/>SUCCESS</pre><p></p><h3>See Also</h3><ul><li><a href="/article/jxsna1a0mi">Add Container Images for Tanzu Deployments</a></li></ul><p></p>