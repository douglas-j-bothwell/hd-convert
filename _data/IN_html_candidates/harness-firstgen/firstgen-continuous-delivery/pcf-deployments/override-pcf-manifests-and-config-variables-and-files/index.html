<p>A Tanzu Application Service (formerly PCF) Service and Environment are used together when you set up a Harness Workflow to deploy your TAS app. You can configure your Environment to override settings of the Harness TAS Services that use the Environment, thereby making the Environment dictate TAS manifest values.</p><p>For example, a TAS Service uses a manifest.yml file that specifies specific routes, but an Environment might need to change the routes because it is deploying the app in the manifest to a QA space.</p><p>In this topic:</p><ul><li><a href="https://docs.harness.io/article/r0vp331jnq-override-pcf-manifests-and-config-variables-and-files#before_you_begin">Before You Begin</a></li><li><a href="https://docs.harness.io/article/r0vp331jnq-override-pcf-manifests-and-config-variables-and-files#option_1_variable_override">Option 1: Variable Override</a></li><li><a href="https://docs.harness.io/article/r0vp331jnq-override-pcf-manifests-and-config-variables-and-files#option_2_tas_manifests_override">Option 2: TAS Manifests Override</a><ul><li><a href="https://docs.harness.io/article/r0vp331jnq-override-pcf-manifests-and-config-variables-and-files#overwrite_using_local_values">Overwrite using Local Values</a></li><li><a href="https://docs.harness.io/article/r0vp331jnq-override-pcf-manifests-and-config-variables-and-files#overwrite_using_remote_values">Overwrite using Remote Values</a></li></ul></li><li><a href="https://docs.harness.io/article/r0vp331jnq-override-pcf-manifests-and-config-variables-and-files#review_multiple_manifests_at_the_highest_level_will_fail_deployment">Review: Multiple Manifests at the Highest Level will Fail Deployment</a></li><li><a href="https://docs.harness.io/article/r0vp331jnq-override-pcf-manifests-and-config-variables-and-files#review_variable_precedence">Review: Variable Precedence</a></li><li><a href="https://docs.harness.io/article/r0vp331jnq-override-pcf-manifests-and-config-variables-and-files#next_steps">Next Steps</a></li></ul><h3>Before You Begin</h3><ul><li>See <a href="/article/nh4afrhvkl">Connect to Your Target Tanzu Account</a>.</li><li>See <a href="/article/r1crlrpjk4">Define Your Tanzu Target Infrastructure</a>.</li></ul><p></p><h3>Option 1: Variable Override</h3><p>You can overwrite Service variables when one or more Services are paired with this Environment in a Workflow.</p><p>To overwrite a Service variable, do the following:</p><ol><li>In the Harness Service, note the name of the Service variable in <strong>Config Variables</strong>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1572379253111/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>In the Harness Environment, click <strong>Service Configuration Override</strong>. The <strong>Service Configuration Override</strong> dialog appears.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1572379343787/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>In <strong>Service</strong>, select the Harness Service that contains the variable you want to overwrite. If you select <strong>All Services</strong>, you will have to manually enter the name of the variable you want to overwrite. The following steps use a single Service.<br/><br/>When you have selected a Service, the <strong>Override Type</strong> options appear.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1572379524688/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click <strong>Variable Override</strong>.</li><li>In <strong>Configuration Variable</strong>, select the variable you want to overwrite.</li><li>In <strong>Override Scope</strong>, the only option is <strong>Entire Environment</strong>, currently.</li><li>In <strong>Type</strong>, select <strong>Text</strong> or <strong>Encrypted Text</strong>.</li><li>In <strong>Override Value</strong>, if you selected <strong>Text</strong> in <strong>Type</strong>, enter a new value. If you selected <strong>Encrypted Text</strong>, select an existing Encrypted Text secret. Encrypted Text secrets are set up in Harness <a href="/article/au38zpufhr-secret-management">Secrets Management</a>.<br/><br/>When you are done, the dialog will look something like this:<figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1572379758528/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click <strong>Submit</strong>. The override is added to the Environment:</li></ol><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1572379817081/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><h3>Option 2: TAS Manifests Override</h3><p>The most commonly-used override is for TAS manifests. You can override the entire manifest.yml of a Service or any of its values.</p><div class="note-callout">To overwrite any property in an inline or remote manifest, the manifest.yml must use vars.yml for the property value.</div><p>For example, if you hardcode <code>route: example.com</code> in your inline or remote manifest.yml, you cannot overwrite it in <strong>Service Configuration Overrides</strong>. You must use a variable like <code>route: ((ROUTE1))</code> in manifest.yml and then provide a value for the variable like <code>ROUTE1: example.com</code> in vars.yml.</p><p>For example, here are inline manifest.yml and vars.yml files using variables for routes. These variables are then overwritten in <strong>Service Configuration Overrides</strong>:</p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1572382200912/image.png"/></figure><p>You can only perform one overwrite of a single Service. If you attempt to add a second overwrite of the same Service, you will receive this error: <code>Can’t add, this override already exists. Please use the edit button to update.</code></p><p>To overwrite a TAS manifest, do the following:</p><ol><li>In the Harness Service, note the name(s) of the Service vars.yml property in <strong>Manifests</strong> that you want to overwrite. If you are using remote manifest files, go to your remote repro and note the name(s).</li><li>In the Harness Environment, click <strong>Service Configuration Override</strong>. The <strong>Service Configuration Override</strong> dialog appears.</li><li>In <strong>Service</strong>, select the Harness Service that contains the variable you want to overwrite. If you select <strong>All Services</strong>, you will have to manually enter the name of the variable you want to overwrite. The following steps use a single Service.<br/>The <strong>Override Type</strong> options appear.</li><li>Click <strong>TAS Manifests</strong>.</li><li>Click <strong>Local</strong> or <strong>Remote</strong>. The steps for each option are below.</li></ol><h4>Overwrite using Local Values</h4><p>You can overwrite values in the vars.yml configured in your Service. It does not matter if the vars.yml in your Service is inline and remote.</p><p>To overwrite the variable values configured in your Harness Service, you can simply enter the vars.yml variables you want to overwrite, and enter new values. Here is an example overwriting routes in an inline vars.yml:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1572384638429/image.png"/></figure><h4>Overwrite using Remote Values</h4><p>Typically, a single manifest.yml is used in a Service and then remote vars.yml files are used to supply different variable values.</p><p>To overwrite manifest property values using remote files, you simply point to a remote Git folder that contains the manifest.yml or vars.yml files containing the new values.</p><p>For example, here is a Service with an inline manifest.yml and vars.yml, and it uses the remote Git repo folder <strong>pcf-dev/vars.yml</strong> file to overwrite the vars.yml values:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/r0vp331jnq/1646948202997/clean-shot-2022-03-10-at-13-36-27.png"/></figure><p>The remote vars.yml file does not need to supply all of the variables for the vars.yml file it is overwriting. You can simply overwrite the variables you want.</p><p>As you can see in the above example, the remote vars.yml file only overwrites the <strong>routes</strong> in the inline vars.yml file.</p><h5>File Path</h5><p>If the manifest you select is incorrect due to missing attributes or special characters, deployment will continue and Harness will use the next manifest available at Service level.</p><p>If the manifest you select is incorrect due to missing attributes or special characters, <u>deployment will fail</u>.</p><h3>Review: Multiple Manifests at the Highest Level will Fail Deployment</h3><div class="note-callout">Currently, this feature is behind the feature flag <code>SINGLE_MANIFEST_SUPPORT</code>. Contact <a href="mailto:support@harness.io" target="_blank">Harness Support</a> to enable the feature.</div><p>Manifests can defined at the following levels, from highest to lowest priority:</p><ol><li><strong>Environment level for a specific Service:</strong> defined at Environment level with its scope set to a <u>specific</u> Service.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/r0vp331jnq/1647625761468/clean-shot-2022-03-18-at-10-49-09.png"/></figure></li><li><strong>Environment level for All Services:</strong> defined at Environment level with its scope set to All Services.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/r0vp331jnq/1647625792288/clean-shot-2022-03-18-at-10-49-39.png"/></figure></li><li><strong>Service level manifest:</strong> the app manifest set up in the Harness Service.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/r0vp331jnq/1647884806327/clean-shot-2022-03-21-at-10-46-28.png"/></figure>See:<ul><li><a href="https://docs.harness.io/article/3ekpbmpr4e">Adding and Editing Inline Tanzu Manifest Files</a></li><li><a href="https://docs.harness.io/article/i5jxqsbkt7-upload-local-and-remote-pcf-resource-files">Upload Local and Remote Tanzu Resource Files</a></li></ul></li></ol><p>Whenever manifests are present at multiple levels, the manifest present at the level having <strong>highest priority</strong> is set as the final manifest.</p><p>For example, if you have a manifest override defined at Environment level with its scope set to a <u>specific</u> Service, it is the final manifest. No other manifests in the Environment or Service will be used.</p><p>If there are <u>multiple</u> manifests at the level used by Harness (the highest level with a manifest set), Harness will fail deployment.</p><p>Harness performs this check for <strong>Application Manifest</strong> and <strong>Autoscalar Manifest</strong>. It does not apply to <strong>Variable Manifests</strong>.</p><h3>Review: Variable Precedence</h3><p>If multiple variables of the same name are defined in different places, such as a Service&#39;s <strong>Manifests</strong> or <strong>Config Variables</strong> sections or an Environment&#39;s <strong>Service Configuration Overrides</strong> section, the variables get overwritten according to the following precedence, from highest to lowest:</p><ol><li><strong>Service Configuration Overrides</strong> variables for a specific Service are of the greatest precedence, and override all others.</li><li><strong>Service Configuration Overrides</strong> variables for all Services.</li><li>Variables in a Service <strong>Config Variables</strong> section.</li><li>Variables defined in inline or remote files in Service <strong>Manifests</strong> section.</li></ol><p>For more information, see <a href="/article/n39w05njjv-environment-configuration#override_a_service_configuration" target="_blank">Override a Service Configuration</a>.</p><p>Variable precedence is different from app or autoscalar manifest precedence.</p><h4>App and Autoscalar Manifests Precedence</h4><p>App and autoscalar manifests are defined at the following levels, from highest to lowest priority:</p><ol><li><strong>Environment level for a specific Service:</strong> defined at Environment level with its scope set to a <u>specific</u> Service.</li><li><strong>Environment level for All Services:</strong> defined at Environment level with its scope set to All Services.</li><li><strong>Service level manifest:</strong> the app manifest set up in the Harness Service.<br/>See:<ul><li><a href="https://docs.harness.io/article/3ekpbmpr4e">Adding and Editing Inline Tanzu Manifest Files</a></li><li><a href="https://docs.harness.io/article/i5jxqsbkt7-upload-local-and-remote-pcf-resource-files">Upload Local and Remote Tanzu Resource Files</a></li></ul></li></ol><h3>Next Steps</h3><ul><li><a href="/article/c92izkztka-create-a-basic-pcf-deployment">Create a Basic Tanzu Deployment</a></li><li><a href="/article/99bxiqfi1u-create-a-canary-pcf-deployment">Create a Canary Tanzu Deployment</a></li><li><a href="/article/52muxcsr1v-create-a-blue-green-pcf-deployment">Create a Blue/Green Tanzu Deployment</a></li></ul><p></p>