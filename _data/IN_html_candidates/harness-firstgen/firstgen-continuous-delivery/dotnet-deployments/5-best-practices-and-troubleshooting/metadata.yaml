type: article
article_id: l639i8uqxs
user_id: mfr0nxh4be
category_id: 3lkbch7kgn
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: 5 - Best Practices and Troubleshooting
slug: 5-best-practices-and-troubleshooting
description: Best Practices and troubleshooting steps for IIS deployments in Harness.
short_version: Best Practices and troubleshooting steps for IIS deployments in Harness.
tags:
- IIS
- Troubleshooting
- PowerShell_ise
- IIS Web Server Role
- Virtual Directory
- Server Manager
- $SitePort=80
- WinRM
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2021-05-12T17:22:47.963919Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: 5 - Best Practices and Troubleshooting
  description: Best Practices and troubleshooting steps for IIS deployments in Harness.
  short_version: Best Practices and troubleshooting steps for IIS deployments in Harness.
  body: '<p>In this topic will we cover some of the Best Practices for IIS deployments
    using Harness, and some of the steps you can take to troubleshoot issues.</p><ul><li><a
    href="https://docs.harness.io/article/l639i8uqxs-5-best-practices-and-troubleshooting#best_practices">Best
    Practices</a><ul><li><a href="https://docs.harness.io/article/l639i8uqxs-5-best-practices-and-troubleshooting#testing_scripts">Testing
    Scripts</a></li><li><a href="https://docs.harness.io/article/l639i8uqxs-5-best-practices-and-troubleshooting#using_tags_for_instances">Using
    Tags for Instances</a></li><li><a href="https://docs.harness.io/article/l639i8uqxs-5-best-practices-and-troubleshooting#installing_iis_from_the_command_line">Installing
    IIS from the Command Line</a></li></ul></li><li><a href="https://docs.harness.io/article/l639i8uqxs-5-best-practices-and-troubleshooting#troubleshooting">Troubleshooting</a><ul><li><a
    href="https://docs.harness.io/article/l639i8uqxs-5-best-practices-and-troubleshooting#error_no_delegates_could_reach_the_resource">Error:
    No delegates could reach the resource</a><ul><li><a href="https://docs.harness.io/article/l639i8uqxs-5-best-practices-and-troubleshooting#solutions">Solutions</a></li></ul></li><li><a
    href="https://docs.harness.io/article/l639i8uqxs-5-best-practices-and-troubleshooting#port_conflicts">Port
    Conflicts</a></li></ul></li><li><a href="https://docs.harness.io/article/l639i8uqxs-5-best-practices-and-troubleshooting#next_steps">Next
    Steps</a></li></ul><h3>Best Practices</h3><h4>Testing Scripts</h4><p>When modifying
    the default scripts, it is better to test test your scripts on a Windows instance
    using <a href="https://docs.microsoft.com/en-us/windows-server/administration/windows-commands/powershell_ise"
    target="_blank">PowerShell_ise</a> than deploying your workflow multiple times.</p><h4>Using
    Tags for Instances</h4><p>When configuring the Infrastructure Definition in <strong>Environment</strong>,
    instance Tags make identifying your instances easier. Assign the same tag to all
    instances and simply use that tag.</p><h4>Installing IIS from the Command Line</h4><p>Before
    deploying the IIS website, application, or virtual directory to your Windows instances,
    there must be at least an existing IIS Web Server Role on the instance.</p><p>The
    following script will prepare your Windows instance with the necessary IIS set
    up:</p><pre>Start /w pkgmgr /iu:IIS-WebServerRole;IIS-WebServer;IIS-CommonHttpFeatures;IIS-StaticContent;IIS-DefaultDocument;IIS-DirectoryBrowsing;IIS-HttpErrors;IIS-ApplicationDevelopment;IIS-ASPNET;IIS-NetFxExtensibility;IIS-ISAPIExtensions;IIS-ISAPIFilter;IIS-HealthAndDiagnostics;IIS-HttpLogging;IIS-LoggingLibraries;IIS-RequestMonitor;IIS-Security;IIS-RequestFiltering;IIS-HttpCompressionStatic;IIS-WebServerManagementTools;IIS-ManagementConsole;WAS-WindowsActivationService;WAS-ProcessModel;WAS-NetFxEnvironment;WAS-ConfigurationAPI</pre><p>You
    will see IIS installed in the Server Manager.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/tr8ddfm4lz/1540412471438/image.png"/></figure><p>In
    the IIS listing, in ROLES and FEATURES, you can see the Web Server Role:</p><figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/tr8ddfm4lz/1540412420998/image.png"/></figure><p>For
    more information, see <a href="https://docs.microsoft.com/en-us/iis/install/installing-iis-7/installing-iis-from-the-command-line"
    target="_blank">Installing IIS 7.0 from the Command Line</a> from Microsoft.</p><p></p><h3>Troubleshooting</h3><p>The
    following problems can occur when deploying your IIS website, application, or
    virtual directory.</p><h4>Error: No delegates could reach the resource</h4><p>You
    receive this error when deploying your workflow.</p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/pvjfe077ii/1535412994991/image.png"
    style="max-height:60%;max-width:60%" data-hd-height="60%" data-hd-width="60%"/></figure><h5>Solutions</h5><ul><li>Ensure
    your artifact can be deployed via WinRM onto a Windows instance. It&#39;s possible
    to select the wrong artifact in Service.</li><li>Ensure you have access to the
    deployment environment, such as VPC, subnet, etc.</li><li>Ensure your WinRM Connection
    can connect to your instances, and that your instances have the correct ports
    open. See <a href="/article/1n0t9vo7e4-1-delegate-and-connectors-for-iis#set_up_win_rm_on_instances_and_network">Set
    Up WinRM on Instances and Network</a>.</li></ul><h4>Port Conflicts</h4><p>Do not
    target the same port as another website. In the Harness <strong>Service</strong>,
    in <strong>Variables</strong>, ensure <strong>${SitePort}</strong> points to a
    port that isn&#39;t in use. In the following example, the port was changed to
    <strong>8080</strong> to avoid the error:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/l639i8uqxs/1583537252845/image.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>You
    can keep the same port and use host header names to host multiple IIS sites using
    the same port. For more information, search the Web for <code>use same port and
    use host header names to host multiple IIS sites</code>. There are multiple examples.
    </p><h3>Next Steps</h3><p>Now that you have a working deployment, you can use
    the Harness Continuous Verification machine learning to verify and improve your
    deployments. For more information, see <a href="/article/myw4h9u05l-verification-providers-list">Continuous
    Verification</a>.</p><p>Enhance your IIS deployment workflow(s) with the multiple
    options available, including Failure Strategy, Rollback Steps, Barriers, and templating.
    For more information, see <a href="/article/m220i1tnia-workflow-configuration">Add
    a Workflow</a>.</p>'
  slug: 5-best-practices-and-troubleshooting
  tags:
  - IIS
  - Troubleshooting
  - PowerShell_ise
  - IIS Web Server Role
  - Virtual Directory
  - Server Manager
  - $SitePort=80
  - WinRM
  is_live: true
