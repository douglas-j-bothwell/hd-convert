<p>This topic outlines how to connect Harness accounts and applications with one or more Azure DevOps repositories. You add these repos as Source Repo Providers in Harness.</p><h3>Before You Begin</h3><ul><li><a href="/article/htvzryeqjw-configuration-as-code">Configuration as Code Overview</a>: you can synch your Harness account or applications with a repo and work entirely from Git.</li><li><a href="/article/yjkkwi56hl-link-resource-files-or-helm-charts-in-git-repos">Link Resource Files or Helm Charts in Git Repos</a>: this is an example of using a Source Repo Provider to pull remote Kubernetes manifest files. Source Repo Providers are used in many other Harness components.</li></ul><div class="note-callout">Ensure your Git repo is initialized (<code>git init</code>) before connecting Harness to it.</div><h3>Limitations</h3><ul><li>One Harness Application cannot be in multiple repos.</li><li>Before Harness syncs with your Git repo, it will confirm that all Harness&#39; settings are in a valid state. If a connection is not working Harness will not sync with your Git repo.</li><li>Harness does not support Azure DevOps <a href="https://docs.microsoft.com/en-us/azure/devops/repos/git/merging-with-squash" target="_blank">squash merge pull requests</a> with Harness <a href="/article/htvzryeqjw-configuration-as-code">Configuration as Code</a> (Git sync with Harness).</li><li>Harness performs a <code>git clone</code> to fetch files. If the fetch is timing out, it can be because the repo is too large for the network connection to fetch it before timing out. To fetch very large repos, enable the feature flag <code>OPTIMIZED_GIT_FETCH_FILES</code>. When this feature flag is enabled, Harness will use provider-specific APIs to improve performance.<br/><div class="note-callout">If you enable <code>OPTIMIZED_GIT_FETCH_FILES</code>, you must use a <u><strong>token</strong></u> for authentication. Passwords are not supported.</div><div class="note-callout">Currently, this feature is behind the feature flag <code>OPTIMIZED_GIT_FETCH_FILES</code>. Contact <a href="mailto:support@harness.io" target="_blank">Harness Support</a> to enable the feature.</div></li></ul><h4>Current Azure DevOps Support in Harness</h4><p>Azure DevOps support is limited for the following Harness features:</p><ul><li><a href="/article/dvm5q9j0d0-trigger-google-cloud-builds">Google Cloud Builds</a>: pulling build spec from Azure DevOps repo is not supported.</li><li><a href="/article/xerirloz9a-add-a-trigger-2">Harness Triggers</a>: not supported with Azure DevOps.</li></ul><h3>Step: Add Source Repo Provider</h3><p>To add a source repo, do the following:</p><ol><li>Click <strong>Setup</strong>.</li><li>Click <strong>Connectors</strong>.</li><li>Click <strong>Source Repo Providers</strong>, and then click <strong>Add Source Repo Provider</strong>. The <strong>Git Connector</strong> settings appear.</li></ol><h3>Step: Display Name</h3><p>Enter a name for the repo connection.</p><p>This is the name you will select when you sync your Harness account and applications in <a href="https://docs.harness.io/article/htvzryeqjw-configuration-as-code">Configuration as Code</a> or other settings where you use the repo.</p><h3>Step: Provider</h3><div class="note-callout">Currently, this feature is behind the Feature Flag <code>OPTIMIZED_GIT_FETCH_FILES</code>. Contact <a href="mailto:support@harness.io" target="_blank">Harness Support</a> to enable the feature.</div><p>In <strong>Provider</strong>, select <strong>Git</strong>.</p><h3>Step: URL</h3><p>Enter the URL for your DevOps repo, depending on what you selected in <strong>Type</strong>.</p><p>Select <strong>HTTPS</strong> or <strong>SSH</strong> for the connection. You will need to provide the protocol-relevant URL in <strong>URL</strong>. If you use Two-Factor Authentication for your Git repo, connect over <strong>HTTPS</strong> or <strong>SSH</strong>.</p><div class="note-callout">For SSH, ensure that the key is not OpenSSH, but rather PEM format. To generate an SSHv2 key, use: <code>ssh-keygen -t rsa -m PEM</code> The <code>rsa</code> and <code>-m PEM</code> ensure the algorithm and that the key is PEM.Next, follow the prompts to create the PEM key. For more information, see the  <a href="https://linux.die.net/man/1/ssh-keygen" target="_blank">ssh-keygen man page</a> and <a href="https://help.github.com/en/github/authenticating-to-github/connecting-to-github-with-ssh" target="_blank">Connecting to GitHub with SSH</a>.</div><p>In your DevOps repo, click <strong>Clone</strong>, and then copy the URL.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/k89ioqv8fw/1624646790906/clean-shot-2021-06-25-at-11-46-04.png"/></figure><p></p><div class="note-callout">Make sure you copy the URL from Azure and not form it yourself. Azure replaces spaces and other formatting with the correct values and ensures the link will work.</div><h3>Step: Credentials</h3><p>Enter your Azure user name.</p><p>Enter a password or token.</p><p>For token, in Azure, create a Personal Access Token (PAT).</p><p>Next, add the token to Harness as a Harness Secret.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/k89ioqv8fw/1624646658203/clean-shot-2021-06-25-at-11-43-53.png"/></figure><p>Enter the PAT in the secret and select the secret in <strong>Select Encrypted Password/Token</strong>.</p><p></p><div class="note-callout">If you enable <code>OPTIMIZED_GIT_FETCH_FILES</code>, you must use a <u><strong>token</strong></u> for authentication. Passwords are not supported.</div><h3>Step: Branch Name</h3><p>Enter the branch name to sync with Harness, such as <strong>master</strong>, <strong>dev</strong>, or <strong>myAppName</strong>. Do not enter the full URL to the branch.</p><div class="note-callout">Names may not contain characters from the Emoticons unicode block.</div><h3>Option: Delegate Selector</h3><p>If you want this Connector to use one or more specific Delegates, use a Delegate Selector. If you do not use a Selector, Harness will select a Delegate that has worked in the past for this type of Connector.</p><p>In <strong>Delegate Selector</strong>, select the Selector for the Delegate(s) you want this Connector to use. You add Selectors to Delegates to make sure that they&#39;re used to execute the command. For more information, see <a href="https://docs.harness.io/article/c3fvixpgsl-select-delegates-for-specific-tasks-with-selectors">Select Delegates with Selectors</a>.</p><p>Harness will use Delegates matching the Selectors you add.</p><p>If you use one Selector, Harness will use any Delegate that has that Selector.</p><p>If you select two Selectors, a Delegate must have both Selectors to be selected. That Delegate might also have other Selectors, but it must have the two you selected.</p><h3>Option: Customize Commit Attributes (Git Sync Only)</h3><p>When Harness commits or pushes a change to Git as part of syncing, it uses Harness.io and support@harness.io as the author and commit email address of that commit.</p><p>In some cases, you might have strong pre-commit limitations on who may or may not commit. In that case, you need to provide an author name and email that is approved to push on that repo. You can add an Author Name and Author Email address that will be applied whenever Harness syncs with the Git repo.</p><h3>Step: Generate Webhook URL</h3><p>Enable this checkbox if you want to sync Harness with your repo bidirectionally. Changes made on either end will be synced.</p><p>If you simply want Harness changes synched unidirectionally with the repo, disable this checkbox.</p><p>When you use this Source Repo Provider to sync a Harness application to a repo bidirectionally, any account or application that uses this Source Repo provider will be synced bidirectionally.</p><p>For more information, see <a href="https://docs.harness.io/article/htvzryeqjw-configuration-as-code">Configuration as Code</a>.</p><h3>Option: Using the Webhook</h3><p>If you selected the <strong>Generate Webhook URL</strong> option when adding your <strong>Source Repo Provider</strong>, the <strong>Generated Webhook URL</strong> dialog appears. Copy the URL and use it in your repo to enable your repo to sync changes to Harness.</p><p>For steps on setting this up in your repo, see <a href="https://docs.microsoft.com/en-us/azure/devops/service-hooks/services/webhooks?view=azure-devops" target="_blank">Webhooks</a> from Azure. The Webhook is added in <strong>Project Settings</strong> &gt; <strong>Service hooks</strong>.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/k89ioqv8fw/1624647651063/clean-shot-2021-06-25-at-12-00-19.png"/></figure><p>The Azure Service Hook must use <strong>Code pushed</strong> as its <strong>Trigger on this type of event</strong>.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/k89ioqv8fw/1624899663665/clean-shot-2021-06-28-at-10-00-51.png"/></figure><h3>Step: Test and Save</h3><p>To finish configuring this Source Repo Provider:</p><ol><li style="counter-increment:li 0" start="1">In the <strong>Git Connector</strong> settings, click <strong>Test</strong>.<br/>Harness verifies the settings you entered.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/k89ioqv8fw/1624647829800/clean-shot-2021-06-25-at-12-03-20.png"/></figure></li><li>When testing is successful, click <strong>Submit</strong>. This Source Repo Provider is now added to Harness.</li></ol><h3>Next Steps</h3><p></p><ul><li>Once a Source Repo Provider is set up, you can use it—at the Harness account level and Application level—to sync your account and/or applications with your Git repo. See <a href="/article/htvzryeqjw-configuration-as-code">Configuration as Code</a>.</li><li>To trigger Harness workflows and pipelines using Git Webhooks, see <a href="/article/xerirloz9a-add-a-trigger-2">Add a Trigger</a>.</li><li>To sync and clone a Harness Application template in Git, see <a href="/article/3av5pc4goc-onboard-teams-using-git-ops">Onboard Teams Using GitOps</a>.</li></ul><p></p>