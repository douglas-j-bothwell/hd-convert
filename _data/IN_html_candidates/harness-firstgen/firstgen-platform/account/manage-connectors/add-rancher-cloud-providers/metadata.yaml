type: article
article_id: dipgqjn5pq
user_id: mfr0nxh4be
category_id: ll7h8ktlwe
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: Add Rancher Cloud Providers
slug: add-rancher-cloud-providers
description: Set up a Harness Ranch Cloud Provider.
short_version: Set up a Harness Ranch Cloud Provider.
tags: []
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: ""
  source: API
  triggered_at: 2022-07-06T19:15:25.351288Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Add Rancher Cloud Providers
  description: Set up a Harness Ranch Cloud Provider.
  short_version: Set up a Harness Ranch Cloud Provider.
  body: '<div class="note-callout">Currently, this feature is behind the feature flag
    <code>RANCHER_SUPPORT</code>. Contact <a href="mailto:support@harness.io" target="_blank">Harness
    Support</a> to enable the feature.</div><p>You can deploy Kubernetes Services
    to multiple clusters simultaneously using Rancher and Harness. You use Rancher
    cluster labels to identify multiple clusters in a Harness Infrastructure Definition,
    and then deploy to each cluster simultaneously.</p><p>To connect Harness to your
    Rancher account, you must set up a Harness Rancher Cloud Provider.</p><p>This
    topic describes how to set up a Harness Ranch Cloud Provider.</p><p>Once you are
    done adding a Rancher Cloud Provider, you can deploy Kubernetes Services to multiple
    clusters simultaneously. See <a href="/article/hsc50ny57g-deploy-kubernetes-service-to-multiple-clusters-using-rancher">Deploy
    Kubernetes Services to Multiple Clusters using Rancher</a>.</p><p>In this topic:</p><ul><li><a
    href="https://docs.harness.io/article/dipgqjn5pq-add-rancher-cloud-providers#before_you_begin">Before
    You Begin</a></li><li><a href="https://docs.harness.io/article/dipgqjn5pq-add-rancher-cloud-providers#visual_summary">Visual
    Summary</a></li><li><a href="https://docs.harness.io/article/dipgqjn5pq-add-rancher-cloud-providers#undefined">Supported
    Platforms and Technologies</a></li><li><a href="https://docs.harness.io/article/dipgqjn5pq-add-rancher-cloud-providers#review_harness_delegates_and_rancher_clusters">Review:
    Harness Delegates and Rancher Clusters</a></li><li><a href="https://docs.harness.io/article/dipgqjn5pq-add-rancher-cloud-providers#step_1_create_a_rancher_account_bearer_token">Step
    1: Create a Rancher Account Bearer Token</a></li><li><a href="https://docs.harness.io/article/dipgqjn5pq-add-rancher-cloud-providers#step_2_add_a_rancher_cloud_provider">Step
    2: Add a Rancher Cloud Provider</a></li><li><a href="https://docs.harness.io/article/dipgqjn5pq-add-rancher-cloud-providers#see_also">See
    Also</a></li></ul><h3>Before You Begin</h3><ul><li>This topic assumes you are
    familiar with Rancher, have a Rancher account, and have set up Kubernetes clusters
    in its UI. If you are new to Rancher, see <a href="https://rancher.com/docs/rancher/v2.5/en/cluster-provisioning/"
    target="_blank">Setting up Kubernetes Clusters in Rancher</a> from Rancher.</li></ul><h3>Visual
    Summary</h3><p>Enter the following in the Harness Rancher Cloud Provider:</p><ul><li>URL
    of the Rancher endpoint.</li><li>Bearer token for the Rancher account to use.</li></ul><p></p><figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/dipgqjn5pq/1644885199151/clean-shot-2022-02-14-at-16-33-00.png"/></figure><h3
    id="undefined">Supported Platforms and Technologies</h3><p>SeeÂ <a href="/article/220d0ojx5y-supported-platforms">Supported
    Platforms and Technologies</a>.</p><h3>Review: Harness Delegates and Rancher Clusters</h3><p>Before
    setting up a Rancher Cloud Provider, you need to install a Harness Delegate in
    your environment.</p><p>The Harness Delegate does not need to be a Kubernetes
    Delegate and it does not need to be installed in a target cluster.</p><p>The Harness
    Delegate does need to be able to connect to the Rancher URL endpoint and to connect
    to the target Kubernetes clusters.</p><p>See <a href="/article/h9tkwmkrm7-delegate-installation">Harness
    Delegate Overview</a>.</p><h3>Step 1: Create a Rancher Account Bearer Token</h3><p>In
    Rancher, create a <u>bearer token</u> to use for Harness authentication with Rancher.</p><p>The
    Rancher bearer token you use must be able to use the <code>/v3/clusters/{clusterName}?action=generateKubeconfig</code>
    and <code>/v3/clusters</code> APIs. The Rancher user account you use to generate
    the token should have the Rancher <strong>Cluster Owner</strong> role or a Global
    Permission that enable cluster administration. See <a href="https://rancher.com/docs/rancher/v2.0-v2.4/en/admin-settings/rbac/cluster-project-roles/"
    target="_blank">Cluster and Project Roles</a> and <a href="https://rancher.com/docs/rancher/v2.6/en/admin-settings/rbac/global-permissions/">Global
    Permissions</a> from Rancher.</p><p>For steps on creating a bear token, see <a
    href="https://rancher.com/docs/rancher/v2.5/en/user-settings/api-keys/" target="_blank">API
    Keys</a> from Rancher.</p><p>Save the token in a secure location.</p><p>A few
    things to consider:</p><ul><li>When you create the token, you can scope it to
    specific clusters. A scope will limit the API key so that it will only work against
    the Kubernetes API of the specified clusters. If you scope the bearer token to
    specific clusters, Harness will only be able to query and target that list of
    clusters when deploying.</li><li>If you set an expiration period for the token,
    make sure that its expiration date will not impact your Harness deployments.</li></ul><h3>Step
    2: Add a Rancher Cloud Provider</h3><p>In Harness, click <strong>Setup</strong>,
    and then click <strong>Cloud Providers</strong>.</p><p>Click <strong>Add Cloud
    Provider</strong>, and then select <strong>Rancher</strong>. The <strong>Rancher</strong>
    Cloud Provider appears.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/dipgqjn5pq/1644884796598/clean-shot-2022-02-14-at-16-26-28.png"/></figure><p>In
    <strong>Display Name</strong>, give the Cloud Provider a name.</p><p>In <strong>Rancher
    URL</strong>, enter the Rancher URL endpoint. This is the domain name you use
    to connect to Rancher, such as <code>https://rancher-internal.dev.mycompany.io</code>.
    Make sure to include the URL scheme.</p><p>In <strong>Select Encrypted Bearer
    Token</strong>, click <strong>Create Encrypted Text</strong>, and add the Rancher
    bearer token to Harness. See <a href="/article/ygyvp998mu-use-encrypted-text-secrets">Use
    Encrypted Text Secrets</a>.</p><p>Click <strong>Test</strong>. Harness reports
    <strong>Test was successful</strong>. If the test fails, check that the URL and
    bearer token are correct.</p><p>Click <strong>Submit</strong>.</p><p>The Rancher
    Cloud Provider is added.</p><h3>See Also</h3><ul><li><a href="/article/hsc50ny57g-deploy-kubernetes-service-to-multiple-clusters-using-rancher">Deploy
    Kubernetes Services to Multiple Clusters using Rancher</a></li></ul><p></p>'
  slug: add-rancher-cloud-providers
  tags: []
  is_live: true
