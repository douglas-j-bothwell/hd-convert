<p>You can use Template Library to create templates of scripts and other commands and copy or link them into Harness Services and Workflows.</p><p>To add bash and PowerShell commands to Services, you can create templates using a Service Command template. You can add variables to the template and have values supplied to the variables in the Service using the template.</p><div class="note-callout">Only members of a Harness User Group with the <strong>Manage Template Library</strong> permission may create, edit, and delete Account and Application-level templates. Members of a User Group with this permission disabled can view and link to templates only.</div><p>In this topic:</p><ul><li><a href="https://docs.harness.io/article/kbmz9uc7q9-create-a-service-command-template#before_you_begin">Before You Begin</a></li><li><a href="#review_differences_between_service_command_and_shell_script_template_types">Review: Differences between Service Command and Shell Script Template Types</a></li><li><a href="https://docs.harness.io/article/kbmz9uc7q9-create-a-service-command-template#step_create_a_service_command">Step: Create a Service Command</a></li><li><a href="https://docs.harness.io/article/kbmz9uc7q9-create-a-service-command-template#next_steps">Next Steps</a></li></ul><h3>Before You Begin</h3><ul><li><a href="/article/ygi6d8epse-use-templates">Account and Application Templates</a></li><li><a href="https://docs.harness.io/article/eb3kfl8uls-service-configuration">Add a Service</a></li><li><a href="https://docs.harness.io/article/m220i1tnia-workflow-configuration">Add a Workflow</a></li></ul><h3>Review: Differences between Service Command and Shell Script Template Types</h3><p>Harness provides different methods for executing scripts in the Service Command and Shell Script Template types:</p><ul><li><strong>Service Command Template</strong>: a Service Command can run multiple scripts, including built-in scripts Harness provides, like the <a href="/article/qluiky79j8-service-types-and-artifact-sources#exec_script">Exec</a> and <a href="/article/qluiky79j8-service-types-and-artifact-sources#copy_and_download_of_metadata_artifact_sources">Copy Artifact</a> scripts.<br/>When run on the target host, the commands are copied to the target host and run as an input parameter like <code>./internal-executor.sh script.sh</code> where <code>script.sh</code> is the script you provide. This is done using the Bourne shell (sh).</li><li><strong>Shell Script Template:</strong> a Shell Script step runs a single script.<br/>When run on the target host, the script is run inline using the Bash shell.</li></ul><h4>Where are they executed?</h4><p>Both Service Commands and Shell Scripts can be executed on the target host or the Harness Delegate.</p><p>When you create the templates, you do not pick where to deploy it.</p><p>When you apply the template, you use the <strong>Execute on Delegate</strong> option to run the script on the Delegate host, and the <strong>Delegate Selector</strong> option to pick specific Delegates, if desired.</p><ul><li><strong>Run on target host:</strong> Harness moves the complete script to the target host (VM, pod, etc), and then executes the script.</li><li><strong>Run on Delegate:</strong> Harness doesn&#39;t copy any file to the target host. Harness executes the script on the Delegate directly.</li></ul><h3>Step: Create a Service Command</h3><p>To create a Service Command, do the following:</p><ol><li>Click <strong>Setup</strong>.</li><li>In <strong>Account</strong>, click <strong>Template Library</strong>.</li><li>Click the template folder where you want to add your new template.</li><li>Click <strong>Add Template</strong> and select the <strong>Service Command</strong> template type. The <strong>Add Service Command Template</strong> settings appear.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ygi6d8epse/1579912598739/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Enter a name and description for the command.</li><li>In <strong>Variables</strong>, click <strong>Add</strong> to add variables to the template. You can set a default value. The variable value can be supplied or replaced when the template is used in a Service.</li><li>Click <strong>Submit</strong>. The new Service Command template is created.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ygi6d8epse/1547246455435/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Hover over <strong>Add</strong> to see the list of available subcommands to add to the template.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ygi6d8epse/1547246518891/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click a subcommand to see its script and make any changes.</li><li>To use the template in a Service, click <strong>Add Command</strong> in the Service and then click <strong>From Template Library</strong>. The template is displayed.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ygi6d8epse/1547246647989/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click <strong>Link</strong> to link to the template. You can then edit the template in your Service, providing values for the variables in the template. When you use this Service in a Workflow, the Service command will be available as a step.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/ygi6d8epse/1558480375100/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li></ol><h3>Step: Run Service Commands From a Template Library in a Workflow</h3><p>One of the steps you can include in a Harness Workflow is a <strong>Service Command</strong> step.</p><p>You can link a Service Command to a Workflow as a step and its script will be run on the target host(s) or Harness Delegate.</p><div class="note-callout">Template variable names cannot contain hyphens or dots (<code>.</code>) between names.</div><p>In a Harness Application, open a Workflow and then click <strong>Add Step</strong>.</p><ol><li>Select <strong>Template Library</strong> to select the Service Command from the Template Library. You can also select <strong>Application Templates</strong> to select from the command from the Application Template Library.</li><li>Locate your command and click <strong>Link</strong>.</li><li>Set the <strong>Timeout</strong> period for your Service Command. If the command execution hangs beyond the timeout, Harness will fail the step.</li><li>Select <strong>Execute on Delegate</strong> option if you wish to execute Workflow on Harness Delegate. This option allow users to select Delegates on Service commands.</li><li>In <strong>Delegate Selector</strong> enter the Selectors of the Delegates you want to use.<br/><br/>You can use Selectors to select which Harness Delegates to use when executing the Service Command step. For more information, see <a href="/article/c3fvixpgsl-select-delegates-for-specific-tasks-with-selectors">Select Delegates with Selectors</a>.<ul><li>Harness will use Delegates matching the Selectors you select.</li><li>If you use one Selector, Harness will use any Delegate that has that Selector.</li><li>If you select two Selectors, a Delegate must have both Selectors to be selected. That Delegate might also have other Selectors, but it must have the two you selected.</li><li>Selectors can be used whether <strong>Execute on Delegate</strong> is enabled or not. The Shell Script command honors the Selector and executes the SSH connection to the specified target host via the selected Delegate. An example where Selectors might be useful when <strong>Execute on Delegate</strong> is disabled: When you specify an IP address in <strong>Target Host</strong>, but you have 2 VPCs with the same subnet and duplicate IP numbers exist in both. Using Selectors, you can scope the the shell session towards the delegate in a specific VPC.</li><li>You can also use <a href="https://docs.harness.io/article/9dvxcegm90-variables">Harness variable expressions</a>. For example, if you have a Workflow variables named delegate, you can enter <code>$(workflow.variables.delegate)</code>. When you deploy the Workflow, you can provide a value for the variable that matches a Delegate Selector.</li></ul></li><li>If you do not select <strong>Execute on Delegate</strong> option and want to run it in another host, enter the following details:<ol><li><strong>Target Host</strong>: In <strong>Target Host</strong>, enter the IP address or hostname of the remote host where you want to execute the script. The target host must be in the <strong>Infrastructure Definition</strong> selected when you created the workflow, and the Harness Delegate must have network access to the target host. You can also enter the variable <code>${instance.name}</code> and the script will execute on whichever target host is used during deployment.</li><li><strong>Connection Type</strong>: Select <strong>WinRM</strong> or <strong>SSH</strong>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/kbmz9uc7q9/1606281940661/screenshot-2020-11-23-at-11-46-08-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li></ol></li><li>Click <strong>Submit</strong>.</li></ol><h3>Next Steps</h3><ul><li><a href="/article/dv7ajeroou-account-and-application-templates">Create an HTTP Workflow Step Template</a></li><li><a href="/article/lfqn3t83hd-create-a-shell-script-workflow-step-template">Create a Shell Script Workflow Step Template</a></li><li><a href="/article/xd70p7rmqd-link-templates-to-services-and-workflows">Link Templates to Services and Workflows</a></li><li><a href="/article/mfoy0hrw8y-add-service-command-templates-into-command-units">Add Service Command Templates into Command Units</a></li></ul><p></p><p></p>