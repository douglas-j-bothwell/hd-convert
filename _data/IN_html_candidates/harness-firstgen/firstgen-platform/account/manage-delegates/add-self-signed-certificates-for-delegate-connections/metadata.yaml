type: article
article_id: 8bj3v5jqzk
user_id: mfr0nxh4be
category_id: gyd73rp7np
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: Add Self-Signed Certificates for Delegate Connections
slug: add-self-signed-certificates-for-delegate-connections
description: The Harness Delegate makes outbound connections to the resources you
  set up in Harness as Artifact Servers, Verification Providers, and so on. These
  platforms typically use public certificates that s…
short_version: The Harness Delegate makes outbound connections to the resources you
  set up in Harness as Artifact Servers, Verification Providers, and so on. These
  platforms typically use public certificates that s…
tags: []
show_toc: false
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: ""
  source: API
  triggered_at: 2022-07-06T18:58:21.776986Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Add Self-Signed Certificates for Delegate Connections
  description: ""
  short_version: ""
  body: '<p>The Harness Delegate makes outbound connections to the resources you set
    up in Harness as Artifact Servers, Verification Providers, and so on. These platforms
    typically use public certificates that ship with the OS and Java runtime environments,
    and so no additional steps are needed.</p><p>But if you are using self-signed
    certificates, you will need to add them to the Delegate.</p><div class="note-callout">For
    information on Harness On-Prem and certificates, see <a href="/article/kgvg58wg1g-on-prem-embedded-cluster-setup">Virtual
    Machine On-Prem: Installation Guide</a> and <a href="/article/hmza5cvxib-existing-cluster-kubernetes-on-prem-infrastructure-requirements">Kubernetes
    Cluster On-Prem: Infrastructure Requirements</a>.</div><p>These certificates are
    stored in the JRE keystore on the hosts running the Delegate (or truststore for
    back-end application certificates), and you can import the certificates manually
    or using a Harness Delegate INIT script. See <a href="/article/ul6qktixip-run-initialization-scripts-on-delegates">Run
    Initialization Scripts on Delegates</a>.</p><div class="note-callout">For information
    on TLS and the JRE, see <a href="https://docs.oracle.com/cd/E19830-01/819-4712/ablqw/index.html"
    target="_blank">Sun Java System Application Server Platform Edition 8.2 Administration
    Guide</a> and <a href="https://docs.oracle.com/javase/9/tools/keytool.htm#JSWOR-GUID-5990A2E4-78E3-47B7-AE75-6D1826259549"
    target="_blank">keytool</a>.</div><h3>Using Explicit Paths</h3><p>Here is the
    the self-signed certificate import using explicit paths:</p><pre>/opt/harness-delegate/jdk8u242-b08-jre/bin/keytool
    -import -trustcacerts -keystore /opt/harness-delegate/jdk8u242-b08-jre/lib/security/cacerts
    -storepass changeit -alias example.com -file ca.cer -noprompt</pre><h3>Using JAVA_HOME
    and PATH</h3><p>Here is the the self-signed certificate import using the PATH
    environment variable:</p><pre>export JAVA_HOME=/opt/harness-delegate/&lt;jdk_version&gt;<br/><br/>set
    PATH=$PATH:$JAVA_HOME/bin</pre><p>Here is the the self-signed certificate import
    using PATH:</p><pre>echo ${secrets.getValue(&#34;ex-cert&#34;)} | base64 -d &gt;
    ca.cer<br/><br/>keytool -import -trustcacerts -keystore $JAVA_HOME/lib/security/cacerts
    -storepass changeit -alias example.com -file ca.cer -noprompt<br/><br/># Depending
    on the different versions of JDK, the CACERT keystore might reside in different
    locations.</pre><h3>Password</h3><p>The default keystore password is used in our
    example, but if you change the default you can replace the password with a Harness
    encrypted text secret.</p><p>If you create or add to Import a Certificate that
    already exists in the INIT script, the import operation will fail and stop. Make
    sure to add an <code>if block</code> code check to prevent this, as follows:</p><pre>if
    [$? -eq 0];<br/>then<br/>echo &#34;Alias ca.cer already exists&#34;<br/>else</pre><h3>See
    Also</h3><ul><li><a href="https://community.harness.io/t/adding-3rd-party-ca-certificate-s-to-kubernetes-and-or-openshift-harness-delegates/831"
    target="_blank">Adding 3rd Party CA certificate(s) to Kubernetes and/or OpenShift
    Harness Delegates</a> from Harness Community</li></ul><p></p><p></p>'
  slug: add-self-signed-certificates-for-delegate-connections
  tags: []
  is_live: true
