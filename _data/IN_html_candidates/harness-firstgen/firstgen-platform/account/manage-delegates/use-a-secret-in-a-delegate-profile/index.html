<div class="warning-callout">Using Profiles is Deprecated. Please use <a href="/article/ul6qktixip-run-initialization-scripts-on-delegates">Run Initialization Scripts on Delegates</a>.</div><p>To use secrets in a Delegate Profile, create encrypted text in Harness Secrets Management for the credentials, and then use variable names for those credentials in the Delegate Profile.</p><p>In this topic:</p><ul><li><a href="#before_you_begin">Before You Begin</a></li><li><a href="#step_1_add_encrypted_texts">Step 1: Add Encrypted Texts</a></li><li><a href="#step_2_manage_delegate_profiles">Step 2: Manage Delegate Profiles</a></li><li><a href="#step_3_use_secret_in_profile_script">Step 3: Use Secret in Profile Script</a></li><li><a href="https://docs.harness.io/article/imzgiz9h41-use-a-secret-in-a-delegate-profile#review_use_config_files_in_delegate_profiles">Review: Use Config Files in Delegate Profiles</a></li></ul><h3>Before You Begin</h3><ul><li><a href="/article/4o7oqwih6h-harness-key-concepts">Harness Key Concepts</a></li><li><a href="/article/au38zpufhr-secret-management">Secrets Management Overview</a></li><li><a href="/article/ygyvp998mu-use-encrypted-text-secrets">Use Encrypted Text Secrets</a></li><li><a href="/article/yd4bs0pltf-run-scripts-on-the-delegate-using-profiles">Run Scripts on Delegates using Profiles</a></li></ul><p></p><h3>Step 1: Add Encrypted Text</h3><p>For <a href="https://docs.harness.io/article/h9tkwmkrm7-delegate-installation#delegate_profiles">Delegate Profiles</a>, if you wanted to add a Helm repo that requires login credentials to every Kubernetes pod running a Harness Kubernetes Delegate, you can create encrypted text in Harness Secrets Management for those credentials, and then use variable names for those credentials in the Delegate Profile using the <code>${secrets.getValue(&#34;secret_name&#34;)}</code> expression.</p><p>For more information about Delegate Profiles, see <a href="/article/yd4bs0pltf-run-scripts-on-the-delegate-using-profiles">Run Scripts on Delegates using Profiles</a> and <a href="/article/nxhlbmbgkj-common-delegate-profile-scripts">Common Delegate Profile Scripts</a>.</p><p></p><ol><li>In Harness, select <strong>Continuous Security</strong> &gt; <strong>Secrets Management</strong>.<br/>The <strong>Secrets Management</strong> page appears.</li><li>Under <strong>Execution Credentials</strong>, click <strong>Encrypted Text</strong>. The <strong>Encrypted Text</strong> page appears.</li><li>Click <strong>Add Encrypted Text</strong>. The <strong>Add Encrypted Text</strong> dialog appears.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/au38zpufhr/1580864256095/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>In <strong>Name</strong>, enter <strong>repoUsername</strong>. This name will be used later in the <strong>Delegate Profile</strong> script to reference this secret.</li><li>In <strong>Value</strong>, enter any <strong>username</strong>. The dialog will look like this:</li></ol><p></p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/au38zpufhr/1573065585725/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><ol><li style="counter-increment:li 5" start="6">In <strong>Usage Scope</strong>, click <strong>Scope to Account</strong>. This will scope the secret to the Account-level. It can then be used in a Delegate Profile.<div class="note-callout">You must set <strong>Usage Scope</strong> to <strong>Scope to Account</strong> to use the secret in a Delegate Profile. Once it is set to <strong>Scope to Account</strong>, the secret can used in a Delegate Profile only.</div><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/au38zpufhr/1573065628503/image.png"/></figure></li><li>Click <strong>Submit</strong>.</li><li>Add a second encrypted text with the name <strong>repoPassword</strong>, using any password. Be sure to set <strong>Usage Scope</strong> to <strong>Scope to Account</strong>, also. The dialog will look like this:<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/au38zpufhr/1573065682858/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click <strong>Submit</strong>. Now you can create a Delegate Profile and use these secrets.</li></ol><p></p><h3>Step 2: Manage Delegate Profiles</h3><ol><li>Click <strong>Setup</strong>.</li><li>Click <strong>Harness Delegates</strong>.</li><li>Click <strong>Manage Delegate Profiles</strong>, and then <strong>Add Delegate Profile</strong>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/imzgiz9h41/1620840093272/mj-5-frss-fvrzt-wc-bpj-gcrpb-ozx-7-k-7-h-y-c-2-p-7-ku-itb-8-qob-n-5-h-rsbfniurc-kjnv-fa-jqn-1-stlqtyt-6-a-0-pr-5-tmy-9-zkz-2-9-hent-96-e-5-r-ddjftr-bxla-oj-szajpu-sr-iozlosiqt-nr-7-upe-se"/></figure>The <strong>Manage Delegate Profile</strong> dialog appears.</li><li>In <strong>Name</strong>, enter <strong>Helm Repo</strong>.</li></ol><h3>Step 3: Use Secret in Profile Script</h3><ol><li>In <strong>Startup Script</strong>, enter your Helm commands using the secrets you created:<br/><br/><code>helm init --client-only</code><br/><br/><code>helm repo add --username</code><strong><code>${secrets.getValue(“repoUsername”)}</code></strong><code>--password</code><strong><code>${secrets.getValue(“repoPassword”)}</code></strong><code>nginx https://charts.bitnami.com/bitnami</code><br/><br/><code>helm repo update</code><br/><br/>The secrets are referenced as variables using <code>${secrets.getValue()}</code> and the names you gave them, <strong>repoUsername</strong> and <strong>repoPassword</strong>:<br/><br/><code>${secrets.getValue(“repoUsername”)}</code><br/><code>${secrets.getValue(“repoPassword”)}</code><br/><br/>The <strong>Manage Delegate Profile</strong> dialog will look like this:<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/au38zpufhr/1585285164774/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click <strong>Submit</strong>.</li></ol><p>Now when you add this profile to a Kubernetes Delegate, it will add the Helm repo using the credentials you added as <strong>Encrypted Text</strong> in Harness <strong>Secrets Management</strong>.</p><p>A quick way to get the name of a secret is to hover over the secrets in <strong>Secrets Management</strong> and click the Copy icon:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/au38zpufhr/1553903487541/image.png" style="max-height:25%;max-width:25%" data-hd-height="25%" data-hd-width="25%"/></figure><h3>Review: Use Config Files in Delegate Profiles</h3><p>The <a href="/article/iwtoq9lrky-add-service-level-configuration-files">Service Config file</a> expressions <code>${configFile.getAsString(&#34;fileName&#34;)}</code> and <code>${configFile.getAsBase64(&#34;fileName&#34;)}</code> are not supported in <a href="/article/yd4bs0pltf-run-scripts-on-the-delegate-using-profiles">Delegate Profiles</a>.</p><p>Instead, encode the file in base64 and then add the file to Harness as an <a href="/article/nt5vchhka4-use-encrypted-file-secrets">Encrypted File Secret</a>.</p><p>Next, in the Delegate Profile script, reference the secret, pipe it to base64 and output it to the path where you need it:</p><pre>echo ${secrets.getValue(&#34;secret_name&#34;)} | base64 -d &gt; /path/to/file</pre><p></p>