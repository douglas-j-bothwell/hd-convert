<p>This topic lists sample queries that read, create, update and delete <a href="/article/au38zpufhr-secret-management">Harness secrets</a> that rely on encrypted files.</p><p>In this topic:</p><ul><li><a href="#get_secret">Get a Secret</a></li><li><a href="#get_name">Get a Secret by Name</a></li><li><a href="#create-a-secret">Create a Secret</a></li><li><a href="#update-a-secret">Update a Secret</a></li><li><a href="#delete">Delete a Secret</a></li><li><a href="#related">Related Reference Material</a></li></ul><p></p><div class="note-callout">This API is currently in Beta. It supports only Get and Delete operations. For Create and Update operations, use the cURL commands given in this topic and update the parameters as needed. The <code>!</code> character at the end of a parameter&#39;s name indicates that it is a required parameter.</div><p></p><div class="hd--md" data-hd-markdown="&lt;span id=&#34;get_secret&#34;&gt;&lt;/span&gt;"><p><span id="get_secret"></span></p>
</div><h3>Get a Secret by ID</h3><p>This sample retrieves an existing file secret by its ID:</p><pre class="hljs apache">query{<br/>  secret(secretId:&#34;txZMBymoS5KLTF2vUs2p0Q&#34;,secretType:ENCRYPTED_FILE){<br/>	... on EncryptedFile{<br/>      name<br/>      secretManagerId<br/>      id<br/>       usageScope {<br/>        appEnvScopes {<br/>          application {<br/>            filterType<br/>            appId<br/>          }<br/>          environment {<br/>            filterType<br/>            envId<br/>          }<br/>        }<br/>      }<br/>      inheritScopesFromSM<br/>      scopedToAccount<br/>    }<br/>  }<br/>}</pre><p></p><div class="hd--md" data-hd-markdown="&lt;span id=&#34;get_name&#34;&gt;&lt;/span&gt;"><p><span id="get_name"></span></p>
</div><h3>Get a Secret by Name</h3><p>This sample uses a <code>secretByName</code> query to retrieve an existing file secret by its name:</p><pre class="hljs apache">query{<br/>  secretByName(name:&#34;000-azure-b22-&#34;,secretType:ENCRYPTED_FILE){<br/>	... on EncryptedFile{<br/>      name<br/>      secretManagerId<br/>      id<br/>       usageScope {<br/>        appEnvScopes {<br/>          application {<br/>            filterType<br/>            appId<br/>          }<br/>          environment {<br/>            filterType<br/>            envId<br/>          }<br/>        }<br/>      }<br/>      inheritScopesFromSM<br/>      scopedToAccount<br/>    }<br/>  }<br/>}</pre><p></p><h3>Create a Secret</h3><p>This sample creates a file secret.</p><div class="note-callout">The UI doesn&#39;t support file upload for Create and Update. To do this, use the below cURL commands. You must pass <strong>query</strong> and <strong>file</strong> as two form parameters as shown in the below samples.</div><h4>Usage Scope</h4><p>The required <code>CreateSecretInput</code> input must include a <code>SecretType</code>.</p><pre class="hljs apache">mutation ($secret: CreateSecretInput!) {<br/>  createSecret(input: $secret) {<br/>    secret {<br/>      id<br/>      name<br/>      ... on EncryptedFile {<br/>        name<br/>        secretManagerId<br/>        id<br/>      }<br/>      usageScope {<br/>        appEnvScopes {<br/>          application {<br/>            filterType<br/>            appId<br/>          }<br/>          environment {<br/>            filterType<br/>            envId<br/>          }<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</pre><h5>Query Variables</h5><p>For the above query, these sample variables specify the <code>SecretType</code>, and include an inline <code>name</code> value.</p><pre class="hljs apache">{<br/> &#34;secret&#34;: {<br/>   &#34;secretType&#34;: &#34;ENCRYPTED_FILE&#34;,<br/>   &#34;encryptedFile&#34;: {<br/>     &#34;name&#34;: &#34;sample-file-name&#34;,<br/>     &#34;value&#34;: &#34;000-azure-b22&#34;,<br/>     &#34;secretManagerId&#34;: &#34;abcdSmUISabcRrAB6NL73w&#34;,<br/>     &#34;usageScope&#34;: {<br/>       &#34;appEnvScopes&#34;: [{<br/>         &#34;application&#34;: {<br/>           &#34;filterType&#34;: &#34;ALL&#34;<br/>         },<br/>         &#34;environment&#34;: {<br/>           &#34;filterType&#34;: &#34;PRODUCTION_ENVIRONMENTS&#34;<br/>         }<br/>       }]<br/>     }<br/>   }<br/> }<br/>}</pre><h5>Sample cURL:</h5><pre>curl --location --request POST &#39;<a href="https://qa.harness.io/gateway/api/graphql?accountId=px7xd_BFRCi-pfWPYXVjvw" class="c-link" style="box-sizing:inherit;color:inherit;text-decoration:none" target="_blank">https://app.harness.io/gateway/api/graphql?accountId=</a>&lt;account-id&gt;&#39; \<br/>--header &#39;authorization: &lt;Bearer-token&gt;&#39; \<br/>--form &#39;file=@&#34;/Users/sampleusername/Downloads/examplefile&#34;&#39; \<br/>--form &#39;query=&#34;{<br/>   \&#34;query\&#34;:\&#34;  mutation($secret: CreateSecretInput!){    createSecret(input: $secret){      secret{        id,        name        ... on EncryptedFile{          name          secretManagerId          id        }        usageScope{          appEnvScopes{            application{              filterType              appId            }            environment{              filterType              envId            }          }        }      }    }  }  \&#34;,<br/>   \&#34;variables\&#34;:{<br/>      \&#34;secret\&#34;:{<br/>         \&#34;secretType\&#34;:\&#34;ENCRYPTED_FILE\&#34;,<br/>         \&#34;encryptedFile\&#34;:{<br/>            \&#34;name\&#34;:\&#34;fileSecretName\&#34;,<br/>            \&#34;usageScope\&#34;:{<br/>               \&#34;appEnvScopes\&#34;:[<br/>                  {<br/>                     \&#34;application\&#34;:{<br/>                        \&#34;filterType\&#34;:\&#34;ALL\&#34;<br/>                     },<br/>                     \&#34;environment\&#34;:{<br/>                        \&#34;filterType\&#34;:\&#34;PRODUCTION_ENVIRONMENTS\&#34;<br/>                     }<br/>                  }<br/>               ]<br/>            }<br/>         }<br/>      }<br/>   }<br/>}&#34;&#39;</pre><p></p><h4>Inherit Scope</h4><p>The required <code>CreateSecretInput</code> input must include a <code>SecretType</code>. </p><pre class="hljs apache">mutation ($secret: CreateSecretInput!) {<br/>  createSecret(input: $secret) {<br/>    secret {<br/>      id<br/>      name<br/>      ... on EncryptedFile {<br/>        name<br/>        secretManagerId<br/>        id<br/>        inheritScopesFromSM<br/>        scopedToAccount<br/>      }<br/>    }<br/>  }<br/>}</pre><h5>Query Variables</h5><p>For the above query, these sample variables specify the <code>SecretType</code>, and include an inline <code>name</code> value.</p><pre class="hljs apache">{<br/> &#34;secret&#34;: {<br/>   &#34;secretType&#34;: &#34;ENCRYPTED_FILE&#34;,<br/>   &#34;encryptedFile&#34;: {<br/>     &#34;name&#34;: &#34;file-name&#34;,<br/>     &#34;secretManagerId&#34;: &#34;abcdSmUISabcRrAB6NL73w&#34;,<br/>     &#34;scopedToAccount&#34;: false,<br/>     &#34;inheritScopesFromSM&#34;: true,<br/>     &#34;usageScope&#34;: null<br/>   }<br/> }<br/>}</pre><h5>Sample cURL:</h5><pre>curl --location --request POST &#39;<a href="https://qa.harness.io/gateway/api/graphql?accountId=px7xd_BFRCi-pfWPYXVjvw" class="c-link" style="box-sizing:inherit;color:inherit;text-decoration:none" target="_blank">https://app.harness.io/gateway/api/graphql?accountId=</a>&lt;account-id&gt;&#39; \<br/>--header &#39;authorization: &lt;Bearer-token&gt;&#39; \<br/>--form &#39;file=@&#34;/Users/sampleusername/Downloads/examplefile&#34;&#39; \<br/>--form &#39;query=&#34;{<br/>   \&#34;query\&#34;:\&#34;mutation($secret: CreateSecretInput!){    createSecret(input: $secret){      secret{        id,        name        ... on EncryptedFile{          name          secretManagerId          id          inheritScopesFromSM          scopedToAccount        }      }    }  }\&#34;,<br/>   \&#34;variables\&#34;:{<br/>      \&#34;secret\&#34;:{<br/>         \&#34;secretType\&#34;:\&#34;ENCRYPTED_FILE\&#34;,<br/>         \&#34;encryptedFile\&#34;:{<br/>            \&#34;name\&#34;:\&#34;fileSecretName\&#34;,<br/>            \&#34;scopedToAccount\&#34;:false,<br/>            \&#34;inheritScopesFromSM\&#34;:true,<br/>            \&#34;usageScope\&#34;:null<br/>         }<br/>      }<br/>   }<br/>}&#34;&#39;</pre><h3>Update a Secret</h3><p>This sample updates an existing secret.</p><h4>Usage Scope</h4><p>The required <code>UpdateSecretInput</code> input must supply an <code>id</code> and a <code>secretType</code>.</p><pre class="hljs apache">mutation ($secret: UpdateSecretInput!) {<br/>  updateSecret(input: $secret) {<br/>    secret {<br/>      id<br/>      name<br/>      ... on EncryptedFile {<br/>        name<br/>        secretManagerId<br/>        id<br/>      }<br/>      usageScope {<br/>        appEnvScopes {<br/>          application {<br/>            filterType<br/>            appId<br/>          }<br/>          environment {<br/>            filterType<br/>            envId<br/>          }<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</pre><h5>Query Variables</h5><p>For the above query, these sample variables specify the <code>SecretType</code>, and include an inline <code>name</code> value.</p><pre class="hljs apache">{<br/> &#34;secret&#34;: {<br/>   &#34;secretId&#34;: &#34;5ZeaabAaaSCS5gVJH9aabAaa&#34;,<br/>   &#34;secretType&#34;: &#34;ENCRYPTED_FILE&#34;,<br/>   &#34;encryptedFile&#34;: {<br/>     &#34;name&#34;: &#34;azure-secrets&#34;,<br/>     &#34;usageScope&#34;: {<br/>       &#34;appEnvScopes&#34;: [{<br/>         &#34;application&#34;: {<br/>           &#34;filterType&#34;: &#34;ALL&#34;<br/>         },<br/>         &#34;environment&#34;: {<br/>           &#34;filterType&#34;: &#34;PRODUCTION_ENVIRONMENTS&#34;<br/>         }<br/>       }]<br/>     }<br/>   }<br/> }<br/>}<br/></pre><h5>Sample cURL:</h5><pre>curl --location --request POST &#39;<a href="https://qa.harness.io/gateway/api/graphql?accountId=px7xd_BFRCi-pfWPYXVjvw" class="c-link" style="box-sizing:inherit;color:inherit;text-decoration:none" target="_blank">https://app.harness.io/gateway/api/graphql?accountId=</a>&lt;account-id&gt;&#39; \<br/>--header &#39;authorization: &lt;Bearer-token&gt;&#39; \<br/>--form &#39;file=@&#34;/Users/sampleusername/Downloads/examplefile&#34;&#39; \<br/>--form &#39;query=&#34;<br/>{<br/>    \&#34;query\&#34;: \&#34;  mutation($secret: UpdateSecretInput!){    updateSecret(input: $secret){      secret{        id,        name        ... on EncryptedFile{          name          secretManagerId          id        }        usageScope{          appEnvScopes{            application{              filterType              appId            }            environment{              filterType              envId            }          }        }      }    }  }  \&#34;,<br/>    \&#34;variables\&#34;: {<br/>        \&#34;secret\&#34;: {<br/>            \&#34;secretType\&#34;: \&#34;ENCRYPTED_FILE\&#34;,<br/>\&#34;secretId\&#34;: \&#34;NL-OhB47Qn-7jiL9u1CZiQ\&#34;,<br/>            \&#34;encryptedFile\&#34;: {<br/>                \&#34;name\&#34;: \&#34;fileSecretName\&#34;,<br/>                <br/>                \&#34;usageScope\&#34;: {<br/>                    \&#34;appEnvScopes\&#34;: [<br/>                        {<br/>                            \&#34;application\&#34;: {<br/>                                \&#34;filterType\&#34;: \&#34;ALL\&#34;<br/>                            },<br/>                            \&#34;environment\&#34;: {<br/>                                \&#34;filterType\&#34;: \&#34;PRODUCTION_ENVIRONMENTS\&#34;<br/>                            }<br/>                        }<br/>                    ]<br/>                }<br/>            }<br/>        }<br/>    }<br/>}&#34;&#39;<br/></pre><h4>Inherit Scope</h4><p>The required <code>UpdateSecretInput</code> input must supply an <code>id</code> and a <code>secretType</code>.</p><pre class="hljs apache">mutation ($secret: UpdateSecretInput!) {<br/>  updateSecret(input: $secret) {<br/>    secret {<br/>      id<br/>      name<br/>      ... on EncryptedFile {<br/>        name<br/>        secretManagerId<br/>        id<br/>        inheritScopesFromSM<br/>        scopedToAccount<br/>      }<br/>    }<br/>  }<br/>}<br/></pre><h5>Query Variables</h5><pre class="hljs apache">{<br/> &#34;secret&#34;: {<br/>   &#34;secretId&#34;: &#34;5ZeaabAaaSCS5gVJH9aabAaa&#34;,<br/>   &#34;secretType&#34;: &#34;ENCRYPTED_FILE&#34;,<br/>   &#34;encryptedFile&#34;: {<br/>     &#34;name&#34;: &#34;azure-secrets&#34;,<br/>     &#34;scopedToAccount&#34;: false,<br/>     &#34;inheritScopesFromSM&#34;: true,<br/>     &#34;usageScope&#34;: null<br/>   }<br/> }<br/>}<br/></pre><p></p><h5>Sample cURL:</h5><pre>curl --location --request POST &#39;<a href="https://qa.harness.io/gateway/api/graphql?accountId=px7xd_BFRCi-pfWPYXVjvw" class="c-link" style="box-sizing:inherit;color:inherit;text-decoration:none" target="_blank">https://app.harness.io/gateway/api/graphql?accountId=</a>&lt;account-id&gt;&#39; \<br/>--header &#39;authorization: &lt;Bearer-token&gt;&#39; \<br/>--form &#39;file=@&#34;/Users/shashanksingh/Downloads/hello&#34;&#39; \<br/>--form &#39;query=&#34;{<br/>   \&#34;query\&#34;:\&#34;mutation($secret: UpdateSecretInput!){    updateSecret(input: $secret){      secret{        id,        name        ... on EncryptedFile{          name          secretManagerId          id          inheritScopesFromSM          scopedToAccount        }      }    }  }\&#34;,<br/>   \&#34;variables\&#34;:{<br/>      \&#34;secret\&#34;:{<br/>         \&#34;secretType\&#34;:\&#34;ENCRYPTED_FILE\&#34;,<br/>         \&#34;secretId\&#34;:\&#34;tsOCZjLJRzembSBofpnVsA\&#34;,<br/>         \&#34;encryptedFile\&#34;:{<br/>            \&#34;name\&#34;:\&#34;fileSecretName\&#34;,<br/>            \&#34;scopedToAccount\&#34;:false,<br/>            \&#34;inheritScopesFromSM\&#34;:true,<br/>            \&#34;usageScope\&#34;:null<br/>         }<br/>      }<br/>   }<br/>}&#34;&#39;</pre><p></p><p></p><div class="hd--md" data-hd-markdown="&lt;span id=&#34;delete&#34;&gt;&lt;/span&gt;"><p><span id="delete"></span></p>
</div><h3>Delete a Secret</h3><p>This sample deletes a specified secret. The required <code>DeleteSecretInput</code> input must supply a <code>secretId</code> and a <code>secretType</code>.</p><pre class="hljs apache">mutation($secret: DeleteSecretInput!){<br/>  deleteSecret(input: $secret){<br/>    clientMutationId<br/>  }<br/>}</pre><h4>Query Variables</h4><p>Here are query variables for the above <code>deleteSecret</code> operation.</p><pre class="hljs apache">{<br/>  &#34;secret&#34;: {<br/>    &#34;secretId&#34;: &#34;Cu8ran5nSqOhxvlcfF2V6A&#34;,<br/>    &#34;secretType&#34;: &#34;ENCRYPTED_FILE&#34;<br/>  }<br/>}</pre><p></p><div class="hd--md" data-hd-markdown="&lt;span id=&#34;related&#34;&gt;&lt;/span&gt;"><p><span id="related"></span></p>
</div><h3>Related Reference Material</h3><ul><li><a href="/article/tm0w6rruqv-harness-api">Harness API</a></li><li><a href="/article/omnfccj1n0-api-encrypted-text">Encrypted Text API</a></li><li><a href="/article/v65okfwfl2-api-ssh-credentials">SSH Credentials API</a></li><li><a href="/article/2rlo5zw321-api-win-rm-credentials">WinRM Credentials API</a></li></ul><p></p>