<p>This topic describes how to trigger a Workflow or a Pipeline using Harness GraphQL APIs.</p><p>In this topic:</p><ul><li><a href="https://docs.harness.io/article/s3leksekny-trigger-workflow-or-a-pipeline-using-api#before_you_begin">Before You Begin</a></li><li><a href="https://docs.harness.io/article/s3leksekny-trigger-workflow-or-a-pipeline-using-api#step_1_fetch_the_application_id">Step 1: Fetch the Application ID</a></li><li><a href="https://docs.harness.io/article/s3leksekny-trigger-workflow-or-a-pipeline-using-api#step_2_fetch_the_workflow_or_pipeline_id">Step 2: Fetch the Workflow or Pipeline ID</a></li><li><a href="https://docs.harness.io/article/s3leksekny-trigger-workflow-or-a-pipeline-using-api#step_3_fetch_the_execution_input">Step 3: Fetch the Execution Input</a></li><li><a href="https://docs.harness.io/article/s3leksekny-trigger-workflow-or-a-pipeline-using-api#step_4_start_the_execution">Step 4: Start the Execution</a></li></ul><div class="note-callout">You can also deploy Workflow to multiple infrastructures simultaneously. See <a href="/article/bc65k2imoi-deploy-to-multiple-infrastructures">Deploy Multiple Services Simultaneously using Barriers</a>.</div><h3>Before You Begin</h3><ul><li><a href="/article/tm0w6rruqv-harness-api">​Introduction to Harness GraphQL API</a></li><li><a href="/article/2rmd5i0e0h-harness-api-explorer">Harness API Explorer</a></li></ul><h3>Step 1: Fetch the Application ID</h3><div class="note-callout">Ensure that you provide details of the correct Environment, for example, Prod, QA, or dev.</div><p></p><p>This sample returns Application <code>ID</code>. You can use either ID or name. In this sample, <code>name</code> is used.</p><h5>Request</h5><pre class="hljs graphql">{<br/>  applicationByName(name: &#34;Test App&#34;) {<br/>    id<br/>    name<br/>  }<br/>}</pre><h5>Response</h5><pre class="hljs graphql">{<br/>  &#34;data&#34;: {<br/>    &#34;applicationByName&#34;: {<br/>      &#34;id&#34;: &#34;naNJDKrUTZKKdKycL5Tx4g&#34;,<br/>      &#34;name&#34;: &#34;Test App&#34;<br/>    }<br/>  }<br/>}</pre><h3>Step 2: Fetch the Workflow or Pipeline ID</h3><p>This sample returns Workflow <code>ID</code> and <code>variables</code>. These details are needed to start the execution.</p><div class="note-callout">You can also trigger Pipeline using the same API, but use <code>pipelineByName</code> API to fetch the Pipeline ID and Pipeline Variables.</div><h5>Request</h5><pre class="hljs graphql">{<br/>  workflowByName(applicationId: &#34;naNJDKrUTZKKdKycL5Tx4g&#34;, workflowName: &#34;multi service graphql test&#34;) {<br/>    id<br/>    name<br/>    workflowVariables {<br/>      name<br/>      type<br/>      required<br/>    }<br/>  }<br/>}<br/></pre><h5>Response</h5><pre class="hljs graphql">{<br/>  &#34;data&#34;: {<br/>    &#34;workflowByName&#34;: {<br/>      &#34;id&#34;: &#34;bhI2FyPrTpupdzL4QEk0_A&#34;,<br/>      &#34;name&#34;: &#34;multi service graphql test&#34;,<br/>      &#34;workflowVariables&#34;: [<br/>        {<br/>          &#34;name&#34;: &#34;Environment&#34;,<br/>          &#34;type&#34;: &#34;Environment&#34;,<br/>          &#34;required&#34;: true<br/>        },<br/>        {<br/>          &#34;name&#34;: &#34;InfraDefinition_Kubernetes&#34;,<br/>          &#34;type&#34;: &#34;Infrastructure definition&#34;,<br/>          &#34;required&#34;: true<br/>        },<br/>        {<br/>          &#34;name&#34;: &#34;InfraDefinition_Kubernetes2&#34;,<br/>          &#34;type&#34;: &#34;Infrastructure definition&#34;,<br/>          &#34;required&#34;: true<br/>        }<br/>      ]<br/>    }<br/>  }<br/>}</pre><h3>Step 3: Fetch the Execution Input</h3><div class="note-callout">Currently, only Services need Artifacts inputs to start Workflow or Pipeline execution.</div><p>This sample returns <code>Services</code>that require artifacts to trigger your Workflow.</p><h5>Request</h5><pre class="hljs graphql">query {<br/>  executionInputs(applicationId: &#34;naNJDKrUTZKKdKycL5Tx4g&#34;<br/>    entityId: &#34;bhI2FyPrTpupdzL4QEk0_A&#34;<br/>  executionType: WORKFLOW,<br/>  variableInputs: [<br/>    {<br/>      name: &#34;Environment&#34;<br/>      variableValue: {<br/>        type: NAME<br/>        value: &#34;Prod&#34;<br/>      }<br/>    },<br/>    {<br/>      name: &#34;InfraDefinition_Kubernetes&#34;<br/>      variableValue: {<br/>        type: NAME<br/>        value: &#34;k8s&#34;<br/>      }<br/>    },<br/>    {<br/>      name: &#34;InfraDefinition_Kubernetes2&#34;<br/>      variableValue: {<br/>        type: NAME<br/>        value: &#34;k8s&#34;<br/>      }<br/>    }<br/>  ]){<br/>    serviceInputs{<br/>      id<br/>      name<br/>      artifactType<br/>    }<br/>  }<br/>}<br/></pre><h5>Response</h5><pre class="hljs graphql">{<br/>  &#34;data&#34;: {<br/>    &#34;executionInputs&#34;: {<br/>      &#34;serviceInputs&#34;: [<br/>        {<br/>          &#34;id&#34;: &#34;XceFDCA7QgirrO8LJRphZQ&#34;,<br/>          &#34;name&#34;: &#34;test&#34;,<br/>          &#34;artifactType&#34;: &#34;DOCKER&#34;<br/>        },<br/>        {<br/>          &#34;id&#34;: &#34;kqf9rA1dQ4SluU54K-ouOw&#34;,<br/>          &#34;name&#34;: &#34;k8s&#34;,<br/>          &#34;artifactType&#34;: &#34;DOCKER&#34;<br/>        }<br/>      ]<br/>    }<br/>  }<br/>}</pre><h3>Step 4: Start the Execution</h3><p>This sample shows how to start executing your Workflow.</p><p>The values for <code>serviceInputs</code> can be found using the response in <a href="#step_3_fetch_execution_input">Step 3: Fetch Execution Input</a> and the steps in <a href="/article/0z2b5a1x4x-artifact-source-api">Fetch Artifact Source Details Using GraphQL APIs</a>.</p><p>You can also see them in the Harness Manager Service using <a href="/article/eb3kfl8uls-service-configuration#manually_select_an_artifact">Manually Select an Artifact</a>.</p><h5>Request</h5><pre class="hljs graphql">mutation {<br/>  startExecution(input: {<br/>    applicationId: &#34;naNJDKrUTZKKdKycL5Tx4g&#34;<br/>    entityId: &#34;bhI2FyPrTpupdzL4QEk0_A&#34;<br/>    executionType: WORKFLOW,<br/>    variableInputs: [<br/>    {<br/>      name: &#34;Environment&#34;<br/>      variableValue: {<br/>        type: NAME<br/>        value: &#34;Prod&#34;<br/>      }<br/>    },<br/>    {<br/>      name: &#34;InfraDefinition_Kubernetes&#34;<br/>      variableValue: {<br/>        type: NAME<br/>        value: &#34;k8s&#34;<br/>      }<br/>    },<br/>    {<br/>      name: &#34;InfraDefinition_Kubernetes2&#34;<br/>      variableValue: {<br/>        type: NAME<br/>        value: &#34;k8s&#34;<br/>      }<br/>    }<br/>    ], <br/>    serviceInputs: [ {<br/>      name: &#34;test&#34;, <br/>      artifactValueInput: {<br/>        valueType: BUILD_NUMBER<br/>        buildNumber: {<br/>          buildNumber: &#34;stable-perl&#34;<br/>          artifactSourceName: &#34;library_nginx&#34;<br/>        }<br/>      }<br/>    },<br/>      {<br/>      name: &#34;k8s&#34;, <br/>      artifactValueInput: {<br/>        valueType: BUILD_NUMBER<br/>        buildNumber: {<br/>          buildNumber: &#34;latest&#34;<br/>          artifactSourceName: &#34;docker_hello-world&#34;<br/>        }<br/>      }<br/>    }<br/>    ]<br/>  }<br/>  ){<br/>    clientMutationId<br/>    execution{<br/>      id<br/>      status<br/>    }<br/>  }<br/>}</pre><h5><strong>Response</strong></h5><pre class="hljs graphql">{<br/>  &#34;data&#34;: {<br/>    &#34;startExecution&#34;: {<br/>      &#34;clientMutationId&#34;: null,<br/>      &#34;execution&#34;: {<br/>        &#34;id&#34;: &#34;s7QEfVP7SL-3ZUt8FBrnzQ&#34;,<br/>        &#34;status&#34;: &#34;RUNNING&#34;<br/>      }<br/>    }<br/>  }<br/>}</pre><p></p><h3>Notes</h3><p>If you use the <a href="/article/obqhjaabnl">Artifact Collection</a> step in a Build Workflow and template the <strong>Artifact Source</strong> setting by clicking the <strong>[T]</strong> button, you create a <a href="/article/766iheu1bk-add-workflow-variables-new-template">Workflow variable</a>. When you deploy the Workflow, you can provide a value for the variable. </p><p>By default, the name of the Workflow variable is <code>ArtifactStream</code>:</p><pre class="hljs graphql">...<br/>variableInputs: [<br/>    {<br/>      name: &#34;ArtifactStream&#34;<br/>      variableValue: {<br/>        type: NAME<br/>        value: &#34;library_nginx&#34;<br/>      }<br/>    },<br/>...</pre><p></p><p></p>