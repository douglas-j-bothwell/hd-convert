<p></p><p>This topic lists sample queries for CRUD operations that create, read, update, and delete <a href="/article/au38zpufhr-secret-management">Harness secrets</a> and <a href="/article/ejaddm3ddb">Custom Secrets</a>, that rely on encrypted text.</p><div class="note-callout">The <code>!</code> following the type means that this field is <em>required</em>.</div><p>In this topic:</p><ul><li><a href="https://docs.harness.io/article/omnfccj1n0-api-encrypted-text#before_you_begin">Before You Begin</a></li><li><a href="https://docs.harness.io/article/omnfccj1n0-api-encrypted-text#get_a_secret">Get a Secret</a></li><li><a href="https://docs.harness.io/article/omnfccj1n0-api-encrypted-text#get_a_secret_by_name">Get a Secret by Name</a></li><li><a href="https://docs.harness.io/article/omnfccj1n0-api-encrypted-text#get_secrets_manager_i_ds">Get Secrets Manager IDs</a></li><li><a href="https://docs.harness.io/article/omnfccj1n0-api-encrypted-text#create_an_encrypted_text_secret">Create an Encrypted Text Secret</a></li><li><a href="https://docs.harness.io/article/omnfccj1n0-api-encrypted-text#update_a_secret">Update a Secret</a></li><li><a href="https://docs.harness.io/article/omnfccj1n0-api-encrypted-text#delete_a_secret">Delete a Secret</a></li><li><a href="https://docs.harness.io/article/omnfccj1n0-api-encrypted-text#related_topics">Related Topics</a></li></ul><h3>Before You Begin</h3><ul><li><a href="/article/tm0w6rruqv-harness-api">​Introduction to Harness GraphQL API</a></li><li><a href="/article/2rmd5i0e0h-harness-api-explorer">Harness API Explorer</a></li><li><a href="/article/e4ikpd00f6-scope-secret-managers-to-applications-and-environments">Scope Secret Managers to Applications and Environments</a></li><li><a href="/article/e5q9qcho4y-restrict-secrets-usage">Restrict Secrets Usage</a></li></ul><h3>Get a Secret by ID</h3><p>This sample retrieves an existing encrypted-text secret by its ID.</p><pre class="hljs apache">query{<br/>  secret(secretId: &#34;abCDEF6jQO6tQnB9xxYxxx&#34;, secretType: ENCRYPTED_TEXT) {<br/>    ... on EncryptedText {<br/>      id<br/>      name<br/>      secretManagerId<br/>      usageScope {<br/>        appEnvScopes {<br/>          application {<br/>            filterType<br/>            appId<br/>          }<br/>          environment {<br/>            filterType<br/>            envId<br/>          }<br/>        }<br/>      }<br/>      inheritScopesFromSM<br/>      scopedToAccount<br/>    }<br/>  }<br/>}</pre><h3>Get a Secret by Name</h3><p>This sample uses a <code>secretByName</code> query to retrieve an existing secret by its name.</p><pre class="hljs apache">query{<br/>  secretByName(name:&#34;anz-csr-reader&#34;,secretType:ENCRYPTED_TEXT){<br/>... on EncryptedText{<br/>      id<br/>      name<br/>      secretManagerId<br/>    }<br/> }<br/>}</pre><p></p><p>This second sample adds elements to also retrieve the secret&#39;s Application and Environment scope.</p><pre class="hljs apache">query{<br/>  secretByName(name: &#34;awstest5_AWS_secretKey&#34;, secretType: ENCRYPTED_TEXT) {<br/>    ... on EncryptedText {<br/>      id<br/>      name<br/>      secretManagerId<br/>      usageScope {<br/>        appEnvScopes {<br/>          application {<br/>            filterType<br/>            appId<br/>          }<br/>          environment {<br/>            filterType<br/>            envId<br/>          }<br/>        }<br/>      }<br/>      inheritScopesFromSM<br/>      scopedToAccount<br/>    }<br/>  }<br/>}</pre><h3>Get Secrets Manager IDs</h3><p>To <a href="#create">create</a> a secret, you need the secrets manager&#39;s Harness ID (<code>secretManagerId</code>). This sample retrieves 10 secrets managers&#39; IDs and names.</p><pre class="hljs apache">query{<br/>  secretManagers(limit: 10, offset: 2) {<br/>    nodes {<br/>      id<br/>      name<br/>      usageScope {<br/>        appEnvScopes {<br/>          application {<br/>            filterType<br/>            appId<br/>          }<br/>          environment {<br/>            filterType<br/>            envId<br/>          }<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</pre><p></p><p>This sample uses a <code>secretManagerByName</code> query to retrieve the <code>secretManagerId</code> of a secret manager whose name you know.</p><pre class="hljs apache">query{<br/>  secretManagerByName(name: &#34;Vault_App_Role&#34;){<br/>    id<br/>    name<br/>    usageScope {<br/>      appEnvScopes {<br/>        application {<br/>          filterType<br/>          appId<br/>        }<br/>        environment {<br/>          filterType<br/>          envId<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</pre><p></p><p>This sample retrieves the name of a secrets manager whose ID you know.</p><pre class="hljs apache">query{<br/>  secretManager(secretManagerId: &#34;abABc1qABC2VrFHqZ3E-Aa&#34;) {<br/>    id<br/>    name<br/>    usageScope {<br/>      appEnvScopes {<br/>        application {<br/>          filterType<br/>          appId<br/>        }<br/>        environment {<br/>          filterType<br/>          envId<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</pre><h3>Create an Encrypted Text Secret</h3><p>This sample creates a secret.</p><h4>Usage Scope</h4><p> The required <code>CreateSecretInput</code> input must include a <code>SecretType</code>.</p><pre class="hljs apache">mutation($secret: CreateSecretInput!){<br/>  createSecret(input: $secret){<br/>    secret{<br/>      id,<br/>      name<br/>      ... on EncryptedText{<br/>        name<br/>        secretManagerId<br/>        id<br/>      }<br/>      usageScope{<br/>        appEnvScopes{<br/>          application{<br/>            filterType<br/>            appId<br/>          }<br/>          environment{<br/>            filterType<br/>            envId<br/>          }<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</pre><h5>Query Variables: Inline Value</h5><p> For the above query, these sample variables specify the <code>SecretType</code>, and include an inline <code>name</code> value.</p><pre class="hljs json">{<br/>  &#34;secret&#34;: {<br/>    &#34;secretType&#34;: &#34;ENCRYPTED_TEXT&#34;,<br/>    &#34;encryptedText&#34;: {<br/>      &#34;name&#34;: &#34;azure-secrets&#34;,<br/>      &#34;value&#34;: &#34;000-azure-b22&#34;,<br/>      &#34;secretManagerId&#34;: &#34;abcdSmUISabcRrAB6NL73w&#34;,<br/>      &#34;usageScope&#34;: {<br/>        &#34;appEnvScopes&#34;: [{<br/>          &#34;application&#34;: {<br/>            &#34;filterType&#34;: &#34;ALL&#34;<br/>          },<br/>          &#34;environment&#34;: {<br/>            &#34;filterType&#34;: &#34;PRODUCTION_ENVIRONMENTS&#34;<br/>          }<br/>        }]<br/>      }<br/>    }<br/>  }<br/>}</pre><h5>Query Variables: Reference</h5><p>These sample variables specify the <code>SecretType</code>, but provide the <code>name</code> value by reference.</p><pre class="hljs apache">{<br/>  &#34;secret&#34;: {<br/>    &#34;secretType&#34;: &#34;ENCRYPTED_TEXT&#34;,<br/>    &#34;encryptedText&#34;: {<br/>      &#34;name&#34;: &#34;azure-secret-reference&#34;,<br/>      &#34;secretReference&#34;:  &#34;000-azure-b22&#34;,<br/>      &#34;secretManagerId&#34;: &#34;abcdSmUISabcRrAB6NL73w&#34;,<br/>      &#34;scopedToAccount&#34;: false,<br/>      &#34;inheritScopesFromSM&#34;: true,<br/>      &#34;usageScope&#34;: {<br/>        &#34;appEnvScopes&#34;: [{<br/>          &#34;application&#34;: {<br/>            &#34;filterType&#34;: &#34;ALL&#34;<br/>          },<br/>          &#34;environment&#34;: {<br/>            &#34;filterType&#34;: &#34;NON_PRODUCTION_ENVIRONMENTS&#34;<br/>          }<br/>        }]<br/>      }<br/>    }<br/>  }<br/>}</pre><h4>Inherit Scope</h4><p>The required <code>CreateSecretInput</code> input must include a <code>SecretType</code>. </p><pre class="hljs apache">mutation($secret: CreateSecretInput!){<br/>  createSecret(input: $secret){<br/>    secret{<br/>      id,<br/>      name<br/>      ... on EncryptedText{<br/>        name<br/>        secretManagerId<br/>        id<br/>        inheritScopesFromSM<br/>        scopedToAccount<br/>      }<br/>    }<br/>  }<br/>}</pre><h5>Query Variables: Inline Value</h5><p>For the above query, these sample variables specify the <code>SecretType</code>, and include an inline <code>name</code> value.</p><pre>{<br/>  &#34;secret&#34;: {<br/>    &#34;secretType&#34;: &#34;ENCRYPTED_TEXT&#34;,<br/>    &#34;encryptedText&#34;: {<br/>      &#34;name&#34;: &#34;azure-secrets&#34;,<br/>      &#34;value&#34;: &#34;000-azure-b22&#34;,<br/>      &#34;secretManagerId&#34;: &#34;abcdSmUISabcRrAB6NL73w&#34;,<br/>      &#34;scopedToAccount&#34;: false,<br/>      &#34;inheritScopesFromSM&#34;: true,<br/>      &#34;usageScope&#34;: null<br/>    }<br/>  }<br/>}</pre><h5>Query Variables: Reference</h5><p>These sample variables specify the <code>SecretType</code>, but provide the <code>name</code> value by reference.</p><pre class="hljs apache">{<br/>  &#34;secret&#34;: {<br/>    &#34;secretType&#34;: &#34;ENCRYPTED_TEXT&#34;,<br/>    &#34;encryptedText&#34;: {<br/>      &#34;name&#34;: &#34;azure-secret-reference&#34;,<br/>      &#34;secretReference&#34;:  &#34;000-azure-b22&#34;,<br/>      &#34;secretManagerId&#34;: &#34;abcdSmUISabcRrAB6NL73w&#34;,<br/>      &#34;scopedToAccount&#34;: true,<br/>      &#34;inheritScopesFromSM&#34;: false,<br/>      &#34;usageScope&#34;: null<br/>    }<br/>  }<br/>}</pre><h3>Update a Secret</h3><p>This sample updates an existing secret.</p><h4>Usage Scope</h4><p>The required <code>UpdateSecretInput</code> input must supply an <code>id</code> and a <code>secretType</code>.</p><pre class="hljs apache">mutation($secret: UpdateSecretInput!){<br/>  updateSecret(input: $secret){<br/>    secret{<br/>      id,<br/>      name<br/>      ... on EncryptedText{<br/>        name<br/>        secretManagerId<br/>        id<br/>      }<br/>      usageScope{<br/>        appEnvScopes{<br/>          application{<br/>            filterType<br/>            appId<br/>          }<br/>          environment{<br/>            filterType<br/>            envId<br/>          }<br/>        }<br/>      }<br/>    }<br/>  }<br/>}</pre><h5>Query Variables: Inline Value</h5><pre class="hljs json">{<br/>  &#34;secret&#34;: {<br/>    &#34;secretId&#34;: &#34;5ZeaabAaaSCS5gVJH9aabAaa&#34;,<br/>    &#34;secretType&#34;: &#34;ENCRYPTED_TEXT&#34;,<br/>    &#34;encryptedText&#34;: {<br/>      &#34;name&#34;: &#34;azure-secrets&#34;,<br/>      &#34;value&#34;: &#34;000-azure-b22&#34;,<br/>      &#34;usageScope&#34;: {<br/>        &#34;appEnvScopes&#34;: [{<br/>          &#34;application&#34;: {<br/>            &#34;filterType&#34;: &#34;ALL&#34;<br/>          },<br/>          &#34;environment&#34;: {<br/>            &#34;filterType&#34;: &#34;PRODUCTION_ENVIRONMENTS&#34;<br/>          }<br/>        }]<br/>      }<br/>    }<br/>  }<br/>}</pre><h5>Query Variables: Reference</h5><pre class="hljs json">{<br/>  &#34;secret&#34;: {<br/>    &#34;secretId&#34;: &#34;5ZeaabAaaSCS5gVJH9aabAaa&#34;,<br/>    &#34;secretType&#34;: &#34;ENCRYPTED_TEXT&#34;,<br/>    &#34;encryptedText&#34;: {<br/>      &#34;name&#34;: &#34;azure-secret-update&#34;,<br/>      &#34;secretReference&#34;: &#34;000-azure-b22&#34;,<br/>      &#34;usageScope&#34;: {<br/>        &#34;appEnvScopes&#34;: [{<br/>          &#34;application&#34;: {<br/>            &#34;filterType&#34;: &#34;ALL&#34;<br/>          },<br/>          &#34;environment&#34;: {<br/>            &#34;filterType&#34;: &#34;PRODUCTION_ENVIRONMENTS&#34;<br/>          }<br/>        }]<br/>      }<br/>    }<br/>  }<br/>}</pre><h4>Inherit Scope</h4><p>The required <code>UpdateSecretInput</code> input must supply an <code>id</code> and a <code>secretType</code>.</p><pre class="hljs apache">mutation($secret: UpdateSecretInput!){<br/>  updateSecret(input: $secret){<br/>    secret{<br/>      id,<br/>      name<br/>      ... on EncryptedText{<br/>        name<br/>        secretManagerId<br/>        id<br/>        inheritScopesFromSM<br/>        scopedToAccount<br/>      }<br/>    }<br/>  }<br/>}</pre><p></p><h5>Query Variables: Inline Value</h5><pre>{<br/>  &#34;secret&#34;: {<br/>    &#34;secretId&#34;: &#34;5ZeaabAaaSCS5gVJH9aabAaa&#34;,<br/>    &#34;secretType&#34;: &#34;ENCRYPTED_TEXT&#34;,<br/>    &#34;encryptedText&#34;: {<br/>      &#34;name&#34;: &#34;azure-secrets&#34;,<br/>      &#34;value&#34;: &#34;000-azure-b22&#34;,<br/>      &#34;scopedToAccount&#34;: false,<br/>      &#34;inheritScopesFromSM&#34;: true,<br/>      &#34;usageScope&#34;: null<br/>    }<br/>  }<br/>}</pre><h5>Query Variables: Reference</h5><pre>{<br/>  &#34;secret&#34;: {<br/>    &#34;secretId&#34;: &#34;5ZeaabAaaSCS5gVJH9aabAaa&#34;,<br/>    &#34;secretType&#34;: &#34;ENCRYPTED_TEXT&#34;,<br/>    &#34;encryptedText&#34;: {<br/>      &#34;name&#34;: &#34;azure-secret-update&#34;,<br/>      &#34;secretReference&#34;: &#34;000-azure-b22&#34;,<br/>      &#34;scopedToAccount&#34;: true,<br/>      &#34;inheritScopesFromSM&#34;: false,<br/>      &#34;usageScope&#34;: null<br/>    }<br/>  }<br/>}</pre><h3>Delete a Secret</h3><p>This sample deletes a specified secret. The required <code>DeleteSecretInput</code> input must supply a <code>secretId</code> and a <code>secretType</code>.</p><pre class="hljs apache">mutation($secret: DeleteSecretInput!){<br/>  deleteSecret(input: $secret)<br/>}</pre><h4>Query Variables</h4><p>Here are query variables for the above <code>deleteSecret</code> operation.</p><pre class="hljs apache">{<br/>  &#34;secret&#34;: {<br/>    &#34;secretId&#34;: &#34;cHP3nO_fTt2pWhjzu_lABc&#34;,<br/>    &#34;secretType&#34;: &#34;ENCRYPTED_TEXT&#34;<br/>  }<br/>}</pre><h3>Related Topics</h3><ul><li><a href="/article/tm0w6rruqv-harness-api">Harness API</a></li><li><a href="/article/jvhzdi1ztj-api-encrypted-files">Encrypted Files API</a></li><li><a href="/article/v65okfwfl2-api-ssh-credentials">SSH Credentials API</a></li><li><a href="/article/2rlo5zw321-api-win-rm-credentials">WinRM Credentials API</a></li></ul><p></p>