<p>Harness includes JSON and XML functors you can use to select contents from JSON and XML sources. These functors reduce the amount of shell scripting needed to pull JSON and XML information into your Harness Workflow steps.</p><h3>JSON Functor</h3><p>The JSON functor uses the JSON library <a href="https://github.com/json-path/JsonPath" target="_blank">JsonPath</a>. The JSON functor methods are described below.</p><h4>jsonpath()</h4><ul><li><strong>Syntax:</strong> <code>${jsonpath(&#39;string.string&#39;)}</code></li><li><strong>Description:</strong> Select attribute values in a path.</li><li><strong>Parameters:</strong> literal string, string. For example, <code>${jsonpath(&#39;health.status&#39;)}</code>.</li></ul><p><strong>Example:</strong></p><p>Here is the JSON we will query:</p><pre>{<br/>  &#34;books&#34;: [{<br/>      &#34;isbn&#34;: &#34;9781593275846&#34;,<br/>      &#34;title&#34;: &#34;Eloquent JavaScript, Second Edition&#34;,<br/>      &#34;subtitle&#34;: &#34;A Modern Introduction to Programming&#34;,<br/>      &#34;author&#34;: &#34;Marijn Haverbeke&#34;,<br/>      &#34;published&#34;: &#34;2014-12-14T00:00:00.000Z&#34;,<br/>      &#34;publisher&#34;: &#34;No Starch Press&#34;,<br/>      &#34;pages&#34;: &#34;472&#34;,<br/>      &#34;description&#34;: &#34;JavaScript lies at the heart of almost every modern web application, from social apps to the newest browser-based games. Though simple for beginners to pick up and play with, JavaScript is a flexible, complex language that you can use to build full-scale applications.&#34;<br/>    },<br/>...<br/>}</pre><p></p><p>We&#39;ll use the the expression <code>${jsonpath(&#39;books[0].isbn&#39;)} == &#34;9781593275846&#34;</code> to compare the <code>jsonpath(&#39;books[0].isbn&#39;)</code> value with <code>9781593275846</code>.</p><p>Here is the HTTP step configured to compare in the <strong>Assertion</strong> setting:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1569980301580/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Here is the Harness deployment result with the successful comparison:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1569980490657/image.png"/></figure><h4>select()</h4><ul><li><strong>Syntax:</strong> <code>select(string, string)</code></li><li><strong>Description:</strong> Select attribute values using a path.</li><li><strong>Parameters:</strong> literal string, string (typically, the second string is <code>httpResponseBody</code>). This is a path to identify the desired JSON attribute value from a JSON response.</li></ul><p><strong>Example:</strong></p><p>Here is the JSON array that we want to select a value from:</p><pre>{<br/>  &#34;data&#34;: {<br/>    &#34;attributes&#34;: {<br/>      &#34;name&#34;: &#34;new-construction-api&#34;,<br/>      &#34;version_pins&#34;: {<br/>        &#34;mvn-service://new-construction-api&#34;: &#34;0.0.253-feature_NC-6595.8d268cd~nc1.6312a66&#34;<br/>      }<br/>    }<br/>  }<br/>}</pre><p>To select the value <code>0.0.253-feature_NC-6595.8d268cd~nc1.6312a66</code>, you would use <code>select()</code> to specify the path to the value, like this:</p><pre>${json.select(&#34;data.attributes.version_pins.mvn-service://new-construction-api&#34;, httpResponseBody)}</pre><p>The <code>httpResponseBody</code> argument is used to indicate that we want to select the path <em>within</em> the HTTP response body. <code>httpResponseBody</code> is propagated from the HTTP request.</p><p>A common use of <code>select()</code> is in an HTTP command in a Workflow. For example, the following HTTP command uses a variable named <strong>FIELD</strong> in <strong>Name</strong> and the <code>select()</code> method in <strong>Expression</strong> to obtain the value <code>0.0.253-feature_NC-6595.8d268cd~nc1.6312a66</code> from the HTTP response payload at the URL specified in <strong>URL</strong>.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/wfvecw3yod/1558742272307/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>The value returned by the expression is stored in the variable <strong>FIELD</strong>.</p><p>In <strong>Publish Variable Name</strong>, the variable <strong>VARS</strong> is used to store the value of <strong>FIELD</strong> (the value obtained by the expression). The value for <strong>FIELD</strong> can now be referenced elsewhere in the Workflow using <code>${VARS.FIELD}</code>.</p><p>When this HTTP command is deployed, <strong>Deployments</strong> will display the HTTP response:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/wfvecw3yod/1558743011008/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>If you echo the <code>${VARS.FIELD}</code> output variable in a successive Shell Script command, you will get the output of the <code>select()</code> expression stored in <code>FIELD</code>:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/wfvecw3yod/1558743166406/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><h5>Conditional Expressions with Select</h5><p>Using JSON PATH syntax, you can perform conditional expressions such as:</p><pre>${json.select(&#34;fileList[?(@.fileData.minorType == &#39;MANUAL&#39;)].fileData.downloadLink&#34;,httpResponseBody)}<br/><br/>${json.select(&#34;fileList[?(@.fileData.minorType == &#39;ZIP&#39;)].fileData.downloadLink&#34;,httpResponseBody)}</pre><p></p><p>There are some useful path examples in <a href="https://github.com/json-path/JsonPath#path-examples" target="_blank">JsonPath</a> in GitHub.</p><h4>object()</h4><ul><li><strong>Syntax:</strong> <code>object(string)</code></li><li><strong>Description:</strong> Selects objects from a JSON collection.</li><li><strong>Parameters:</strong> string. This is a JSON key used to identify the desired JSON attribute value from a JSON response. Typically, <code>httpResponseBody</code>.</li></ul><p><strong>Example:</strong></p><p>Here is the JSON we will query:</p><pre class="hljs json">{&#34;item&#34;:&#34;value1&#34;,&#34;level1&#34;:{&#34;level2&#34;:&#34;value2&#34;}}</pre><p></p><p>Here is the query using the <code>object()</code> method to select <code>value1</code>:</p><pre>${json.object(httpResponseBody).item}</pre><p></p><p>We can add the <code>object()</code> method to an HTTP step and output it using <strong>Publish Variable Name</strong>:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/wfvecw3yod/1559160904207/image.png"/></figure><p>Next, we reference the output variable in a Shell Script step:</p><pre>echo &#34;JSON object: &#34; ${VAROBJECT.LEVEL}</pre><p>When the Workflow is deployed, the result is:</p><pre>JSON object:  value1</pre><p></p><h4>list()</h4><ul><li><strong>Syntax:</strong> <code>list(string, string)</code></li><li><strong>Description:</strong> Returns list object.</li><li><strong>Parameters:</strong> literal string, string (typically, <code>httpResponseBody</code>). Using the <code>list().get()</code> method returns items from the list.</li></ul><p><strong>Example:</strong></p><p>Here is the JSON we will query:</p><pre>{<br/>  &#34;books&#34;: [{<br/>      &#34;isbn&#34;: &#34;9781593275846&#34;,<br/>      &#34;title&#34;: &#34;Eloquent JavaScript, Second Edition&#34;,<br/>      &#34;subtitle&#34;: &#34;A Modern Introduction to Programming&#34;,<br/>      &#34;author&#34;: &#34;Marijn Haverbeke&#34;,<br/>      &#34;published&#34;: &#34;2014-12-14T00:00:00.000Z&#34;,<br/>      &#34;publisher&#34;: &#34;No Starch Press&#34;,<br/>      &#34;pages&#34;: &#34;472&#34;,<br/>      &#34;description&#34;: &#34;JavaScript lies at the heart of almost every modern web application, from social apps to the newest browser-based games. Though simple for beginners to pick up and play with, JavaScript is a flexible, complex language that you can use to build full-scale applications.&#34;<br/>    },<br/>    {<br/>      &#34;isbn&#34;: &#34;9781449331818&#34;,<br/>      &#34;title&#34;: &#34;Learning JavaScript Design Patterns&#34;,<br/>      &#34;subtitle&#34;: &#34;A JavaScript and jQuery Developer&#39;s Guide&#34;,<br/>      &#34;author&#34;: &#34;Addy Osmani&#34;,<br/>      &#34;published&#34;: &#34;2012-07-01T00:00:00.000Z&#34;,<br/>      &#34;publisher&#34;: &#34;O&#39;Reilly Media&#34;,<br/>      &#34;pages&#34;: &#34;254&#34;,<br/>      &#34;description&#34;: &#34;With Learning JavaScript Design Patterns, you&#39;ll learn how to write beautiful, structured, and maintainable JavaScript by applying classical and modern design patterns to the language. If you want to keep your code efficient, more manageable, and up-to-date with the latest best practices, this book is for you.&#34;<br/>    },<br/>    {<br/>      &#34;isbn&#34;: &#34;9781449365035&#34;,<br/>      &#34;title&#34;: &#34;Speaking JavaScript&#34;,<br/>      &#34;subtitle&#34;: &#34;An In-Depth Guide for Programmers&#34;,<br/>      &#34;author&#34;: &#34;Axel Rauschmayer&#34;,<br/>      &#34;published&#34;: &#34;2014-02-01T00:00:00.000Z&#34;,<br/>      &#34;publisher&#34;: &#34;O&#39;Reilly Media&#34;,<br/>      &#34;pages&#34;: &#34;460&#34;,<br/>      &#34;description&#34;: &#34;Like it or not, JavaScript is everywhere these days-from browser to server to mobile-and now you, too, need to learn the language or dive deeper than you have. This concise book guides you into and through JavaScript, written by a veteran programmer who once found himself in the same position.&#34;<br/>    },<br/>    {<br/>      &#34;isbn&#34;: &#34;9781491950296&#34;,<br/>      &#34;title&#34;: &#34;Programming JavaScript Applications&#34;,<br/>      &#34;subtitle&#34;: &#34;Robust Web Architecture with Node, HTML5, and Modern JS Libraries&#34;,<br/>      &#34;author&#34;: &#34;Eric Elliott&#34;,<br/>      &#34;published&#34;: &#34;2014-07-01T00:00:00.000Z&#34;,<br/>      &#34;publisher&#34;: &#34;O&#39;Reilly Media&#34;,<br/>      &#34;pages&#34;: &#34;254&#34;,<br/>      &#34;description&#34;: &#34;Take advantage of JavaScript&#39;s power to build robust web-scale or enterprise applications that are easy to extend and maintain. By applying the design patterns outlined in this practical book, experienced JavaScript developers will learn how to write flexible and resilient code that&#39;s easier-yes, easier-to work with as your code base grows.&#34;<br/>    }<br/>  ]<br/>}</pre><p>Here is the query using the <code>list()</code> method to select <code>pages</code> from the 3rd book:</p><pre>${json.list(&#34;books&#34;, httpResponseBody).get(2).pages}</pre><p>We can add the <code>list()</code> method to an HTTP step and output it using <strong>Publish Variable Name</strong>:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/wfvecw3yod/1559167380354/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Next, we reference the output variable in a Shell Script step:</p><pre>echo &#34;JSON list pages: &#34; ${book.pages}</pre><p>When the Workflow is deployed, the result is:</p><pre>JSON list:  460</pre><h4>format()</h4><ul><li><strong>Syntax:</strong> <code>format(object)</code></li><li><strong>Description:</strong> Format the array passed as the string value in JSON format.</li><li><strong>Parameters:</strong> object. Typically, this is the response from the HTTP response body (<code>httpResponseBody</code>). The <code>httpResponseBody</code> argument is used to indicate that we want to select the path within the HTTP response body. <code>httpResponseBody</code> is propagated from the HTTP request.</li></ul><p><strong>Example:</strong></p><p>We add a variable to the HTTP step that contains the <code>${httpResponseBody}</code> variable and then pass the response in the output variable named <code>BODY</code>.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1567114201698/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>If we simply render the <code>${VARS.BODY}</code> expression variable we get:</p><pre>{data:{attributes:name:new-construction-api}} {data:{attributes:version_pins:{mvn-service://new-construction-api:0.0.253-feature_NC-6595.8d268cd~nc1.6312a66}}}</pre><p></p><p>If we render the variable using the method <code>${json.format(VARS.BODY)}</code> we get a JSON formatted string:</p><pre class="hljs json">{&#34;data&#34;:{&#34;attributes&#34;:{&#34;name&#34;:&#34;new-construction-api&#34;,&#34;version_pins&#34;:{&#34;mvn-service://new-construction-api&#34;:&#34;0.0.253-feature_NC-6595.8d268cd~nc1.6312a66&#34;}}}}</pre><p></p><p>If you formatted this with common JSON indentation it would look like this:</p><pre>{<br/>  &#34;data&#34;: {<br/>    &#34;attributes&#34;: {<br/>      &#34;name&#34;: &#34;new-construction-api&#34;,<br/>      &#34;version_pins&#34;: {<br/>        &#34;mvn-service://new-construction-api&#34;: &#34;0.0.253-feature_NC-6595.8d268cd~nc1.6312a66&#34;<br/>      }<br/>    }<br/>  }<br/>}</pre><p></p><div class="note-callout">If you echo using <code>json.format()</code> and <code>double quotes</code> ensure that any double quotes in the JSON are escaped. Another option is to use echo with single quotes. This is standard Bash functionality.</div><h3>XML Functor</h3><p>The <a href="https://developer.mozilla.org/en-US/docs/Web/XPath" target="_blank">XPath</a> functor has one method: <code>xml.select()</code>.</p><h4>select()</h4><ul><li><strong>Syntax:</strong> <code>xml.select(string, string)</code></li><li><strong>Description:</strong> Returns XML file.</li><li><strong>Parameters:</strong> String using an XPath expression and XML file, and a string for <code>httpResponseBody</code>.</li></ul><p><strong>Example:</strong></p><p>Here is the contents of the XML file we will query:</p><pre class="hljs xml">&lt;?xml version=&#34;1.0&#34;?&gt;<br/>&lt;bookstore&gt;<br/>  &lt;book category=&#34;cooking&#34;&gt;<br/>    &lt;title lang=&#34;en&#34;&gt;Everyday Italian&lt;/title&gt;<br/>    &lt;author&gt;Giada De Laurentiis&lt;/author&gt;<br/>    &lt;year&gt;2005&lt;/year&gt;<br/>    &lt;price&gt;30.00&lt;/price&gt;<br/>  &lt;/book&gt;<br/>  &lt;book category=&#34;children&#34;&gt;<br/>    &lt;title lang=&#34;en&#34;&gt;Harry Potter&lt;/title&gt;<br/>    &lt;author&gt;J K. Rowling&lt;/author&gt;<br/>    &lt;year&gt;2005&lt;/year&gt;<br/>    &lt;price&gt;29.99&lt;/price&gt;<br/>  &lt;/book&gt;<br/>  &lt;book category=&#34;web&#34;&gt;<br/>    &lt;title lang=&#34;en&#34;&gt;XQuery Kick Start&lt;/title&gt;<br/>    &lt;author&gt;James McGovern&lt;/author&gt;<br/>    &lt;author&gt;Per Bothner&lt;/author&gt;<br/>    &lt;author&gt;Kurt Cagle&lt;/author&gt;<br/>    &lt;author&gt;James Linn&lt;/author&gt;<br/>    &lt;author&gt;Vaidyanathan Nagarajan&lt;/author&gt;<br/>    &lt;year&gt;2003&lt;/year&gt;<br/>    &lt;price&gt;49.99&lt;/price&gt;<br/>  &lt;/book&gt;<br/>  &lt;book category=&#34;web&#34; cover=&#34;paperback&#34;&gt;<br/>    &lt;title lang=&#34;en&#34;&gt;Learning XML&lt;/title&gt;<br/>    &lt;author&gt;Erik T. Ray&lt;/author&gt;<br/>    &lt;year&gt;2003&lt;/year&gt;<br/>    &lt;price&gt;39.95&lt;/price&gt;<br/>  &lt;/book&gt;<br/>&lt;/bookstore&gt;</pre><p>Here is the query using the <code>xml.select()</code> method to select the title from the first book:</p><pre>${xml.select(&#34;/bookstore/book[1]/title&#34;, httpResponseBody)}</pre><p>We can add the <code>xml.select()</code> method to an HTTP step and output it using <strong>Publish Variable Name</strong>:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/wfvecw3yod/1559168928099/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p>Next, we reference the output variable in a Shell Script step:</p><pre>echo &#34;XML select: &#34; ${mybook.title}</pre><p>When the Workflow is deployed, the result is:</p><pre>XML select:  Everyday Italian</pre><p>You can also see the entire XML file in the deployment <strong>Details</strong> section:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/wfvecw3yod/1559169014702/image.png"/></figure><p></p>