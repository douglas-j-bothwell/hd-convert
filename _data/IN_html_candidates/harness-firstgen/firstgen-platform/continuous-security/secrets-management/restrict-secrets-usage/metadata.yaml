type: article
article_id: e5q9qcho4y
user_id: wz6xkfcc9i
category_id: o9x167at52
author:
  name: Chakravarthy Tenneti
  profile_image: https://www.gravatar.com/avatar/790db061bb8f8fb094e4d4b19a390f3b?d=mm&s=150
title: Restrict Secrets Usage
slug: restrict-secrets-usage
description: You can restrict the usage of secrets only to Delegates or to specific
  Harness User Groups.
short_version: You can restrict the usage of secrets only to Delegates or to specific
  Harness User Groups.
tags:
- scope to account
- usage scope
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2021-05-12T17:21:33.61396Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Restrict Secrets Usage
  description: You can restrict the usage of secrets only to Delegates or to specific
    Harness User Groups.
  short_version: You can restrict the usage of secrets only to Delegates or to specific
    Harness User Groups.
  body: '<p>Harness secrets are restricted to the scope of their Secret Managers.
    They cannot be used outside of their Secrets Managers&#39; scope. See <a href="/article/e4ikpd00f6-scope-secret-managers-to-applications-and-environments">Scope
    Secret Managers to Applications and Environments</a>.</p><p>You can further limit
    the scope of a secret within the scope of its Secret Manager. You can restrict
    the usage of a secrets to specific Harness User Groups, Harness Applications,
    and Environments.</p><p>Also, you can scope a secret to be used in a <a href="/article/imzgiz9h41-use-a-secret-in-a-delegate-profile">Harness
    Delegate Profile</a> only.</p><p>This topic discusses how a secret&#39;s scope
    is determined, and how to further limit its scope from that of its Secrets Manager.</p><p>In
    this topic:</p><ul><li><a href="#before_you_begin">Before You Begin</a></li><li><a
    href="#review_secret_scope">Review: Secret Scope</a></li><li><a href="#option_1_scope_to_account">Option
    1: Scope to Account</a></li><li><a href="#option_2_applications_and_environments">Option
    2: Applications and Environments</a></li><li><a href="#next_steps">Next Steps</a></li></ul><h3>Before
    You Begin</h3><ul><li>See <a href="/article/4o7oqwih6h-harness-key-concepts">Harness
    Key Concepts</a>.</li><li>See <a href="/article/au38zpufhr-secret-management">Secrets
    Management Overview</a>.</li></ul><h3>Review: Secret Scope</h3><p>When creating
    secrets, it&#39;s important to understand their scope in your Harness account.</p><p>Harness
    secrets are managed and scoped using the following settings:</p><ul><li>Harness
    User Group Account Permission <strong>Manage Secrets</strong>:<ul><li>Required
    to add secrets for Account-level settings (Cloud Providers, Connectors, etc) and
    to any Applications on which the user has the Application Permissions <strong>Create</strong>,
    <strong>Read</strong>, and <strong>Update</strong>.<br/>If this permission is
    <u>not enabled</u>, the users within the User Groups will be able to <u>view</u>
    the secrets only.</li></ul></li><li>Harness User Group <strong>Application Permissions</strong>:<ul><li>Add
    the Actions <strong>Create</strong>, <strong>Read</strong>, and <strong>Update</strong>
    to the <u>Applications and Environments</u> where Users in the User Group may
    use secrets.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/e5q9qcho4y/1603146181423/image.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li></ul></li><li><strong>Secret
    Manager Usage Scope</strong>—When you create a Harness Encrypted Text or File
    secret, you select the Secret Manager for the secret. By default, Harness secrets
    inherit the same scope as the secret manager where they are stored. See <a href="/article/e4ikpd00f6-scope-secret-managers-to-applications-and-environments">Scope
    Secret Managers to Applications and Environments</a>.</li><li><strong>Secret</strong>
    <strong>Usage Scope</strong>—Each secret has <strong>Usage Scope</strong> settings
    for Applications and Environments. For Encrypted Text and Files, you also have
    <strong>Scope to Account</strong>:<br/>You have two options:<ul><li><strong>Scope
    to Account:</strong> Use allows the secret to be used in a Harness <a href="/article/h9tkwmkrm7-delegate-installation">Delegate
    Profile</a> only.</li><li><strong>Applications and Environments:</strong> Scope
    the usage to specific Applications and their Production and Non-Production Environments.</li></ul></li></ul><div
    class="note-callout">If you choose to apply scoping rules to a secret, then the
    Applications and Environments in the secret&#39;s scope must be entirely contained
    within the scope applied to its Secrets Manager. See <a href="/article/e4ikpd00f6-scope-secret-managers-to-applications-and-environments">Scope
    Secret Managers to Applications and Environments</a>.</div><p>Since User Group
    permissions are the broadest method for controlling secret usage, set those permissions
    first.</p><p>A user can only create a secret according to the scope set by its
    Harness User Group Account and Application permissions.</p><p>For example, if
    you have access to Application A only, you can create a secret scoped to Application
    A.</p><p>If you have access to Application A and B, you may still narrow the secret&#39;s
    scope to Application A, B, or both.</p><p>If the scope of a secret is only Application
    A, then only users with Read permission for Application A may see that secret.
    Users with Write permission to Application A may edit it also.</p><p>The following
    table explains the secret Usage Scope options and how they apply to Harness RBAC:</p><p></p><table><tbody><tr><td><p>Usage
    Scope Scenario</p></td><td><p>Result</p></td></tr><tr><td><p><strong>Scope to
    Account</strong> is selected.</p></td><td><p>The secret can be used in a Harness
    <a href="/article/h9tkwmkrm7-delegate-installation">Delegate Profile</a> only.</p><p>The
    secret can be managed by members of User Groups with the following <a href="/article/ven0bvulsj-users-and-permissions">Account
    Permission</a> enabled:</p><ul><li><strong>Manage Secrets</strong></li></ul><p><u>Or</u>
    the following Application Permission:</p><ul><li><strong>All Permissions Types</strong>
    and all items under <strong>Action</strong></li></ul></td></tr><tr><td><p><strong>No
    Usage Scope</strong>:</p><ul><li><strong>Scope to Account</strong> is not selected.</li><li>No
    Application and Environment are selected.</li></ul></td><td><p>The secret can
    be used in a Harness <a href="/article/h9tkwmkrm7-delegate-installation">Delegate
    Profile</a> only.</p><p>The secret can be managed by members of User Groups with
    the following <a href="/article/ven0bvulsj-users-and-permissions">Account Permission</a>
    enabled:</p><ul><li><strong>Manage Secrets</strong></li></ul></td></tr><tr><td><p>A
    single Application and Environment are selected.</p></td><td><p>The secret can
    be used in that Application and Environment.</p><p>The secret cannot be used in
    a Harness <a href="/article/h9tkwmkrm7-delegate-installation">Delegate Profile</a>.</p><p>The
    secret can only be managed by the user that created it, and members of User Groups
    with the following <a href="/article/ven0bvulsj-users-and-permissions">Account
    Permission</a> enabled:</p><ul><li><strong>Manage Secrets</strong></li></ul><div
    class="note-callout">If the Environment is deleted from your Harness Application,
    the secret will revert to <strong>No Usage Scope</strong>.</div></td></tr><tr><td><p>Multiple
    or All Applications and Environments are selected.</p></td><td><p>The secret can
    be used in those Applications and Environments.</p><p>The secret cannot be used
    in a Harness <a href="/article/h9tkwmkrm7-delegate-installation">Delegate Profile</a>.</p><p>The
    secret can only be managed by the user that created it, and members of User Groups
    with the following <a href="/article/ven0bvulsj-users-and-permissions">Account
    Permission</a> enabled:</p><ul><li><strong>Manage Secrets</strong></li></ul></td></tr></tbody></table><p></p><h3>Option
    1: Scope to Account</h3><p>If your Harness User account is part of a User Group
    with the <strong>Manage Secrets</strong> Account Permission enabled, you will
    see the <strong>Scope to Account</strong> option in the Encrypted Text and File
    dialogs.</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/au38zpufhr/1562967500481/image.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Select
    <strong>Scope to Account</strong> to make this encrypted file secret available
    to Delegate Profile scripts only. Only secrets scoped to the account are available
    to use in Delegate Profiles.</p><p>For more information, see <a href="/article/ven0bvulsj-users-and-permissions">Managing
    Users and Groups (RBAC)</a> and <a href="https://docs.harness.io/article/h9tkwmkrm7-delegate-installation#delegate_profiles">Delegate
    Profiles</a>.</p><p></p><h3>Option 2: Applications and Environments</h3><p>You
    might want to restrict which Harness User Groups can use a secret. Restrictions
    are set up using the secret&#39;s Usage Scope and the User Group&#39;s Application
    Permissions.</p><p>For example, in the following image, the <strong>Usage Scope</strong>
    of the secret is limited to the <strong>ExampleForDoc</strong> Application, and
    a User Group&#39;s <strong>Application Permissions</strong> are also limited to
    <strong>ExampleForDoc</strong>:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/au38zpufhr/1580867241293/image.png"
    style="max-height:100%;max-width:100%" data-hd-height="100%" data-hd-width="100%"/></figure><p>This
    limits the User Group to using only that secret (assuming that no other secrets
    <strong>Usage Scopes</strong> include <strong>ExampleForDoc</strong>).</p><p>it
    is important to remember that in order for a user to use the secret, the user&#39;s
    User Group must also have <strong>Applications Permissions</strong> (Create, Read,
    Update) set for the same Applications and Environments (or all Applications and
    Environments).</p><p>If you select the <strong>Scope to Account</strong> setting,
    the secret can be used in a Delegate Profile, as described in <a href="/article/au38zpufhr-secret-management#using_secrets">Using Secrets</a>.</p>'
  slug: restrict-secrets-usage
  tags:
  - scope to account
  - usage scope
  is_live: true
