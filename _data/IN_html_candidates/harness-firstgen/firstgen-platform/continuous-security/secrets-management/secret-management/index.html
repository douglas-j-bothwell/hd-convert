<p>Harness includes a built-in Secrets Management feature that enables you to store encrypted secrets, such as access keys, and use them in your Harness applications. Some key points about Secrets Management:</p><ul><li>Secrets are always accessed/decrypted at the time when they are needed, and at no time they are stored unencrypted.</li><li>Harness Manager does not have access to your key management system, and only the Harness Delegate, which sits in your private network, has access to it. Harness never makes secrets management accessible publicly. This adds an important layer of security.</li></ul><p>In this topic:</p><ul><li><a href="#secrets_how_tos">Secrets How-tos</a></li><li><a href="#before_you_begin">Before You Begin</a></li><li><a href="#visual_summary">Visual Summary</a></li><li><a href="#harness_secrets_management_process_overview">Harness Secrets Management Process Overview</a></li><li><a href="#scoping_secrets_usage">Scoping Secrets Usage</a></li><li><a href="#secrets_in_harness_community_and_on_prem_accounts">Secrets in Harness Community and On-Prem Accounts</a></li></ul><h3>Secrets How-tos</h3><ul><li>Adding Secrets Managers<ul><li> <a href="/article/avo98eldl0-add-a-google-cloud-kms-secrets-manager">Add a Google Cloud KMS Secrets Manager</a></li><li> <a href="/article/otkxijqoa6-add-an-aws-secrets-manager">Add an AWS Secrets Manager</a></li><li> <a href="/article/qj4psb5vsf-add-an-aws-kms-secrets-manager">Add an AWS KMS Secrets Manager</a></li><li> <a href="/article/2nv0gy1wnh-azure-key-vault">Add an Azure Key Vault Secrets</a></li><li> <a href="/article/am3dmoxywy-add-a-hashi-corp-vault-secrets-manager">Add a HashiCorp Vault Secrets Manager</a></li><li> <a href="/article/uzsv1l2ivd-add-a-cyber-ark-secrets-manager">Add a CyberArk Secrets Manager</a></li></ul></li><li>Managing Secrets<ul><li> <a href="/article/ygyvp998mu-use-encrypted-text-secrets">Use Encrypted Text Secrets</a></li><li> <a href="/article/nt5vchhka4-use-encrypted-file-secrets">Use Encrypted File Secrets</a></li><li> <a href="/article/prjsaaev0c-migrate-secrets-between-secrets-managers">Migrate Secrets between Secrets Managers</a></li><li> <a href="/article/e5q9qcho4y-restrict-secrets-usage">Restrict Secrets Usage</a></li><li> <a href="/article/cwp7rlauzn-reference-existing-secrets">Reference Existing Secrets</a></li><li> <a href="/article/imzgiz9h41-use-a-secret-in-a-delegate-profile">Use Secrets in a Delegate Profile</a></li><li> <a href="/article/gsp4s7abgc-add-ssh-keys">Add SSH Keys</a></li><li> <a href="/article/lx4wios62k-use-ssh-key-via-kerberos-for-server-authentication">Use SSH Keys via Kerberos for Server Authentication</a></li><li><a href="/article/8y73f4o4ph-add-hashi-corp-vault-signed-ssh-certificate-keys">Add HashiCorp Vault Signed SSH Certificate Keys</a></li><li> <a href="/article/9fqa1vgar7-add-win-rm-connection-credentials">Add WinRM Connection Credentials</a></li></ul></li></ul><h3>Before You Begin</h3><p>Before learning about, you should have an understanding of the following:</p><ul><li><a href="/article/4o7oqwih6h-harness-key-concepts">Harness Key Concepts</a></li><li><a href="/article/o5ec7vvtju-secrets-and-log-sanitization">Secrets and Log Sanitization</a></li></ul><h3>Visual Summary</h3><p>You can choose to use your own secrets management solution, or the built-in Harness Secrets Manager. This diagram shows how Harness handles secrets:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1568741594665/on-prem-architecture.jpg"/></figure><p></p><h3>Harness Secrets Management Process Overview</h3><p>Harness sends only encrypted data to the secrets manager, as follows: </p><ol><li>Your browser sends data over HTTPS to Harness Manager. </li><li>Harness Manager relays encrypted data to the Harness Delegate, also over HTTPS. </li><li>The Delegate exchanges a key pair with the secrets manager, over an encrypted connection. </li><li>The Harness Delegate uses the encrypted key and the encrypted secret, and then discards them. The keys never leave the Delegate.</li></ol><div class="note-callout">Any secrets manager requires a running Harness Delegate to encrypt and decrypt secrets. Any Delegate that references a secret requires direct access to the secrets manager.</div><p>You can manage your secrets in Harness using either a Key Management Service or third party Secrets Managers.</p><h4>Using Key Management Services</h4><p>Google Cloud Key Management Service is the default Secrets Manager in Harness. </p><p>The Key Management Service (Google Cloud KMS or AWS KMS) only stores the key. Harness uses <a href="https://cloud.google.com/kms/docs/envelope-encryption">envelope encryption</a> to encrypt and decrypt the secrets. The encrypted secret and the encrypted Data Encryption Key (used for envelope encryption) are stored in the Harness database. </p><div class="warning-callout">If you are using a KMS, rotation of keys is not supported by Harness and you might lose access to your secrets if the older version of the key is removed from your KMS.</div><h4>Using Third-Party Secrets Managers</h4><p>You can also use third-party Secrets Managers — HashiCorp Vault, Azure Key Vault, CyberArk, and AWS Secrets Manager.</p><p>These Secrets Managers store the key, perform encryption and decryption, and also store the secrets (encrypted key pair). Neither the keys nor the secrets are stored in the Harness database. A reference to the secret is stored in the Harness database.</p><h3>Scoping Secrets Usage</h3><p>For scoping secrets, see <a href="/article/e5q9qcho4y-restrict-secrets-usage">Restrict Secrets Usage</a>.</p><p>For scoping Secret Managers, see <a href="/article/e4ikpd00f6-scope-secret-managers-to-applications-and-environments">Scope Secret Managers to Applications and Environments</a>.</p><h3>Secrets in Harness Community and On-Prem Accounts</h3><p>In <a href="https://docs.harness.io/article/y1t8hhz4y5-harness-editions">Community</a> and <a href="/article/gng086569h-harness-on-premise-versions">On-Prem</a> accounts, Harness uses a random-key secrets store as the Harness Secrets Manager.</p><div class="note-callout">Once you have installed On-Prem, <a href="https://docs.harness.io/article/uuer539u3l-add-a-secrets-manager">Add a Harness Secrets Manager</a>. By default, On-Prem installations use the local Harness MongoDB for the default Harness Secrets Manager. This is not recommended.</div><div class="note-callout">Harness does not currently support migrating secrets from the random-key secrets store. If you add secrets here, you will need to recreate them in any custom secrets manager you configure later.</div><p>All Harness secrets managers require a running Harness Delegate to encrypt and decrypt secrets.</p><p>If you created a Harness trial account, a Delegate is typically provisioned by Harness, and the default Harness Secrets Manager performs encryption/decryption.</p><p></p>