<p></p><p>You can upload encrypted files and reference them across your account in the same way as encrypted text.</p><p>In this topic:</p><ul><li><a href="https://docs.harness.io/article/nt5vchhka4-use-encrypted-file-secrets#before_you_begin">Before You Begin</a></li><li><a href="https://docs.harness.io/article/nt5vchhka4-use-encrypted-file-secrets#step_1_add_encrypted_file">Step 1: Add Encrypted File</a></li><li><a href="https://docs.harness.io/article/nt5vchhka4-use-encrypted-file-secrets#step_2_reference_the_encrypted_file">Step 2: Reference the Encrypted File</a></li><li><a href="#review_encrypted_files_must_be_added_to_a_service">Review: Encrypted Files Must be Added to a Service</a></li><li><a href="https://docs.harness.io/article/nt5vchhka4-use-encrypted-file-secrets#review_file_secrets_in_outputs">Review: File Secrets in Outputs</a></li></ul><h3>Before You Begin</h3><ul><li>See <a href="/article/4o7oqwih6h-harness-key-concepts">Harness Key Concepts</a>.</li><li>Make sure you add the required Secrets Manager. See <a href="/article/uuer539u3l-add-a-secrets-manager">Add a Secrets Manager</a>.</li></ul><h3>Step 1: Add Encrypted File</h3><ol><li>In <strong>Secrets Management</strong>, click <strong>Encrypted Files</strong>.</li><li>Click <strong>Add Encrypted File</strong>. The <strong>Add Encrypted File</strong> dialog appears.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/4vqipye0vz/1580802694901/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Select the secrets manager you will use to encrypt this file.</li><li>Enter a name for the encrypted file. This is the name you will use to reference the file in application entities.</li><li>Click <strong>Choose File</strong>, and locate and add a file. The default Secrets Manager for your account is used to encrypt the file.</li><li><strong>Scope to Account</strong> - If your Harness User account is part of a User Group with the <strong>Administer Other Account Functions</strong> permission enabled, you will see the <strong>Scope to Account</strong> option. Select <strong>Scope to Account</strong> to make this encrypted file secret available to Delegate Profile scripts only. Only secrets scoped to the account are available to use in Delegate Profiles.</li><li>For <strong>Usage Scope</strong>, see <a href="/article/e5q9qcho4y-restrict-secrets-usage">Restrict Secrets Usage</a>.</li><li>Click <strong>SUBMIT</strong>.</li></ol><h3>Step 2: Reference the Encrypted File</h3><p>When you are in an application entity that uses files, you can reference the encrypted file.</p><p>For example, in the following <strong>Configuration File</strong> dialog, click <strong>Encrypt File</strong> and the <strong>File</strong> dropdown lets you choose the file you added in <strong>Secrets Management</strong>:</p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/au38zpufhr/1534805540009/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><h3>Review: Encrypted Files Must be Added to a Service</h3><p>To use Encrypted Files, you must add them to a Service. </p><p>You can then use the Encrypted File in any Workflow that deploys that Service using the variables:</p><ul><li><code>${configFile.getAsBase64(&#34;secret_name&#34;)}</code> — This displays the contents of the file encoded in Base64 binary-to-text encoding schemes.</li><li><code>${configFile.getAsString(&#34;secret_name&#34;)}</code> — This displays the contents of the file as a string.</li></ul><p>Let&#39;s look at each example.</p><h4>File Secret with Base64 Encoding</h4><p>First, we have a Harness Service where the file secret is added to Config Files with the name <strong>secret-file</strong>.</p><p>The contents of the file is <code>this is a file secret</code>.</p><p>In a Workflow that uses the Service, add a Shell Script step such as the following:</p><pre>cat &lt;&lt;EOF<br/>file secret:<br/>${configFile.getAsBase64(&#34;secret-file&#34;)}<br/>EOF</pre><p>When you deploy the Workflow, the script is executed and the file contents are Base64 encoded:</p><pre>Executing command ...<br/>file secret:<br/>dGhpcyBpcyBhIGZpbGUgc2VjcmV0Cgo=<br/>Command completed with ExitCode (0)</pre><h4>File Secret as String</h4><p>Let&#39;s add a new Shell Script step using <code>${configFile.getAsString(&#34;secret_name&#34;)}</code>:</p><pre>cat &lt;&lt;EOF<br/>file secret:<br/>${configFile.getAsString(&#34;secret-file&#34;)}<br/>EOF</pre><p>When you deploy the Workflow, the script is executed and the file contents are string encoded:</p><pre>Executing command ...<br/>file secret:<br/>this is a file secret<br/><br/>Command completed with ExitCode (0)</pre><p>For information on adding Encrypted Files to a Service, see <a href="https://docs.harness.io/article/eb3kfl8uls-service-configuration#config_files">Config Files</a>.</p><h4>Do Not Echo File Secrets</h4><p>Echo does not work with file secrets. For example, if your file secret contained the following:</p><pre>a<br/>b<br/>c</pre><p>and you used echo like this:</p><pre>echo &#34;file secret: &#34; ${configFile.getAsString(&#34;secret-file&#34;)}</pre><p>The output would be:</p><pre>file secret: a<br/>command not found: b<br/>command not found: c</pre><p>Instead, use cat like this:</p><pre>cat &lt;&lt;EOF<br/>file secret:<br/>${configFile.getAsBase64(&#34;secret-file&#34;)}<br/>EOF</pre><h3>Review: File Secrets in Outputs</h3><p>File secrets are not masked in Harness logs. As noted above they can be encoded in different formats, but they are not masked from users.</p><p>See <a href="/article/o5ec7vvtju-secrets-and-log-sanitization">Secrets and Log Sanitization</a>.</p><p></p>