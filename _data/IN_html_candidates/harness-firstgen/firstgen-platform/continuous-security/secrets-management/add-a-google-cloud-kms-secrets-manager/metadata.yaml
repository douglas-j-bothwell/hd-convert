type: article
article_id: avo98eldl0
user_id: wz6xkfcc9i
category_id: o9x167at52
author:
  name: Chakravarthy Tenneti
  profile_image: https://www.gravatar.com/avatar/790db061bb8f8fb094e4d4b19a390f3b?d=mm&s=150
title: Add Google KMS as a Harness Secrets Manager
slug: add-a-google-cloud-kms-secrets-manager
description: You can use the Google Cloud Key Management Service (Cloud KMS) as your
  secrets manager.
short_version: You can use the Google Cloud Key Management Service (Cloud KMS) as
  your secrets manager.
tags:
- Google Cloud KMS
- Secrets management
- Secrets Manager
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2022-07-29T08:21:31.010121Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Add Google KMS as a Harness Secrets Manager
  description: You can use the Google Cloud Key Management Service (Cloud KMS) as
    your secrets manager.
  short_version: You can use the Google Cloud Key Management Service (Cloud KMS) as
    your secrets manager.
  body: '<div class="tip-callout">This content is for Harness <a href="https://docs.harness.io/article/1fjmm4by22">FirstGen</a>.
    Switch to <a href="/article/cyyym9tbqt-add-google-kms-secrets-manager">NextGen</a>.</div><p>You
    can use Google <a href="https://cloud.google.com/kms/" target="_blank">Cloud Key
    Management Service</a> (Cloud KMS) as your secrets manager. Once Google KMS is
    added as a Secrets Manager, you can create encrypted secrets in Google KMS and
    use them in your Harness account.</p><div class="note-callout">You can also use
    a Google Cloud Secrets Manager as a Harness Secrets Manager. See <a href="/article/t0rj3ze6ui-add-a-google-cloud-secrets-manager">Add
    a Google Cloud Secrets Manager</a>.</div><p>In this topic:</p><ul><li><a href="#before_you_begin">Before
    You Begin</a></li><li><a href="#step_1_configure_secrets_manager">Step 1: Configure
    Secrets Manager</a></li><li><a href="#step_2_display_name">Step 2: Display Name</a></li><li><a
    href="#step_3_gather_the_required_details">Step 3: Gather the Required Details</a></li><li><a
    href="https://docs.harness.io/article/avo98eldl0-#step_4_attach_service_account_key_credentials_file">Step
    4: Attach Service Account Key (Credentials) File</a></li><li><a href="#limitations">Limitations</a></li><li><a
    href="#next_steps">Next Steps</a></li></ul><h3>Before You Begin</h3><ul><li>See
    <a href="/article/4o7oqwih6h-harness-key-concepts">Harness Key Concepts</a>.</li><li>See
    <a href="/article/au38zpufhr-secret-management">Secrets Management Overview</a>.</li></ul><p></p><h3>Step
    1: Configure Secrets Manager</h3><ol><li>Select <strong>Security</strong> &gt;
    <strong>Secrets Management</strong>. The <strong>Secrets Management</strong> page
    appears.</li><li>Click <strong>Configure Secrets Managers</strong>. In the resulting
    <strong>Secrets Managers</strong> page, the <strong>Status</strong> column indicates
    the <strong>Default</strong> provider.</li><li>Click <strong>Add Secrets Manager</strong>.
    The <strong>Configure Secrets Manager</strong> dialog appears.</li><li>Select
    <strong>Google KMS</strong> from the drop down list.</li></ol><h3>Step 2: Display
    Name</h3><p>Enter an arbitrary name to identify this secrets manager. The name
    can include letters, numbers, spaces, and the following characters: <code>&#39;
    - !</code></p><h3>Step 3: Gather the Required Details</h3><p>To fill in the <strong>Configure
    Secrets Manager</strong> dialog&#39;s remaining fields, log into <a href="https://console.cloud.google.com/">Google
    Cloud Console</a> and follow these steps:</p><ol><li>Create or select your project.</li><li>Select <strong>Security</strong> &gt; <strong>Cryptographic</strong><strong> Keys</strong>.</li><li>Select
    a key ring. (If no key ring is present, create one.)<div class="tip-callout">To
    create resources in this or the next step, see Google Cloud&#39;s <a href="https://cloud.google.com/kms/docs/creating-keys"
    target="_blank">Creating Symmetric Keys</a> topic.</div></li><li>Select a key
    within the ring. (If no key ring is present, create one.)</li><li>To the right
    of your key&#39;s <strong>Enabled &amp; Primary</strong> Version, open the Actions
    ⋮ menu, then select <strong>Copy Resource ID</strong>.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/32poj7ap92/1576189882951/image.png"
    style="max-height:40%;max-width:40%" data-hd-height="40%" data-hd-width="40%"/></figure>A
    reference to the key is now on your clipboard.</li><li>Paste the reference into
    an editor. You can now copy and paste its substrings into each of the Harness
    <strong>Configure Secrets Manager</strong> dialog&#39;s remaining fields—<strong>Project ID</strong>,
    <strong>Region</strong>, <strong>Key Ring</strong>, <strong>Key Name</strong>—as
    shown below.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/32poj7ap92/1576195894066/image.png"
    style="max-height:100%;max-width:100%" data-hd-height="100%" data-hd-width="100%"/></figure></li></ol><p></p><h3>Step
    4: Attach Service Account Key (Credentials) File</h3><p>Export your Google Cloud
    service account key, and attach it to the Harness <strong>Configure Secrets Manager</strong>
    dialog, as follows:</p><ol><li>In the Google Cloud Console, select <strong>IAM
    &amp; admin</strong> &gt; <strong>Service Accounts</strong>.</li><li>Scroll to
    the service account you want to use. (If no service account is present, create
    one.)</li><li>Grant this service account the <code>cloudkms.cryptoKeyEncrypterDecrypter</code> permission.
    (See Google Cloud&#39;s <a href="https://cloud.google.com/kms/docs/iam#granting_permissions_to_use_keys">Using Cloud
    IAM with KMS</a> topic.)</li><li>Open your service account&#39;s Actions ⋮ menu,
    then select <strong>Create key.</strong><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/32poj7ap92/1576190233970/image.png"
    style="max-height:30%;max-width:30%" data-hd-height="30%" data-hd-width="30%"/></figure></li><li>In
    the resulting <strong>Create private key</strong> dialog, select the <strong>JSON</strong>
    option, create the key, and download it to your computer.</li><li>Return to Harness
    Manager&#39;s <strong>Configure Secrets Manager</strong> dialog. Under <strong>GCP
    KMS Credentials File</strong>, click the <strong>Choose File</strong> button,
    and upload the key file you just exported from Google Cloud.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/32poj7ap92/1576139813708/image.png"
    style="max-height:40%;max-width:40%" data-hd-height="40%" data-hd-width="40%"/></figure></li><li>Click
    <strong>Submit</strong>. Your Google Cloud KMS will now appear in Harness Manager&#39;s <strong>Secrets Managers</strong> list,
    labeled with the <strong>Display Name</strong> you assigned.</li></ol><h3>Step
    5: Usage Scope</h3><p>See <a href="/article/e4ikpd00f6-scope-secret-managers-to-applications-and-environments">Scope
    Secret Managers to Applications and Environments</a>.</p><h3>Limitations</h3><p>Harness
    currently does not support migrating secrets from Google Cloud KMS (or other secrets
    managers) to CyberArk. For details, see <a href="#cyber_ark_limitations">CyberArk Limitations</a>.</p><p></p>'
  slug: add-a-google-cloud-kms-secrets-manager
  tags:
  - Google Cloud KMS
  - Secrets management
  - Secrets Manager
  is_live: true
