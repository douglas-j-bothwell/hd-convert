type: article
article_id: 9fqa1vgar7
user_id: wz6xkfcc9i
category_id: o9x167at52
author:
  name: Chakravarthy Tenneti
  profile_image: https://www.gravatar.com/avatar/790db061bb8f8fb094e4d4b19a390f3b?d=mm&s=150
title: Add WinRM Connection Credentials
slug: add-win-rm-connection-credentials
description: You can set up a WinRM connection and then use it as a Deployment Type
  in an Environment's Service Infrastructure.
short_version: You can set up a WinRM connection and then use it as a Deployment Type
  in an Environment's Service Infrastructure.
tags:
- WinRM
- Windows
- Secrets management
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: Article updated
  source: API
  triggered_at: 2021-07-29T17:48:48.172238Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Add WinRM Connection Credentials
  description: You can set up a WinRM connection and then use it as a Deployment Type
    in an Environment's Service Infrastructure.
  short_version: You can set up a WinRM connection and then use it as a Deployment
    Type in an Environment's Service Infrastructure.
  body: '<p></p><p>You can set up a WinRM connection and then use it as a <strong>Deployment
    Type</strong> in an Environment&#39;s Service Infrastructure.</p><p>In this topic:</p><ul><li>
    <a href="#before_you_begin">Before You Begin</a></li><li><a href="#review_limitations">Review:
    Limitations</a></li><li> <a href="#step_1_set_up_the_win_rm_connection">Step 1:
    Set Up the WinRM Connection</a></li><li> <a href="#step_2_name">Step 2: Name</a></li><li>
    <a href="#step_3_auth_scheme">Step 3: Auth Scheme</a></li><li> <a href="#step_4_domain">Step
    4: Domain</a></li><li> <a href="#step_5_user_name">Step 5: User Name</a></li><li>
    <a href="#step_6_select_encrypted_password">Step 6: Select Encrypted Password</a></li><li>
    <a href="#step_7_use_ssl">Step 7: Use SSL</a></li><li> <a href="#step_8_skip_cert_check">Step
    8: Skip Cert Check</a></li><li> <a href="#step_9_use_no_profile">Step 9: Use No
    Profile</a></li><li> <a href="#step_10_win_rm_port">Step 10: WinRM Port</a></li><li>
    <a href="#step_11_test_the_connection">Step 11: Test the Connection</a></li><li>
    <a href="#step_12_update_the_infrastructure_definition">Step 12: Update the Infrastructure
    Definition</a></li></ul><p></p><h3>Before You Begin</h3><ul><li>See <a href="/article/4o7oqwih6h-harness-key-concepts">Harness
    Key Concepts</a>.</li><li>See <a href="/article/au38zpufhr-secret-management">Secrets
    Management Overview</a>.</li></ul><p></p><h3>Review: Limitations</h3><p>Secrets
    cannot contain special characters without escaping. For example, if the secret
    contains a <code>$</code> like <code>ab$c</code> it will fail.</p><p>Escape any
    special characters in your secrets: <code>ab\$c</code>.</p><h3>Step 1: Set Up
    the WinRM Connection</h3><p>In <strong>Secrets Management</strong>, under <strong>Execution
    Credentials</strong>, click <strong>WinRM Connection</strong>.</p><p>The WinRM
    Connection Attributes dialog appears.</p><h3>Step 2: Display Name</h3><p>Name
    to identify the connection. You will use this name to identify this connection
    when setting up the <strong>Connection Attributes</strong> in the environment
    <strong>Service Infrastructure</strong>.</p><h3>Step 3: Auth Scheme</h3><p>Specifies
    the mechanism used to authenticate the credentials used in this connection. Select
    <strong>NTLM</strong>.</p><h3>Step 4: Domain</h3><p>The Active Directory domain
    name where the user account in the credentials is registered. This can be left
    blank when using a local user.</p><h3>Step 5: User Name</h3><p>The user account
    credentials for this connection. The user must belong to the same Active Directory
    domain as the Windows instances that this connection uses. These are the same
    user account credentials you would use to log into the VM using a remote connection
    such as Microsoft Remote Desktop.</p><p>In cases when <strong>Domain</strong>
    is blank (local user), you can put <strong>./</strong> before the user name. The
    <strong>./</strong> prefix is equivalent to <code>local_host_or_ip\user</code>.</p><h3>Step
    6: Select Encrypted Password</h3><p>Make sure you use a Harness Encrypted Text
    secret to save the password and refer it using this option. Either select an existing
    secret from the drop down list or create a new one by clicking <strong>+ Create
    Encrypted Text</strong>.</p><p>For more information on creating Encrypted Text,
    seeÂ  <a href="/article/ygyvp998mu-use-encrypted-text-secrets">Harness Encrypted
    Text secret</a>.</p><h3>Step 7: Use SSL</h3><p>Enables an HTTPS connection instead
    of an HTTP connection. SSL is recommended.</p><p>When you select <strong>Use SSL</strong>,
    the port number in <strong>WinRM Port</strong> changes to the HTTPS port <strong>5986</strong>
    automatically.</p><p>When <strong>Use SSL</strong> port is not selected, the port
    number is set to the HTTP port <strong>5985</strong>.</p><h3>Step 8: Skip Cert
    Check</h3><p>When connected over HTTPS (<strong>Use SSL</strong> in enabled),
    the client does not validate server certificate.</p><h3>Step 9: Use No Profile</h3><p>When
    you run a script, PowerShell will first load profiles and then run the script.</p><p>You
    might not know what the profile contains, so it can result in unexpected behavior.</p><p>Select
    this option to make the PowerShell session run without loading the Windows PowerShell
    profile, like running <code>PowerShell -NoProfile</code>.</p><p>See <a href="https://docs.microsoft.com/en-us/powershell/module/microsoft.powershell.core/about/about_profiles?view=powershell-7#the-noprofile-parameter"
    target="_blank">The NoProfile parameter</a> from Microsoft.</p><h3>Step 10: WinRM
    Port</h3><p>Specifies the network port on the remote computer to use.</p><p>To
    connect to a remote computer, the remote computer must be listening on the port
    that the connection uses. The default ports are 5985, which is the WinRM port
    for HTTP, and <strong>5986</strong>, which is the WinRM port for HTTPS.</p><p>To
    determine what ports WinRM is listening on, use the command:</p><p><code>winrm
    e winrm/config/listener</code></p><h3>Step 11: Test the Connection</h3><p>Click
    <strong>Test</strong> to ensure that the connection is successful. Once the connection
    is successful, click <strong>Submit</strong>.</p><p>Generally, the Harness Delegate
    and the target node will be in the same subnet and so the private IP address of
    the target host can be used.</p><p>If the Harness Delegate cannot resolve the
    private address of the target node, try the public address. Some cloud networking
    scenarios prevent private address resolution.</p><h3>Step 12: Update the Infrastructure
    Definition</h3><p>In <strong>Infrastructure Definition</strong>, the Infrastructure
    Definition dialog will look like this:</p><p></p><figure><img src="https://files.helpdocs.io/kw8ldg1itf/other/1568326366870/image.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><h3>Troubleshooting</h3><p>The
    WinRM Connection simply checks a log in. When you use the WinRM Connection to
    perform deployment operations other errors might occur.</p><p>In general, the
    errors result from port conflicts or the WinRM settings on the target host are
    not set up correctly.</p><p>See:</p><ul><li><a href="/article/g9o2g5jbye-troubleshooting-harness">Troubleshooting</a></li><li><a
    href="/article/l639i8uqxs-5-best-practices-and-troubleshooting">IIS Best Practices
    and Troubleshooting</a></li></ul><p></p>'
  slug: add-win-rm-connection-credentials
  tags:
  - WinRM
  - Windows
  - Secrets management
  is_live: true
