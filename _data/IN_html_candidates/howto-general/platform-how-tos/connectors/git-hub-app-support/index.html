<p>Harness supports API access to GitHub using a GitHub App.</p><p>GitHub recommends using GitHub Apps when integrating with GitHub. GitHub Apps offer more granular permissions to access data than typical authentication methods.</p><p>Harness supports GitHub Apps in its Harness GitHub Connector.</p><div class="note-callout">For more information, see <a href="/article/v9sigwjlgo-git-hub-connector-settings-reference">GitHub Connector Settings Reference</a>. Also, if you&#39;re new to GitHub apps, see <a href="https://docs.github.com/en/developers/apps/about-apps" target="_blank">About apps</a> and <a href="https://docs.github.com/en/developers/apps/installing-github-apps" target="_blank">Installing GitHub Apps</a> from GitHub</div><p>In this topic:</p><p></p><ul><li><a href="#before_you_begin">Before You Begin</a></li><li><a href="#review_requirements">Review: Requirements</a></li><li><a href="#step_1_create_a_git_hub_app">Step 1: Create a GitHub app</a></li><li><a href="#step_2_install_the_git_hub_app">Step 2: Install the GitHub App</a></li><li><a href="#step_3_generate_and_download_key">Step 3: Generate and Download Key</a></li><li><a href="#step_4_create_a_harness_secret_with_the_key_value">Step 4: Create a Harness Secret with the Key Value</a></li><li><a href="#step_5_use_git_hub_app_and_secret_in_harness_git_hub_connector">Step 5: Use GitHub App and Secret in Harness GitHub Connector</a></li><li><a href="#step_6_test_git_hub_connector">Step 6: Test GitHub Connector</a></li></ul><h3>Before You Begin</h3><ul><li><a href="/article/v9sigwjlgo-git-hub-connector-settings-reference">GitHub Connector Settings Reference</a></li><li><a href="/article/u8lgzsi7b3-quickstarts">Quickstarts</a></li></ul><h3>Review: Requirements</h3><p>One or more of the following GitHub permissions are required:</p><ul><li>You have the GitHub permissions required to install GitHub Apps on your personal account or under any organization where you have administrative access.</li><li>If you have admin permissions in a GitHub repo in a GitHub organization, you can install GitHub Apps in that repo.</li><li>If a GitHub App is installed in a repository and requires an organization&#39;s permission, the organization owner must approve the application.</li></ul><h3>Step 1: Create a GitHub app</h3><p>You can create and register a GitHub App under your personal account or under any organization where you have administrative access. You create your GitHub App in your personal account, and then register it where you have the required GitHub permissions.</p><p>See <a href="https://docs.github.com/en/developers/apps/creating-a-github-app" target="_blank">Creating a GitHub App</a> from GitHub.</p><p>In your GitHub personal account, click <strong>Settings</strong>.</p><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614116510469/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Click <strong>Developer settings</strong>.</p><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614116534212/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Click <strong>New GitHub App</strong>.</p><p>Enter the following settings, and then click <strong>Create GitHub App</strong>.</p><ul><li><strong>GitHub App name:</strong> enter the name for your app.</li><li><strong>Homepage URL:</strong> enter <strong>https://harness.io/</strong>.</li><li><strong>Webhook:</strong> <u>uncheck</u> <strong>Active</strong>.</li><li><strong>Repository permissions:</strong><ul><li><strong>Administration:</strong> select <strong>Access: Read &amp; write</strong>.</li><li><strong>Commit statuses</strong>: select <strong>Access: Read &amp; write</strong>.</li><li><strong>Contents:</strong> select <strong>Access: Read &amp; write</strong>.</li><li><strong>Metadata:</strong> select <strong>Access: Read-only</strong>.</li><li><strong>Pull requests</strong>: select <strong>Access: Read &amp; write</strong>. This permission is required for the <strong>Issue Comment</strong> event trigger for Github.</li><li><strong>Webhooks:</strong> select <strong>Read &amp; write</strong>.</li></ul></li><li><strong>Where can this GitHub App be installed?</strong> Select <strong>Any account</strong>.</li></ul><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1641420213625/clean-shot-2022-01-05-at-14-03-12-2-x.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>The app is created.</p><p>By default the application you created is <strong>Public</strong>.</p><p>If your application is <strong>Private</strong>, make sure to make it <strong>Public</strong>.</p><p>To do this, open the app by clicking <strong>Edit.</strong></p><p>Select <strong>Advanced</strong>.</p><p>In <strong>Make this GitHub App public</strong>, click <strong>Make public</strong>, and click <strong>OK</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1656593227006/screenshot-2022-06-30-at-6-15-18-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Now you can install the app.</p><h3>Step 2: Install the GitHub App</h3><p>In the same GitHub App, click <strong>Install App</strong>.</p><p>In <strong>Repository access</strong>, select <strong>Only select repositories</strong>, and then select the same repo you are connecting with Harness.</p><p>In <strong>Permissions</strong>, set the following permissions:</p><ul><li><strong>Read access to metadata</strong></li><li><strong>Read and write access to code, commit statuses, and pull requests</strong></li></ul><p>Install the new app.</p><p>Once the app is installed, you&#39;ll need to record the following information to use in the Harness Connector:</p><ul><li><strong>Installation ID:</strong> the Installation ID is located in the URL of the installed app.</li></ul><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614117383317/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><ul><li><strong>App ID:</strong> the App ID is located in the GitHub app&#39;s <strong>General</strong> tab.</li></ul><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614117274949/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><h3>Step 3: Generate and Download Key</h3><p>Now we&#39;ll create the private key for the GitHub app that you will use in your Harness Connector.</p><p>Open the GitHub app you created.</p><p>In <strong>Private keys</strong>, click <strong>Generate a private key</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614118879070/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Download the private key to your local machine.</p><p>Open a terminal and navigate to the folder containing the key.</p><p>Run the following command, replacing <code>&lt;your-key&gt;.pem</code> with the name of your PEM file:</p><pre>openssl pkcs8 -topk8 -inform PEM -outform PEM -in &lt;your-key&gt;.pem -out converted-github-app.pem -nocrypt</pre><p></p><p>In the next step, you&#39;ll add the file as a new Harness file secret.</p><h3>Step 4: Create a Harness Secret with the Key Value</h3><p>In Harness, click the account, org, or project where you want to store your secret.</p><p>Click <strong>Project Setup</strong>, and then click <strong>Secrets</strong>.</p><p>Click <strong>New Secret</strong>, and then click <strong>File</strong>.</p><p>In <strong>Secrets Manager</strong>, select a Secrets Manager. See <a href="/article/hngrlb7rd6-harness-secret-manager-overview">Harness Secrets Manager Overview</a>.</p><p>In <strong>Secret Name</strong>, enter a name for the secret. You&#39;ll use this name to select the secret in Harness Connectors and other settings.</p><p>In <strong>Secret File</strong>, upload the PEM file.</p><p>Click <strong>Save</strong>.</p><p>Now we can add the GitHub app to the Harness GitHub Connector.</p><h3>Step 5: Use GitHub App and Secret in Harness GitHub Connector</h3><p>Create or open the GitHub Connector used in your Pipeline codebase. For steps on creating the Connector, see <a href="/article/v9sigwjlgo-git-hub-connector-settings-reference">GitHub Connector Settings Reference</a>.</p><p>You can open a Connector from <strong>Resources</strong> in an account, org, or project, or from the stage&#39;s settings.</p><p>For example, in a CI stage, click <strong>Codebase</strong>. The Connector for the codebase is displayed.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614212791578/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Click the Connector, and then click the edit button. The GitHub Connector is displayed.</p><p>In the Connector <strong>Credentials</strong>, enter a username and Personal Access Token (PAT), and then select <strong>Enable API access</strong>.</p><p>In <strong>API Authentication</strong>, select <strong>GitHub App</strong>.</p><p>Enter the following settings:</p><ul><li><strong>GitHub Installation ID:</strong> enter the Installation ID located in the URL of the installed GitHub App.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614213226801/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li><strong>GitHub Application ID:</strong> enter the GitHub <strong>App ID</strong> from the GitHub App <strong>General</strong> tab.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614213187702/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li><strong>GitHub Private Key:</strong> select the Harness secret you created for the PEM file key.</li></ul><p>When you&#39;re done, the settings will look something like this:</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614213309400/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Click <strong>Save and Continue</strong>. The connection and authentication is verified.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614213352327/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Click <strong>Finish</strong>.</p><p>Now you can run a Pipeline and verify that the GitHub app credentials are working.</p><h3>Step 6: Test GitHub Connector</h3><p>Run a Pipeline that uses the GitHub Connector configured with the GitHub app credentials.</p><p>For PR events, use a Git Webhook Trigger to execute the Pipeline.</p><p>Make sure the Webhook definition in GitHub sends events for <strong>Pull Request</strong> in its <strong>Events</strong> settings.</p><div class="note-callout">If you haven&#39;t set a Git Webhook Trigger up, see <a href="/article/hndnde8usz-triggering-pipelines">Trigger Pipelines using Git Events</a>.</div><p>The Git Webhook Trigger should use the same repo as the GitHub App used in your Connector.</p><p>You can see the build stages status in the GitHub PR view.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/nze5evmqu1/1614885820295/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p></p>