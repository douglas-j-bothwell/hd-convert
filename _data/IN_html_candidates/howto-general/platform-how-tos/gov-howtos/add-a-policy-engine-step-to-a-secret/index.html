<div class="note-callout">Currently, this feature is behind the feature flag <code>OPA_SECRET_GOVERNANCE</code>. Contact <a href="mailto:support@harness.io" target="_blank">Harness Support</a> to enable the feature.</div><p>Harness provides governance using Open Policy Agent (OPA), Policy Management, and Rego policies.</p><p>You can create the policy and apply it to all Secrets in your Account, Org, and Project. The policy is evaluated on Secret-level events like <strong>On Save,</strong> which occurs during Secret Creation and Updates. See <a href="/article/jws2znftay-harness-governance-quickstart">Harness Governance Quickstart</a>.​</p><p>This topic describes how to add a Policy step to a Secret.</p><h3>Before You Begin</h3><ul><li><a href="/article/1d3lmhv4jl-harness-governance-overview">Harness Governance Overview</a></li><li><a href="/article/jws2znftay-harness-governance-quickstart">Harness Governance Quickstart</a>.</li><li>Policies use OPA authoring language Rego. For more information, see <a href="https://academy.styra.com/courses/opa-rego">OPA Policy Authoring</a>.</li></ul><h3>Limitations</h3><ul><li>The policies that can be enforced are currently restricted by the Harness entities supported by the OPA service.</li></ul><h3>Step 1: Add a Policy</h3><p>In Harness, go to <strong>Account Settings</strong>.</p><p>Click <strong>Policies</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/4kuokatvyw/1652792608062/screenshot-2022-05-17-at-5-06-58-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Click <strong>Policies</strong>, and then click <strong>New Policy</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/4kuokatvyw/1652787608928/screenshot-2022-05-17-at-5-09-33-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p><strong>New Policy</strong> settings appear.</p><p>Enter a <strong>Name</strong> for your policy and click <strong>Apply</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/4kuokatvyw/1652787747420/screenshot-2022-05-17-at-5-11-32-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Next, you need to add your policy. Enter your own Rego policy. For example:</p><pre>package docexamplepolicy<br/><br/>deny { <br/>     input.secret.description = &#34;Secret description&#34;<br/>     }</pre><p></p><p>Click <strong>Save</strong>.</p><h3>Step 2: Add the Policy to a Policy Set</h3><p>After you create your policy, you must add it to a Policy Set before applying it to your Secrets.</p><p>In <strong>Policies</strong>, click <strong>Policy Sets</strong>, then click <strong>New Policy Set</strong>.</p><p>The <strong>Policy Set</strong> settings appear.</p><p>In <strong>Name</strong>, enter the name of the Policy Set.</p><p>In <strong>Description</strong>, enter a description of the Policy Set.</p><p>In <strong>Entity type</strong>, select <strong>Secret</strong>.</p><p>In <strong>On what event should the Policy Set be evaluated</strong>, select <strong>On save.</strong></p><p>Click <strong>Continue</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/ozw30qez44/1656667001970/screenshot-2022-07-01-at-2-46-09-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><div class="note-callout">Existing Secrets are not automatically updated with policies. Policies can be applied to Secrets only on a save when they are created or updated.</div><p>In <strong>Policy evaluation criteria</strong>, click <strong>Add Policy.</strong></p><p><strong>Select Policy</strong> settings appear. Select the policy you want to use from the list.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/ozw30qez44/1656667324701/screenshot-2022-07-01-at-2-51-28-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p> </p><p>Select the severity and action you want to apply when the policy isn’t adhered to. You can select one of the following</p><ul><li><strong>Warn &amp; continue</strong> - You will receive a warning if the policy is not met when the Secret is evaluated, but the Secret will be saved and you may proceed.</li><li><strong>Error and exit</strong> - You&#39;ll get an error and be exited without saving the Secret if the policy isn&#39;t met when the Secret is examined.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/ozw30qez44/1656667402618/screenshot-2022-07-01-at-2-52-46-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li></ul><p>Click <strong>Apply</strong>, and then click <strong>Finish</strong>.</p><p>To enforce your Policy Set, toggle on the <strong>Enforced</strong> button.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/ozw30qez44/1656667523236/screenshot-2022-07-01-at-2-54-19-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><h3>Step 3: Apply the Policy to a Secret</h3><p>After you have created your Policy Set, and added your policies to it, apply the policy to a Secret. </p><p>Let us look at an example.</p><p>You can add a Secret from any module in your Project in Project setup, or in your Organization, or Account Resources.</p><p>In Account Resources, click <strong>Secrets</strong>.</p><p>Click <strong>New Secret</strong>, and then click <strong>Text</strong>.</p><p>Enter all the required fields and click <strong>Save and Continue</strong>.</p><p>Based on your selection in the Policy Evaluation criteria, you will either receive a warning or an error.</p><h3>See Also</h3><ul><li><a href="/article/4vx27jqwv2-harness-policy-engine">​Harness Policy As Code Overview​</a></li></ul><p></p>