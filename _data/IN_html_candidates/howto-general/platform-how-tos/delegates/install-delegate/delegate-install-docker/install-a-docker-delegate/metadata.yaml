type: article
article_id: cya29w2b99
user_id: mfr0nxh4be
category_id: cybg19aoxt
author:
  name: Michael Cretzman
  profile_image: https://www.gravatar.com/avatar/2e8616837f4ee92be5d19ffe9b9ccba9?d=mm&s=150
title: Install a Docker Delegate
slug: install-a-docker-delegate
description: Install a Docker Delegate.
short_version: Install a Docker Delegate.
tags: []
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: ""
  source: API
  triggered_at: 2022-09-07T19:33:21.929083Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Install a Docker Delegate
  description: Install a Docker Delegate.
  short_version: Install a Docker Delegate.
  body: '<p>The Harness Delegate is a worker process you run in your deployment target
    environment, such as your local network, VPC, or cluster. The Delegate connects
    all of your artifact, infrastructure, collaboration, verification and other providers
    with the Harness Manager.</p><p>Most importantly, the Delegate performs all deployment
    operations.</p><p>There are several types of Delegates. This topic describes how
    to install the Docker Delegate.</p><p>In this topic:</p><ul><li><a href="https://ngdocs.harness.io/article/cya29w2b99-install-a-docker-delegate#before_you_begin">Before
    You Begin</a></li><li><a href="https://ngdocs.harness.io/article/cya29w2b99-install-a-docker-delegate#review_system_requirements">Review:
    System Requirements</a></li><li><a href="https://ngdocs.harness.io/article/cya29w2b99-install-a-docker-delegate#step_1_download_the_docker_delegate">Step
    1: Download the Docker Delegate</a></li><li><a href="https://ngdocs.harness.io/article/cya29w2b99-install-a-docker-delegate#step_2_name_and_tag_the_delegate">Step
    2: Name and Tag the Delegate</a></li><li><a href="https://ngdocs.harness.io/article/cya29w2b99-install-a-docker-delegate#step_3_run_the_docker_delegate_script">Step
    3: Run the Docker Delegate Script</a></li><li><a href="https://ngdocs.harness.io/article/cya29w2b99-install-a-docker-delegate#harness_docker_delegate_environment_variables">Harness
    Docker Delegate Environment Variables</a></li><li><a href="https://ngdocs.harness.io/article/cya29w2b99-install-a-docker-delegate#see_also">See
    Also</a></li></ul><h3>Before You Begin</h3><ul><li><a href="/article/re8kk0ex4k-delegate-installation-overview">Delegate
    Installation Overview</a></li><li><a href="/article/7fibxie636-projects-and-organizations">Projects
    and Organizations</a></li></ul><h3>Review: System Requirements</h3><p>The Docker
    Delegate has the following system requirements:</p><ul><li>Default 0.5 CPU.</li><li>Default
    768MB RAM: there is a cap of 768MB per Delegate, but when the Delegate is updating
    there might be two Delegates running. Hence, the minimum is 1.5GB. Ensure that
    you provide the minimum memory for the Delegate and enough memory for the host/node
    system.</li></ul><h3>Step 1: Download the Docker Delegate</h3><p>The Delegate
    can be installed at the Harness account, Organization, or Project level.</p><p>You
    can install a Delegate as part of setting up a Connector or independent of another
    process.</p><p>Once you have selected <strong>New Delegate</strong> on a Delegates
    page or as part of setting up a Connector, the Delegates selection page appears.</p><p></p><figure><img
    src="https://files.helpdocs.io/i5nl071jo5/articles/cya29w2b99/1638577754456/clean-shot-2021-12-03-at-16-29-06.png"/></figure><p>Click
    <strong>Docker</strong> and then click <strong>Continue</strong>.</p><h3>Step
    2: Name and Tag the Delegate</h3><p>Enter a name for the Delegate. This is the
    name you will see when the Delegate is listed in Harness.</p><div class="note-callout"><strong>Do
    not run Delegates with the same name in different clusters.</strong> See <a href="/article/jzklic4y2j-troubleshooting">Troubleshooting</a>.</div><p>Add
    Tags to the Delegate. By default, Harness adds a Tag using the name you enter,
    but you can more. Simply type them in and press Enter.</p><p>These Tags are useful
    for selecting the Delegate when creating a Connector.</p><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cya29w2b99/1638578173136/clean-shot-2021-12-03-at-16-35-44.png"/></figure><p>Click
    <strong>Continue</strong>.</p><h3>Step 3: Run the Docker Delegate Script</h3><div
    class="note-callout">If you system already has a Delegate image, then Harness
    doesn&#39;t pull the latest image when you run <code>docker-compose</code>. Simply
    run <code>docker pull harness/delegate</code> to pull the latest.</div><p>Now
    you can see the YAML file for the Delegate:</p><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cya29w2b99/1638578232318/clean-shot-2021-12-03-at-16-37-03.png"/></figure><p></p><p>Click
    <strong>Download YAML file</strong> and copy the Docker compose file to a machine
    where you have Docker installed.</p><p>Run the following command to install the
    Delegate in Docker:</p><pre>docker-compose -f docker-compose.yaml up -d</pre><p></p><p>The
    Delegate installs. Type docker ps to see the container:</p><pre>CONTAINER ID        IMAGE                     COMMAND                  CREATED             STATUS                          PORTS                    NAMES<br/>6b242707a57a        harness/delegate:latest   &#34;/bin/sh
    -c &#39;./entry…&#34;   3 days ago          Up 32 seconds                                            local-docker_harness-ng-del</pre><p></p><h4>Verification</h4><p>For
    an overview of verification, see <a href="https://ngdocs.harness.io/article/39tx85rekj-delegate-registration">Delegate
    Registration and Verification</a>.</p><p>In the Delegate wizard, click <strong>Verify</strong> and
    Harness will verify that it is receiving heartbeats from the Delegate.</p><p>Your
    Delegate is installed.</p><p>You can see the registered Delegate in the Delegate
    list.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cya29w2b99/1638578803630/clean-shot-2021-12-03-at-16-46-21.png"/></figure><p>Note
    the <strong>Connected</strong> status. If there is a connectivity error, you will
    see <strong>Not Connected</strong>. If there&#39;s an error, ensure the Docker
    host can connect to <code>https://app.harness.io</code>.</p><p>That&#39;s it.
    The Delegate is installed and registered and connected.</p><h3>Harness Docker
    Delegate Environment Variables</h3><p>The following table lists each of the environment
    variables in the Harness Docker Delegate YAML.</p><p></p><table style="table-layout:fixed;width:100%"><tbody><tr><td><p><strong>Name</strong></p></td><td><p><strong>Description</strong></p></td><td
    style="word-wrap:break-word"><p><strong>Example</strong></p></td></tr><tr><td><p><code>ACCOUNT_ID</code></p></td><td><p>The
    Harness account Id for the account where this Delegate will attempt to register.</p></td><td><pre>-
    ACCOUNT_ID=H5W8i2828282828Xg</pre></td></tr><tr><td><p><code>ACCOUNT_SECRET</code></p></td><td><p>The
    Harness account token used to register the Delegate.</p></td><td><pre>- ACCOUNT_SECRET=d229ee88bf7bbxxxx6ea</pre></td></tr><tr><td><p><code>MANAGER_HOST_AND_PORT</code></p></td><td><p>The
    Harness SaaS manager URL. <code>https</code> indicates port 443.</p></td><td><pre>-
    MANAGER_HOST_AND_PORT=https://app.harness.io</pre></td></tr><tr><td><p><code>WATCHER_STORAGE_URL</code></p></td><td><p>The
    URL for the Watcher versions.</p><p>See <a href="/article/re8kk0ex4k-delegate-installation-overview">Delegate
    Installation Overview</a>.</p></td><td><pre>- WATCHER_STORAGE_URL=https://app.harness.io/public/prod/premium/watchers</pre></td></tr><tr><td><p><code>WATCHER_CHECK_LOCATION</code></p></td><td><p>The
    Delegate version location for the Watcher to check for.</p></td><td><pre>- name:
    WATCHER_CHECK_LOCATION<br/>  value: current.version</pre></td></tr><tr><td><p><code>REMOTE_WATCHER_URL_CDN</code></p></td><td><p>The
    CDN URL for Watcher builds.</p></td><td><pre>- name: REMOTE_WATCHER_URL_CDN<br/>  value:
    https://app.harness.io/public/shared/watchers/builds</pre></td></tr><tr><td><p><code>DELEGATE_STORAGE_URL</code></p></td><td><p>The
    URL where published Delegate jars are stored.</p></td><td><pre>- name: DELEGATE_STORAGE_URL<br/>  value:
    https://app.harness.io</pre></td></tr><tr><td><p><code>DELEGATE_CHECK_LOCATION</code></p></td><td><p>The
    storage location hosting the published Delegate versions.</p></td><td><pre>- name:
    DELEGATE_CHECK_LOCATION<br/>  value: delegateprod.txt</pre></td></tr><tr><td><p><code>DEPLOY_MODE</code></p></td><td><p>Deployment
    mode: Kubernetes, Docker, etc.</p></td><td><pre>- name: DEPLOY_MODE<br/>  value:
    DOCKER</pre></td></tr><tr><td><p><code>DELEGATE_NAME</code></p></td><td><p>The
    name of the Delegate. This is the name that will appear in Harness when the Delegate
    is registered.</p><p>You can automate Delegate creation by omitting the name,
    and then have a script copying the Delegate YAML file and add a unique name to
    <code>value</code> for each new Delegate you want to register.</p><p>See <a href="/article/9deaame3qz-automate-delegate-installation">Automate
    Delegate Installation</a>.</p></td><td><pre>- name: DELEGATE_NAME<br/>  value:
    qa</pre></td></tr><tr><td><p><code>NEXT_GEN</code></p></td><td><p>Indicates that
    this Delegate will register in <a href="/article/ra3nqcdbaf-compare-first-gen-and-next-gen">Harness
    NextGen</a>.</p><p>If it set to <code>false</code>, the Delegate will attempt
    to register in Harness FirstGen.</p></td><td><pre>- name: NEXT_GEN<br/>  value:
    &#34;true&#34;</pre></td></tr><tr><td><p><code>DELEGATE_DESCRIPTION</code></p></td><td><p>The
    description added to the Delegate in the Harness Manager or YAML before registering.</p><p>It
    appears in the Delegate details page in the Harness Manager.</p></td><td><pre>-
    name: DELEGATE_DESCRIPTION<br/>  value: &#34;&#34;</pre></td></tr><tr><td><p><code>DELEGATE_TYPE</code></p></td><td><p>The
    type of Delegate.</p></td><td><pre>- name: DELEGATE_TYPE<br/>  value: &#34;DOCKER&#34;</pre></td></tr><tr><td><p><code>DELEGATE_TAGS</code></p></td><td><p>The
    Tags added to the Delegate in the Harness Manager or YAML before registering.</p><p>Tags
    are generated by Harness using the Delegate name but you can also add your own
    Tags.</p><p>Tags appear in the Delegate details page in the Harness Manager.</p><p>See
    <a href="/article/i8t053o0sq-tags-reference">Tags Reference</a> and <a href="/article/nnuf8yv13o-select-delegates-with-selectors">Select
    Delegates with Tags</a>.</p></td><td><pre>- name: DELEGATE_TAGS<br/>  value: &#34;&#34;</pre></td></tr><tr><td><p><code>DELEGATE_TASK_LIMIT</code></p></td><td><p>The
    maximum number of tasks the Delegate can perform at once.</p><p>All of the operations
    performed by the Delegate are categorized as different types of tasks.</p></td><td><pre>-
    name: DELEGATE_TASK_LIMIT<br/>  value: &#34;50&#34;</pre></td></tr><tr><td><p><code>DELEGATE_ORG_IDENTIFIER</code></p></td><td><p>The
    Harness Organization <a href="/article/li0my8tcz3-entity-identifier-reference">Identifier</a>
    where the Delegate will register.</p><p>Delegates at the account-level do not
    have a value for this variable.</p></td><td><pre>- name: DELEGATE_ORG_IDENTIFIER<br/>  value:
    &#34;engg&#34;</pre></td></tr><tr><td><p><code>DELEGATE_PROJECT_IDENTIFIER</code></p></td><td><p>The
    Harness Project <a href="/article/li0my8tcz3-entity-identifier-reference">Identifier</a>
    where the Delegate will register.</p><p>Delegates at the account or Org-level
    do not have a value for this variable.</p></td><td><pre>- name: DELEGATE_PROJECT_IDENTIFIER<br/>  value:
    &#34;myproject&#34;</pre></td></tr><tr><td><p><code>PROXY_MANAGER</code></p></td><td><p>Indicates
    whether to use the Harness Manager or a proxy. If you use <code>true</code> (the
    default) you are indicating that you proxy outbound traffic to Harness.</p></td><td><pre>-
    PROXY_MANAGER=true</pre></td></tr><tr><td><p><code>INIT_SCRIPT</code></p></td><td><p>You
    can run scripts on the Delegate using <code>INIT_SCRIPT</code>.</p><p>For example,
    if you wanted to install software on the Delegate pod, you can enter the script
    in <code>INIT_SCRIPT</code> and then apply the Delegate YAML.</p><p>A multiline
    script must follow the YAML spec for <a href="https://yaml.org/spec/1.2-old/spec.html#id2795688"
    target="_blank">literal scalar style</a>.</p><p>See <a href="/article/yte6x6cyhn-run-scripts-on-delegates">Run
    Scripts on Delegates</a>.</p></td><td><p></p><pre>- |<br/>  INIT_SCRIPT=<br/>  echo
    hello world!</pre></td></tr><tr><td><p><code>USE_CDN</code></p></td><td><p>Makes
    the Delegate use a CDN for new versions.</p></td><td><pre>- name: USE_CDN<br/>  value:
    &#34;true&#34;</pre></td></tr><tr><td><p><code>CDN_URL</code></p></td><td><p>The
    CDN URL for Delegate versions.</p></td><td><pre>- name: CDN_URL<br/>  value: https://app.harness.io</pre></td></tr><tr><td><p><code>VERSION_CHECK_DISABLED</code></p></td><td><p>By
    default, the Delegate always checks for new versions (via the Watcher).</p></td><td><pre>-
    name: VERSION_CHECK_DISABLED<br/>  value: &#34;false&#34;</pre></td></tr></tbody></table><p></p><p></p><h3>See
    Also</h3><ul><li><a href="/article/9deaame3qz-automate-delegate-installation">Automate
    Delegate Installation</a></li></ul><p></p>'
  slug: install-a-docker-delegate
  tags: []
  is_live: true
