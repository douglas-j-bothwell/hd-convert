<p>By default, Harness Kubernetes Delegates deploy to all namespaces in a Kubernetes cluster. This topic describes how to configure Kubernetes Delegates to deploy into specific namespaces.</p>
<p>In this topic:</p>
<ul>
  <li><a href="#before_you_begin">Before You Begin</a></li>
  <li><a href="#visual_summary">Visual Summary</a>
    <ul>
      <li><a href="#central_model">Central Model</a></li>
      <li><a href="#distributed_model">Distributed Model</a></li>
    </ul>
  </li>
  <li><a href="#review_harness_connections_to_kubernetes">Review: Harness Connections to Kubernetes</a>
    <ul>
      <li><a href="#inherit_from_selected_delegate">Inherit from selected Delegate</a></li>
      <li><a href="#enter_manually">Enter Manually</a></li>
    </ul>
  </li>
  <li><a href="#step_1_create_service_account">Step 1: Create Service Account</a></li>
  <li><a href="#step_2_create_role_and_role_binding">Step 2: Create Role and RoleBinding</a></li>
  <li><a href="#option_1_use_the_service_account_token">Option 1: Use the Service Account Token</a></li>
  <li><a href="#option_2_add_service_account_to_delegate_spec">Option 2: Add Service Account to Delegate Spec</a></li>
  <li><a href="#notes">Notes</a></li>
  <li><a href="#see_also">See Also</a></li>
</ul>
<h3>Before You Begin</h3>
<ul>
  <li><a href="/article/2k7lnc7lvl-delegates-overview">Delegates Overview</a></li>
  <li><a href="/article/f9bd10b3nj-install-a-kubernetes-delegate">Install a Kubernetes Delegate</a></li>
</ul>
<h3>Visual Summary</h3>
<p>Let&#39;s take a quick look at the two ways the Delegate can deploy to namespaces in a cluster.</p>
<h4>Central Model</h4>
<p>By default, the Delegate resides in a namespace in the target cluster with a service account attached to it. The service account uses a ClusterRole for permission to deploy to all namespaces in the cluster.</p>
<p>The is called this the central model. Here&#39;s a simple illustration of the central model:</p>
<p></p>
<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/p91u0bxtaf/1581641324015/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure>
<p>The central model is simple and efficient, but it doesn&#39;t let you restrict teams to deploying into specific namespaces. Any team member can deploy to any namespace.</p>
<p>As an alternative, you can use a distributed model.</p>
<h4>Distributed Model</h4>
<p>This model places a Delegate in each namespace in the cluster. It limits each Delegate to deploying into its own namespace.</p>
<p>Here&#39;s the illustration of the distributed model:</p>
<p></p>
<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/p91u0bxtaf/1581641790397/image.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure>
<p>In this model, each team uses their own Delegate for their deployments into their own namespace.</p>
<p>The distributed model is more complex, but it prevents a team member from deploying into the wrong namespace.</p>
<h3>Review: Harness Connections to Kubernetes</h3>
<p>First, we&#39;ll review how Harness connects to the target Kubernetes cluster using the Delegate.</p>
<p>For the Delegate to perform operations on a target Kubernetes cluster, it requires one of the following:</p>
<ul>
  <li>A service account. The default service account created by the Kubernetes and Helm Delegates uses the Kubernetes <strong>cluster-admin</strong> role.</li>
  <li>Service account token.</li>
  <li>Username and password.</li>
  <li>CA certificate, client certificate, and client key.</li>
</ul>
<p>For this topic, we&#39;ll focus on the service account.</p>
<p>The Harness Kubernetes and Helm Delegates are designed to create the Kubernetes resources they need when you install them. This includes the namespace, service account, and a ClusterRole that enables the Delegate to deploy to any namespaces in the cluster.</p><pre>apiVersion: rbac.authorization.k8s.io/v1<br/>kind: ClusterRoleBinding<br/>metadata:<br/>  name: harness-delegate-ng-cluster-admin<br/>subjects:<br/>  - kind: ServiceAccount<br/>    name: default<br/>    namespace: harness-delegate-ng<br/>roleRef:<br/>  kind: ClusterRole<br/>  name: cluster-admin<br/>  apiGroup: rbac.authorization.k8s.io</pre>
<p></p>
<p>This ClusterRoleBinding binds the service account with the <strong>cluster-admin</strong> ClusterRole. The cluster-admin ClusterRole exists by default in your Kubernetes cluster, and allows superuser operations in all of the cluster resources.</p>
<div class="note-callout">For other type of Delegates (Shell Script, Docker), you need to create the Kubernetes resources yourself and then use the service account when setting up the Harness Kubernetes Cluster Connector.</div>
<p>Once a Delegate is installed and running, you can add a Harness Kubernetes Cluster Connector to connect to the target cluster.</p>
<p>There are two ways for the Kubernetes Cluster Connector to get credentials:</p>
<ul>
  <li>Inherit from selected Delegate</li>
  <li>Enter manually</li>
</ul>
<p>See <a href="/article/sjjik49xww-kubernetes-cluster-connector-settings-reference">Kubernetes Cluster Connector Settings Reference</a>.</p>
<p>Both methods can use the service account to provide either the central or distributed models.</p>
<h4>Inherit from selected Delegate</h4>
<p><strong>Supported Delegate types:</strong> Kubernetes, ECS, and Helm Delegate.</p>
<div class="note-callout">The ECS and Helm Delegates haven&#39;t been added to Harness NextGen at this time.</div>
<p>In this option, the Connector inherits the service account created when you installed the Delegate.</p>
<h4>Enter Manually</h4>
<p><strong>Supported Delegate types:</strong> Shell Script, Docker, ECS, Kubernetes, Helm.</p>
<div class="note-callout">The Shell Script, Docker, ECS, and Helm Delegates haven&#39;t been added to Harness NextGen at this time.</div>
<p>In this option, the Connector uses the credentials that you enter manually. The Delegate uses these credentials to send deployment tasks to the cluster.</p>
<p>The Delegate can be outside or within the target cluster. </p>
<p>Some examples:</p>
<ul>
  <li>Shell Script Delegate on a VM.</li>
  <li>Docker Image Delegate outside the target cluster. </li>
  <li>Kubernetes Delegate in a pod outside the target cluster. </li>
</ul>
<div class="note-callout">Providing the <strong>Master URL</strong> is mandatory. This is the Kubernetes master node URL.</div>
<p>The remaining steps in this topic explain how to create the Kubernetes resources needed for the service account used by the Delegates in the distributed model.</p>
<h3>Step 1: Create Service Account</h3>
<p>To restrict the Delegate to deploy to a specific namespace, first you create the namespace, if it isn&#39;t already created.</p><pre>apiVersion: v1<br/>kind: Namespace<br/>metadata:<br/>  name: mynamespace</pre>
<p></p>
<p>Next, you create the service account in that namespace for the Delegate.</p>
<p></p><pre>apiVersion: v1<br/>kind: ServiceAccount<br/>metadata:<br/>  name: mynamespace-delegate-sa<br/>  namespace: mynamespace</pre>
<h3>Step 2: Create Role and RoleBinding</h3>
<p>By default, the Delegate can deploy to all namespaces. Its service account uses the <strong>cluster-admin</strong> ClusterRole. This method enables the central model.</p>
<p>In the distributed model, you restrict the Delegate to a specific namespace by using the following:</p>
<ul>
  <li>A Role in the namespace that grants access to items in that namespace only.</li>
  <li>A RoleBinding in the namespace. It binds the Role in that namespace to the service account you created.</li>
</ul><pre>kind: Role<br/>apiVersion: rbac.authorization.k8s.io/v1beta1<br/>metadata:<br/>  name: default-full-access<br/>  namespace: mynamespace<br/>rules:<br/>- apiGroups: [&#34;&#34;, &#34;extensions&#34;, &#34;apps&#34;, &#34;autoscaling&#34;, &#34;rbac.authorization.k8s.io&#34;, &#34;roles.rbac.authorization.k8s.io&#34;]<br/>  resources: [&#34;*&#34;]<br/>  verbs: [&#34;*&#34;]<br/>- apiGroups: [&#34;batch&#34;]<br/>  resources:<br/>  - jobs<br/>  - cronjobs<br/>  verbs: [&#34;*&#34;]<br/> <br/>---<br/>kind: RoleBinding<br/>apiVersion: rbac.authorization.k8s.io/v1beta1<br/>metadata:<br/>  name: default-view<br/>  namespace: mynamespace<br/>subjects:<br/>- kind: ServiceAccount<br/>  name: mynamespace-delegate-sa<br/>  namespace: mynamespace<br/>roleRef:<br/>  apiGroup: rbac.authorization.k8s.io<br/>  kind: Role<br/>  name: default-full-access</pre>
<p></p>
<p>The service account is bound to a Role that limits it to the namespace.</p>
<p>Now you have two options:</p>
<ul>
  <li><strong>Option 1:</strong> Install a Delegate outside the namespace and simply enter the service account token in the Kubernetes Cluster Connector.</li>
  <li><strong>Option 2:</strong> Install a Kubernetes Delegate in the namespace using the service account. You simply reference the service account in the Delegate spec. You can then have the Kubernetes Cluster Connector inherit credentials from the Delegate.</li>
</ul>
<h3>Option 1: Use the Service Account Token</h3>
<p>If you are using the <strong>Specify master URL and credentials</strong> option in the Kubernetes Connector, select <strong>Service Account</strong> in <strong>Authentication</strong>, and then use the service account in the <strong>Service Account Token</strong> setting.</p>
<p></p>
<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/jud4rz7wl4/1630366270099/clean-shot-2021-08-30-at-16-30-44.png"/></figure>
<p>The following shell script is a quick method for obtaining the service account token. Run this script wherever you run kubectl to access the cluster.</p>
<p>Set the <code>SERVICE_ACCOUNT_NAME</code> and <code>NAMESPACE</code> values to the values in your infrastructure:</p><pre>SERVICE_ACCOUNT_NAME=default<br/>NAMESPACE=mynamespace<br/>SECRET_NAME=$(kubectl get sa &#34;${SERVICE_ACCOUNT_NAME}&#34; --namespace &#34;${NAMESPACE}&#34; -o json | jq -r &#39;.secrets[].name&#39;)<br/>TOKEN=$(kubectl get secret &#34;${SECRET_NAME}&#34; --namespace &#34;${NAMESPACE}&#34; -o json | jq -r &#39;.data[&#34;token&#34;]&#39; | base64 -d)<br/>echo $TOKEN</pre>
<p></p>
<p>Next, enter the service account token in the Kubernetes Cluster Connector.</p>
<h3>Option 2: Add Service Account to Delegate Spec</h3>
<p>In you are using the <strong>Use the credentials of a specific Harness Delegate</strong> option in the Kubernetes Connector, add the service account to the Delegate YAML. See <code>serviceAccountName: mynamespace-delegate-sa</code> below:</p><pre>---<br/>apiVersion: apps/v1<br/>kind: StatefulSet<br/>metadata:<br/>  labels:<br/>    harness.io/app: harness-delegate<br/>    harness.io/account: wsxvws<br/>    harness.io/name: demo-delegate<br/>  # Name must contain the six letter account identifier: wsxvws<br/>  name: demo-delegate-wsxvws<br/>  namespace: harness-delegate<br/>spec:<br/><strong>  serviceAccountName: mynamespace-delegate-sa</strong><br/>  replicas: 1<br/>...</pre>
<p></p>
<p>When you download the Kubernetes Delegate YAML from Harness, you get the TAR file. Once you extract the file, you get the harness-delegate.yaml file.</p>
<p>By default, the harness-delegate.yaml uses a role with the <code>default</code> service account and <code>harness-delegate-ng</code> namespace.</p>
<p>As discussed above, to restrict the Delegate to a single namespace, you&#39;ll create a namespace, service account, Role, and RoleBinding, and then reference the service account in the Delegate spec.</p>
<p>Edit the harness-delegate.yaml file to create these new resources.</p>
<p>Here is an example of the Kubernetes Delegate YAML that creates all the necessary resources (account information should be changed):</p>
<div class="hd--md" data-hd-markdown="&lt;details&gt;
  &lt;summary style=&#34;font-size: 1.25rem;outline: none;border: none; color: #00adea; margin-bottom:20px&#34;&gt;Kubernetes Delegate YAML Sample&lt;/summary&gt;

&lt;pre&gt;
apiVersion: v1
kind: Namespace
metadata:
  name: mynamespace

---
apiVersion: v1
kind: ServiceAccount
metadata:
  name: mynamespace-delegate-sa
  namespace: mynamespace

---
kind: Role
apiVersion: rbac.authorization.k8s.io/v1beta1
metadata:
  name: default-full-access
  namespace: mynamespace
rules:
- apiGroups: [&#34;&#34;, &#34;extensions&#34;, &#34;apps&#34;, &#34;autoscaling&#34;, &#34;rbac.authorization.k8s.io&#34;, &#34;roles.rbac.authorization.k8s.io&#34;]
  resources: [&#34;*&#34;]
  verbs: [&#34;*&#34;]
- apiGroups: [&#34;batch&#34;]
  resources:
  - jobs
  - cronjobs
  verbs: [&#34;*&#34;]
 
---
kind: RoleBinding
apiVersion: rbac.authorization.k8s.io/v1beta1
metadata:
  name: default-view
  namespace: mynamespace
subjects:
- kind: ServiceAccount
  name: mynamespace-delegate-sa
  namespace: mynamespace
roleRef:
  apiGroup: rbac.authorization.k8s.io
  kind: Role
  name: default-full-access
  
---
apiVersion: v1
kind: Secret
metadata:
  name: demo-delegate-proxy
  namespace: mynamespace
  kubernetes.io/service-account.name: mynamespace-delegate-sa
type: Opaque
data:
  # Enter base64 encoded username and password, if needed
  PROXY_USER: &#34;&#34;
  PROXY_PASSWORD: &#34;&#34;

---
apiVersion: apps/v1
kind: StatefulSet
metadata:
  labels:
    harness.io/app: harness-delegate
    harness.io/account: wsxvws
    harness.io/name: demo-delegate
  # Name must contain the six letter account identifier: wsxvws
  name: demo-delegate-wsxvws
  namespace: harness-delegate
spec:
  serviceAccountName: mynamespace-delegate-sa
  replicas: 1
  selector:
    matchLabels:
      harness.io/app: harness-delegate
      harness.io/account: wsxvws
      harness.io/name: demo-delegate
  serviceName: &#34;&#34;
  template:
    metadata:
      labels:
        harness.io/app: harness-delegate
        harness.io/account: wsxvws
        harness.io/name: demo-delegate
    spec:
      containers:
      - image: harness/delegate:latest
        imagePullPolicy: Always
        name: harness-delegate-instance
        resources:
          limits:
            cpu: &#34;1&#34;
            memory: &#34;8Gi&#34;
        readinessProbe:
          exec:
            command:
              - test
              - -s
              - delegate.log
          initialDelaySeconds: 20
          periodSeconds: 10
        livenessProbe:
          exec:
            command:
              - bash
              - -c
              - &#39;[[ -e /opt/harness-delegate/msg/data/watcher-data &amp;&amp; $(($(date +%s000) - $(grep heartbeat /opt/harness-delegate/msg/data/watcher-data | cut -d &#34;:&#34; -f 2 | cut -d &#34;,&#34; -f 1))) -lt 300000 ]]&#39;
          initialDelaySeconds: 240
          periodSeconds: 10
          failureThreshold: 2
        env:
        - name: ACCOUNT_ID
          value: wsxvws
        - name: ACCOUNT_SECRET
          value: 123abc
        - name: MANAGER_HOST_AND_PORT
          value: https://qa.harness.io
        - name: WATCHER_STORAGE_URL
          value: https://qa.harness.io/public/qa/premium/watchers
        - name: WATCHER_CHECK_LOCATION
          value: current.version
        - name: REMOTE_WATCHER_URL_CDN
          value: https://qa.harness.io/public/shared/watchers/builds
        - name: DELEGATE_STORAGE_URL
          value: https://qa.harness.io
        - name: DELEGATE_CHECK_LOCATION
          value: delegateqa.txt
        - name: DEPLOY_MODE
          value: KUBERNETES
        - name: DELEGATE_NAME
          value: doc-harness-dev-cd
        - name: DELEGATE_GROUP_ID
          value: mVsCmHbzRIqBTQ5HT3OywA
        - name: DELEGATE_DESCRIPTION
          value: &#34;&#34;
        - name: DELEGATE_PROFILE
          value: &#34;7DZBQN8wTG6x3ui-fymHaQ&#34;
        - name: DELEGATE_TYPE
          value: &#34;KUBERNETES&#34;
        - name: DELEGATE_SIZE
          value: &#34;MEDIUM&#34;
        - name: DELEGATE_SESSION_IDENTIFIER
          value: &#34;BMcqW9WlRB2MWbkT27BrUA&#34;
        - name: DELEGATE_TASK_LIMIT
          value: &#34;50&#34;
        - name: DELEGATE_ORG_IDENTIFIER
          value: &#34;default&#34;
        - name: DELEGATE_PROJECT_IDENTIFIER
          value: &#34;Docs&#34;
        - name: PROXY_HOST
          value: &#34;&#34;
        - name: PROXY_PORT
          value: &#34;&#34;
        - name: PROXY_SCHEME
          value: &#34;&#34;
        - name: NO_PROXY
          value: &#34;&#34;
        - name: PROXY_MANAGER
          value: &#34;true&#34;
        - name: PROXY_USER
          valueFrom:
            secretKeyRef:
              name: doc-harness-dev-cd-proxy
              key: PROXY_USER
        - name: PROXY_PASSWORD
          valueFrom:
            secretKeyRef:
              name: doc-harness-dev-cd-proxy
              key: PROXY_PASSWORD
        - name: POLL_FOR_TASKS
          value: &#34;false&#34;
        - name: HELM_DESIRED_VERSION
          value: &#34;&#34;
        - name: CF_PLUGIN_HOME
          value: &#34;&#34;
        - name: USE_CDN
          value: &#34;true&#34;
        - name: CDN_URL
          value: https://qa.harness.io
        - name: JRE_VERSION
          value: 1.8.0_242
        - name: HELM3_PATH
          value: &#34;&#34;
        - name: HELM_PATH
          value: &#34;&#34;
        - name: CF_CLI6_PATH
          value: &#34;&#34;
        - name: CF_CLI7_PATH
          value: &#34;&#34;
        - name: KUSTOMIZE_PATH
          value: &#34;&#34;
        - name: OC_PATH
          value: &#34;&#34;
        - name: KUBECTL_PATH
          value: &#34;&#34;
        - name: ENABlE_CE
          value: &#34;false&#34;
        - name: GRPC_SERVICE_ENABLED
          value: &#34;true&#34;
        - name: GRPC_SERVICE_CONNECTOR_PORT
          value: &#34;8080&#34;
        - name: CLIENT_TOOLS_DOWNLOAD_DISABLED
          value: &#34;false&#34;
        - name: DELEGATE_NAMESPACE
          valueFrom:
            fieldRef:
              fieldPath: metadata.namespace
      restartPolicy: Always

&lt;/pre&gt;

&lt;/details&gt;">
  <details>
    <summary style="font-size: 1.25rem;outline: none;border: none; color: #00adea; margin-bottom:20px">Kubernetes Delegate YAML Sample</summary>
    <pre><br/>
apiVersion: v1<br/>
kind: Namespace<br/>
metadata:<br/>
  name: mynamespace<br/>
<br/>
---<br/>
apiVersion: v1<br/>
kind: ServiceAccount<br/>
metadata:<br/>
  name: mynamespace-delegate-sa<br/>
  namespace: mynamespace<br/>
<br/>
---<br/>
kind: Role<br/>
apiVersion: rbac.authorization.k8s.io/v1beta1<br/>
metadata:<br/>
  name: default-full-access<br/>
  namespace: mynamespace<br/>
rules:<br/>
- apiGroups: [&#34;&#34;, &#34;extensions&#34;, &#34;apps&#34;, &#34;autoscaling&#34;, &#34;rbac.authorization.k8s.io&#34;, &#34;roles.rbac.authorization.k8s.io&#34;]<br/>
  resources: [&#34;*&#34;]<br/>
  verbs: [&#34;*&#34;]<br/>
- apiGroups: [&#34;batch&#34;]<br/>
  resources:<br/>
  - jobs<br/>
  - cronjobs<br/>
  verbs: [&#34;*&#34;]<br/>
 <br/>
---<br/>
kind: RoleBinding<br/>
apiVersion: rbac.authorization.k8s.io/v1beta1<br/>
metadata:<br/>
  name: default-view<br/>
  namespace: mynamespace<br/>
subjects:<br/>
- kind: ServiceAccount<br/>
  name: mynamespace-delegate-sa<br/>
  namespace: mynamespace<br/>
roleRef:<br/>
  apiGroup: rbac.authorization.k8s.io<br/>
  kind: Role<br/>
  name: default-full-access<br/>
  <br/>
---<br/>
apiVersion: v1<br/>
kind: Secret<br/>
metadata:<br/>
  name: demo-delegate-proxy<br/>
  namespace: mynamespace<br/>
  kubernetes.io/service-account.name: mynamespace-delegate-sa<br/>
type: Opaque<br/>
data:<br/>
  # Enter base64 encoded username and password, if needed<br/>
  PROXY_USER: &#34;&#34;<br/>
  PROXY_PASSWORD: &#34;&#34;<br/>
<br/>
---<br/>
apiVersion: apps/v1<br/>
kind: StatefulSet<br/>
metadata:<br/>
  labels:<br/>
    harness.io/app: harness-delegate<br/>
    harness.io/account: wsxvws<br/>
    harness.io/name: demo-delegate<br/>
  # Name must contain the six letter account identifier: wsxvws<br/>
  name: demo-delegate-wsxvws<br/>
  namespace: harness-delegate<br/>
spec:<br/>
  serviceAccountName: mynamespace-delegate-sa<br/>
  replicas: 1<br/>
  selector:<br/>
    matchLabels:<br/>
      harness.io/app: harness-delegate<br/>
      harness.io/account: wsxvws<br/>
      harness.io/name: demo-delegate<br/>
  serviceName: &#34;&#34;<br/>
  template:<br/>
    metadata:<br/>
      labels:<br/>
        harness.io/app: harness-delegate<br/>
        harness.io/account: wsxvws<br/>
        harness.io/name: demo-delegate<br/>
    spec:<br/>
      containers:<br/>
      - image: harness/delegate:latest<br/>
        imagePullPolicy: Always<br/>
        name: harness-delegate-instance<br/>
        resources:<br/>
          limits:<br/>
            cpu: &#34;1&#34;<br/>
            memory: &#34;8Gi&#34;<br/>
        readinessProbe:<br/>
          exec:<br/>
            command:<br/>
              - test<br/>
              - -s<br/>
              - delegate.log<br/>
          initialDelaySeconds: 20<br/>
          periodSeconds: 10<br/>
        livenessProbe:<br/>
          exec:<br/>
            command:<br/>
              - bash<br/>
              - -c<br/>
              - &#39;[[ -e /opt/harness-delegate/msg/data/watcher-data &amp;&amp; $(($(date +%s000) - $(grep heartbeat /opt/harness-delegate/msg/data/watcher-data | cut -d &#34;:&#34; -f 2 | cut -d &#34;,&#34; -f 1))) -lt 300000 ]]&#39;<br/>
          initialDelaySeconds: 240<br/>
          periodSeconds: 10<br/>
          failureThreshold: 2<br/>
        env:<br/>
        - name: ACCOUNT_ID<br/>
          value: wsxvws<br/>
        - name: ACCOUNT_SECRET<br/>
          value: 123abc<br/>
        - name: MANAGER_HOST_AND_PORT<br/>
          value: https://qa.harness.io<br/>
        - name: WATCHER_STORAGE_URL<br/>
          value: https://qa.harness.io/public/qa/premium/watchers<br/>
        - name: WATCHER_CHECK_LOCATION<br/>
          value: current.version<br/>
        - name: REMOTE_WATCHER_URL_CDN<br/>
          value: https://qa.harness.io/public/shared/watchers/builds<br/>
        - name: DELEGATE_STORAGE_URL<br/>
          value: https://qa.harness.io<br/>
        - name: DELEGATE_CHECK_LOCATION<br/>
          value: delegateqa.txt<br/>
        - name: DEPLOY_MODE<br/>
          value: KUBERNETES<br/>
        - name: DELEGATE_NAME<br/>
          value: doc-harness-dev-cd<br/>
        - name: DELEGATE_GROUP_ID<br/>
          value: mVsCmHbzRIqBTQ5HT3OywA<br/>
        - name: DELEGATE_DESCRIPTION<br/>
          value: &#34;&#34;<br/>
        - name: DELEGATE_PROFILE<br/>
          value: &#34;7DZBQN8wTG6x3ui-fymHaQ&#34;<br/>
        - name: DELEGATE_TYPE<br/>
          value: &#34;KUBERNETES&#34;<br/>
        - name: DELEGATE_SIZE<br/>
          value: &#34;MEDIUM&#34;<br/>
        - name: DELEGATE_SESSION_IDENTIFIER<br/>
          value: &#34;BMcqW9WlRB2MWbkT27BrUA&#34;<br/>
        - name: DELEGATE_TASK_LIMIT<br/>
          value: &#34;50&#34;<br/>
        - name: DELEGATE_ORG_IDENTIFIER<br/>
          value: &#34;default&#34;<br/>
        - name: DELEGATE_PROJECT_IDENTIFIER<br/>
          value: &#34;Docs&#34;<br/>
        - name: PROXY_HOST<br/>
          value: &#34;&#34;<br/>
        - name: PROXY_PORT<br/>
          value: &#34;&#34;<br/>
        - name: PROXY_SCHEME<br/>
          value: &#34;&#34;<br/>
        - name: NO_PROXY<br/>
          value: &#34;&#34;<br/>
        - name: PROXY_MANAGER<br/>
          value: &#34;true&#34;<br/>
        - name: PROXY_USER<br/>
          valueFrom:<br/>
            secretKeyRef:<br/>
              name: doc-harness-dev-cd-proxy<br/>
              key: PROXY_USER<br/>
        - name: PROXY_PASSWORD<br/>
          valueFrom:<br/>
            secretKeyRef:<br/>
              name: doc-harness-dev-cd-proxy<br/>
              key: PROXY_PASSWORD<br/>
        - name: POLL_FOR_TASKS<br/>
          value: &#34;false&#34;<br/>
        - name: HELM_DESIRED_VERSION<br/>
          value: &#34;&#34;<br/>
        - name: CF_PLUGIN_HOME<br/>
          value: &#34;&#34;<br/>
        - name: USE_CDN<br/>
          value: &#34;true&#34;<br/>
        - name: CDN_URL<br/>
          value: https://qa.harness.io<br/>
        - name: JRE_VERSION<br/>
          value: 1.8.0_242<br/>
        - name: HELM3_PATH<br/>
          value: &#34;&#34;<br/>
        - name: HELM_PATH<br/>
          value: &#34;&#34;<br/>
        - name: CF_CLI6_PATH<br/>
          value: &#34;&#34;<br/>
        - name: CF_CLI7_PATH<br/>
          value: &#34;&#34;<br/>
        - name: KUSTOMIZE_PATH<br/>
          value: &#34;&#34;<br/>
        - name: OC_PATH<br/>
          value: &#34;&#34;<br/>
        - name: KUBECTL_PATH<br/>
          value: &#34;&#34;<br/>
        - name: ENABlE_CE<br/>
          value: &#34;false&#34;<br/>
        - name: GRPC_SERVICE_ENABLED<br/>
          value: &#34;true&#34;<br/>
        - name: GRPC_SERVICE_CONNECTOR_PORT<br/>
          value: &#34;8080&#34;<br/>
        - name: CLIENT_TOOLS_DOWNLOAD_DISABLED<br/>
          value: &#34;false&#34;<br/>
        - name: DELEGATE_NAMESPACE<br/>
          valueFrom:<br/>
            fieldRef:<br/>
              fieldPath: metadata.namespace<br/>
      restartPolicy: Always<br/>
<br/>
</pre>
  </details>
</div>
<p>Next, connect to your cluster and run the kubectl command to install the Delegate:</p>
<p><code>kubectl apply -f harness-delegate.yaml</code></p>
<h3>Notes</h3>
<p>You can also enable a Delegate to deploy to namespaces outside its own. In this model, the Delegate doesn&#39;t have to be in the same namespace as the deployment target.</p>
<p>For this method, do the following:</p>
<ol>
  <li>Create a service account for the Delegate in the namespace where you&#39;ll install the Delegate. Let&#39;s call this the <code>delegate-ns</code>. We&#39;ll call the deployment target namespace <code>target</code>.</li>
  <li>Create the service account in namespace <code>delegate-ns</code>.</li>
  <li>Create a Role in namespace <code>target</code>.</li>
  <li>Create a RoleBinding in namespace <code>target</code>, with the following properties:<ol>
      <li>RoleRef pointing to the Role in the same namespace <code>target</code></li>
      <li>Subject pointing to the Delegate service account and namespace: <code>delegate-ns</code>.</li>
    </ol>
  </li>
</ol>
<h3>See Also</h3>
<ul>
  <li><a href="/article/s9j6cggx1p-connect-to-a-cloud-provider">Connect to a Cloud Provider</a></li>
</ul>
<p></p>