<p>You can use Google <a href="https://cloud.google.com/security-key-management" target="_blank">Cloud Key Management Service</a> (Cloud KMS) as a Harness Secret Manager. Once Google KMS is added as a Secrets Manager, you can create encrypted secrets in Google KMS and use them in your Harness account.</p><p>For details on Harness Secret Managers, see <a href="/article/hngrlb7rd6-harness-secret-manager-overview">Harness Secret Manager Overview</a>.</p><p>This topic describes how to add a Google KMS Secret Manager in Harness.</p><h3>Before You Begin</h3><ul><li><a href="/article/hv2758ro4e-learn-harness-key-concepts">Learn Harness&#39; Key Concepts</a></li><li><a href="/article/hngrlb7rd6-harness-secret-manager-overview">Harness Secret Manager Overview</a></li></ul><h3>Add a Secret Manager</h3><p>This topic assumes you have a Harness Project set up. If not, see <a href="/article/36fw2u92i4-create-an-organization">Create Organizations and Projects</a>.</p><p>You can add a Connector from any module in your Project in Project setup, or in your Organization or Account Resources.</p><p>In <strong>Connectors</strong>, click <strong>Connector</strong>.</p><p>In <strong>Secret Managers</strong>, click <strong>GCP KMS</strong> under <strong>Secret Managers</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cyyym9tbqt/1633930160335/screenshot-2021-10-11-at-10-54-51-am.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>The <strong>GCP Key Management Service</strong> settings appear.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cyyym9tbqt/1633535711169/screenshot-2021-10-06-at-9-24-27-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>In <strong>Name,</strong> enter a name for your Secret Manager.  You will use this name to select this Secret Manager when adding or selecting a secret.</p><p>Enter a description for your Secret Manager.</p><p>Enter tags for your Secret Manager.</p><p>Click <strong>Continue</strong>.</p><h3>Obtain Google Cloud Symmetric Key</h3><p>To obtain the values for the Details page, you&#39;ll need a Google Cloud Symmetric Key.</p><p>In the <a href="https://console.cloud.google.com/">Google Cloud Console</a>, select your project.</p><p>Select <strong>Security</strong> &gt; <strong>Key</strong> <strong>Management</strong>.</p><p>Select/create a key ring. Select/create a key in the key ring.</p><div class="tip-callout">To create resources in this or the next step, see Google Cloud&#39;s <a href="https://cloud.google.com/kms/docs/creating-keys" target="_blank">Creating Symmetric Keys</a> topic.</div><p>Open the Actions menu (⋮), then click <strong>Copy Resource Name</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cyyym9tbqt/1633670463751/screenshot-2021-10-08-at-10-49-00-am.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>A reference to the key is now on your clipboard.</p><p>Paste the reference into an editor. You can now copy and paste its substrings into each of the Harness Secret Manager’s <strong>Details</strong> settings as shown below.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cyyym9tbqt/1633693386649/screenshot-2021-10-08-at-5-12-29-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><h3>Attach Service Account Key (Credentials) File</h3><p>Next, you will export your Google Cloud service account key and attach it to the <strong>Details</strong> page in Harness.</p><p>First, you need to grant a Principal the Cloud KMS CryptoKey Encrypter/Decrypter (cloudkms.cryptoKeyEncrypterDecrypter) role.</p><p>In Google Cloud Console, go to the IAM page.</p><p>Locate the Principal you want to use, and click Edit.</p><p>In Edit permissions, add the Cloud KMS CryptoKey Encrypter/Decrypter role and click Save.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cyyym9tbqt/1634892938561/screenshot-2021-10-22-at-11-48-30-am.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>See Google <a href="https://cloud.google.com/kms/docs/reference/permissions-and-roles">Permissions and roles</a> and Cloud&#39;s Using Cloud IAM with KMSCloud&#39;s Using Cloud IAM with KMS topics.</p><p>Next, you&#39;ll select the Service Account for that Principal and export its Key file.</p><p>In the Google Cloud Console, in IAM &amp; Admin, go to Service Accounts.</p><p>Scroll to the service account for the Principal you gave the Cloud KMS CryptoKey Encrypter/Decrypter role. If no service account is present, create one.</p><p>Open your service account&#39;s Actions ⋮ menu, then select <strong>Manage keys</strong>.</p><p>Select <strong>ADD KEY</strong> &gt; <strong>Create new key</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cyyym9tbqt/1633690607040/screenshot-2021-10-08-at-4-22-40-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>In the resulting Create private key dialog, select JSON, create the key, and download it to your computer.</p><p>Return to the Secret Manager&#39;s Details page in Harness.</p><p>Under GCP KMS Credentials File, click <strong>Create or Select a Secret</strong>. You can create a new <a href="https://ngdocs.harness.io/article/77tfo7vtea-add-file-secrets">File Secret</a>  and upload the key file you just exported from Google Cloud.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cyyym9tbqt/1633691386119/screenshot-2021-10-08-at-4-39-07-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>Click <strong>Save</strong> and then <strong>Continue</strong>.</p><h3>Setup Delegates</h3><p>In <strong>Delegates</strong> <strong>Setup</strong><strong>,</strong> use <a href="/article/nnuf8yv13o-select-delegates-with-selectors#option_select_a_delegate_for_a_connector_using_tags"><strong>Selectors</strong></a> to select any specific <strong>Delegates</strong> that you want this Connector to use. Click <strong>Save and Continue.</strong></p><h3>Test Connection</h3><p>In <strong>Connection</strong> <strong>Test</strong>, click <strong>Finish</strong> after your connection is successful<strong>.</strong></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/cyyym9tbqt/1634895260101/screenshot-2021-10-22-at-1-02-10-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p>