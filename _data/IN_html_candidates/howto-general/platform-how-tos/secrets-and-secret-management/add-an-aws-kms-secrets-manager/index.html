<p>To store and use encrypted secrets (such as access keys) and files, you can add an AWS KMS Secret Manager.</p><p>This topic describes how to add an AWS KMS Secret Manager in Harness.</p><p>In this topic:</p><ul><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#before_you_begin">Before You Begin</a></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z-add-an-aws-kms-secrets-manager#step_1_add_secrets_manager">Step 1: Add a Secret Manager</a></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#step_2_overview">Step 2: Overview</a></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#option_credential_type">Option: Credential Type</a></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#option_aws_access_key">Option: AWS Access Key</a><ul><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#aws_access_key_id">AWS Access Key ID</a></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#aws_secret_access_key">AWS Secret Access Key</a></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#aws_arn">AWS ARN</a></li></ul></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#option_assume_iam_role_on_delegate">Option: Assume IAM Role on Delegate</a></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#option_assume_role_using_sts_on_delegate">Option: Assume Role using STS on Delegate</a><ul><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#role_arn">Role ARN</a></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#external_id">External ID</a></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#assume_role_duration_seconds">Assume Role Duration (seconds)</a></li></ul></li><li><a href="https://ngdocs.harness.io/article/pt52h8sb6z#step_3_test_connection">Step 3: Test Connection</a></li></ul><h3>Before You Begin</h3><ul><li><a href="/article/hv2758ro4e-learn-harness-key-concepts">Learn Harness&#39; Key Concepts</a>.</li><li><a href="/article/hngrlb7rd6-harness-secret-manager-overview">Harness Secret Manager Overview</a>.</li></ul><h3>Step 1: Add a Secret Manager</h3><p>This topic assumes you have a Harness Project set up. If not, see <a href="https://ngdocs.harness.io/article/36fw2u92i4-create-an-organization">Create Organizations and Projects</a>.</p><p>You can add a Connector from any module in your Project in Project setup, or in your Organization, or Account Resources.</p><p>In <strong>Connectors</strong>, click <strong>Connector</strong>.</p><p>In <strong>Secret Managers</strong>, click <strong>AWS KMS</strong>. The <strong>AWS Key Management Service</strong> settings appear.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/pt52h8sb6z/1627881928900/aws-key-management-service-dialo.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><h3>Step 2: Overview</h3><p>Enter <strong>Name</strong> for your secret manager.</p><p>You can choose to update the <strong>ID</strong> or let it be the same as your secret manager&#39;s name. For more information, see <a href="/article/li0my8tcz3-entity-identifier-reference">Entity Identifier Reference</a>.</p><p>Enter <strong>Description</strong> for your secret manager.</p><p>Enter <strong>Tags</strong> for your secret manager.</p><p>Click <strong>Continue</strong>.</p><h3>Option: Credential Type</h3><p>You can select the following options for authenticating with AWS:</p><ul><li><strong>AWS Access Key.</strong></li><li><strong>Assume IAM role on delegate.</strong></li><li><strong>Assume Role using STS on delegate.</strong></li></ul><h3>Option: AWS Access Key</h3><p>Use your AWS IAM user login credentials.</p><p>Either from the JSON for the <strong>Key Policy</strong>, or in the AWS <strong>IAM</strong> console, under <strong>Encryption keys,</strong> gather the <strong>AWS Access Key ID</strong>, <strong>AWS Secret Key</strong>, and <strong>Amazon Resource Name (ARN)</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/pt52h8sb6z/1625570818189/screenshot-2021-07-06-at-4-54-51-pm.png" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>For more information, see <a href="https://docs.aws.amazon.com/kms/latest/developerguide/viewing-keys.html#find-cmk-id-arn" target="_blank">Finding the Key ID and ARN</a> from Amazon.</p><h4>AWS Access Key ID</h4><p>Click <strong>Create or Select a Secret</strong>.</p><p>In the secret settings dialog, you can create/select a <a href="/article/osfw70e59c-add-use-text-secrets">Secret</a> and enter your AWS Access Key as it&#39;s value.</p><p>The AWS Access Key is the AWS Access Key ID for the IAM user you want to use to connect to Secret Manager.</p><h4>AWS Secret Access Key</h4><p>Click <strong>Create or Select a Secret</strong>.</p><p>You can create a new <a href="/article/osfw70e59c-add-use-text-secrets">Secret</a> with your Access Key ID&#39;s secret key as the <strong>Secret Value</strong>, or use an existing secret.</p><h4>AWS ARN</h4><p>Click <strong>Create or Select a Secret</strong>.</p><p>As explained above, you can create a new <a href="/article/osfw70e59c-add-use-text-secrets">Secret</a> with your ARN as the <strong>Secret Value</strong>, or use an existing secret.</p><h3>Option: Assume IAM Role on Delegate</h3><p>If you select <strong>Assume the IAM Role on Delegate</strong> Harness will authenticate using the IAM role assigned to the AWS host running the Delegate, you select using a Delegate Selector.</p><h3>Option: Assume Role using STS on Delegate</h3><p>This option uses the <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_credentials_temp.html" target="_blank">AWS Security Token Service</a> (STS) feature. Typically, you use <code>AssumeRole</code> within your account or for AWS cross-account access.</p><h4>Role ARN</h4><p>Enter the Amazon Resource Name (ARN) of the role that you want to assume. This is an IAM role in the target deployment AWS account.</p><h4>External ID</h4><p>If the administrator of the account to which the role belongs provided you with an external ID, then enter that value.</p><p>For more information, see <a href="https://docs.aws.amazon.com/IAM/latest/UserGuide/id_roles_create_for-user_externalid.html">How to Use an External ID When Granting Access to Your AWS Resources to a Third Party</a> from AWS.</p><h4>Assume Role Duration (seconds)</h4><p>This is the AssumeRole Session Duration. See Session Duration in the <a href="https://docs.aws.amazon.com/STS/latest/APIReference/API_AssumeRole.html" target="_blank">AssumeRole AWS docs</a>.</p><h3>Step 3: Setup Delegates</h3><p>In <strong>Delegates</strong> <strong>Setup</strong><strong>,</strong> enter <a href="/article/nnuf8yv13o-select-delegates-with-selectors#option_select_a_delegate_for_a_connector_using_tags"><strong>Selectors</strong></a> for specific <strong>Delegates</strong> that you want to allow to connect to this Connector. Click <strong>Save and Continue</strong>.</p><h3>Step 4: Test Connection</h3><p>In <strong>Connection</strong> <strong>Test</strong>, click <strong>Finish</strong> after your connection is successful<strong>.</strong></p><p></p><p></p>