<p>You can trigger Pipelines in response to Git events that match specific payload conditions you set up in the Harness Trigger.</p><p>For example, when a pull request or push event occurs on a Git repo and your Trigger settings match the payload conditions, a CI or CD Pipeline can execute.</p><p>In this example, we create a Custom Trigger for GitHub payload conditions.</p><div class="note-callout">This topic covers payload conditions in detail. For a general overview of creating Triggers using Git Events, see <a href="https://ngdocs.harness.io/article/hndnde8usz-triggering-pipelines">Trigger Pipelines using Git Events</a>.</div><p>For general Triggers reference, see <a href="https://ngdocs.harness.io/article/rset0jry8q-triggers-reference">Triggers Reference</a>.</p><h3>Before You Begin</h3><ul><li><a href="https://ngdocs.harness.io/article/hv2758ro4e-learn-harness-key-concepts">Learn Harness&#39; Key Concepts</a></li><li><a href="https://ngdocs.harness.io/article/knunou9j30-kubernetes-cd-quickstart">Kubernetes CD Quickstart</a></li><li><a href="https://ngdocs.harness.io/article/x0d77ktjw8-ci-pipeline-quickstart">CI Pipeline Quickstart</a></li><li><a href="https://ngdocs.harness.io/article/hndnde8usz-triggering-pipelines">Trigger Pipelines using Git Events</a></li></ul><h3>Limitations</h3><ul><li>Currently, Harness supports Git-based Triggers for the most common Git providers. Harness includes a Custom Trigger for other repo providers.</li><li>The <strong>IN</strong> and <strong>NOT IN</strong> operators do not support Regex.</li></ul><h4>Important Notes</h4><ul><li>All Triggers in a Harness account have the same URL. This means that you must set up your Trigger Conditions carefully to ensure that a Pipeline triggers Builds for relevant events only.</li><li>If a Build does not start in response to an incoming event, do the following:<ul><li>Check the execution history (click Execution History in the top right of the Pipeline Studio).</li><li>Verify that the runtime inputs are correct.</li><li>Check the payloads sent from the Git provider and compare the relevant fields with the Conditions in your Triggers. For example, in GitHub you can view the full payload of each event sent from a specific Webhook.</li></ul></li></ul><h3>Step 1: Add a Trigger to a Pipeline</h3><ol><li>Open your Harness Pipeline in <strong>Pipeline Studio</strong>.</li><li>Click <strong>Triggers</strong>.</li><li>Click <strong>New Trigger</strong>.</li><li>Choose your Git SaaS provider, such as <strong>GitHub</strong> or <strong>BitBucket</strong>, or <strong>Custom</strong> if you are using a different provider.</li></ol><h3>Step 2: Configure the Trigger</h3><p>In the Configuration tab of the new Trigger, specify the following:</p><ul><li><strong>Name</strong> and <strong>Description</strong></li><li><strong>Payload Type:</strong> This should match your Git SaaS provider.</li><li><strong>Connector:</strong> A <a href="https://ngdocs.harness.io/category/xyexvcc206" target="_blank">Connector</a> to your Git SaaS provider. (This is required for all Git trigger types except <strong>Custom</strong>.) In the Credentials page of the Connector setup wizard, make sure that API access is selected with the correct permissions.<br/>A Connector is required for all Git trigger types except Custom. For Custom Triggers, you set up the external tool to send paylods to to the Trigger URL. The specific steps to do this vary depending on the external tool</li><li><strong>Event:</strong> Select the Git event type for the Webhook.<br/>If the event type you select results in the <strong>Actions</strong> settings appearing, select the actions for the Webhook or select <strong>Any Actions</strong>.</li><li><strong>Auto-abort Previous Execution:</strong> Use this option if you want to override active Pipeline executions. When the branch of interest is updated, the Pipeline aborts any active Builds on the branch before it launches the new Build.</li></ul><h3>Step 3: Set Trigger Conditions</h3><p>Conditions specify criteria in addition to events and actions.</p><p>Conditions help to form the overall set of criteria to trigger a Pipeline based on changes in a given source.</p><p>Conditions support Harness built-in expressions for accessing Trigger settings, Git payload data, and headers.</p><h4>Option 1: Branches and Changed Files</h4><p>You can configure Triggers based on the source branches, target branches, and changed files in a Git merge.</p><div class="note-callout">If you want to specify multiple paths, use the Regex operator.</div><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/10y3mvkdvk/1653322170386/trigger-conditions-v-2.png"/></figure><h4>Option 2: Header Condition</h4><p>In the Header condition, enter the Git Webhook Header data that matches your value. </p><p>The header expression format is <code>&lt;+trigger.header[&#39;key-name&#39;]&gt;</code>. </p><p>For example: <code>&lt;+trigger.header[&#39;X-GitHub-Event&#39;]&gt;</code>.</p><p>Refer to <a href="/article/rset0jry8q-triggers-reference#built_in_git_trigger_and_payload_expressions" target="_blank">Built-in Git Trigger and Payload Expressions</a> for more trigger expressions in Harness.</p><h4>Option 3: Payload Condition</h4><p>Conditions based on the values of the JSON payload. Harness treats the JSON payload as a data model and parses the payload and listens for events on a JSON payload key.</p><p>To reference payload values, you use <code>&lt;+eventPayload.</code> followed by the path to the key name.</p><p>For example: <code>&lt;+eventPayload.repository.full_name&gt;</code></p><p>For details on Payload Condition, see <a href="https://ngdocs.harness.io/article/rset0jry8q-triggers-reference#payload_conditions">Payload Condition</a>.</p><h4>Option 4: JEXL Condition</h4><p>JEXL expressions are also supported. For example: <code>&lt;+eventPayload.repository.owner.name&gt; == &#34;repositoryOwnerName&#34;</code></p><p>JEXL expressions are also supported. Here are some examples:</p><ul><li><code>&lt;+trigger.payload.pull_request.diff_url&gt;.contains(&#34;triggerNgDemo&#34;)</code></li><li><code>&lt;+trigger.payload.pull_request.diff_url&gt;.contains(&#34;triggerNgDemo&#34;) || &lt;+trigger.payload.repository.owner.name&gt; == &#34;wings-software&#34;</code></li><li><code>&lt;+trigger.payload.pull_request.diff_url&gt;.contains(&#34;triggerNgDemo&#34;) &amp;&amp; (&lt;+trigger.payload.repository.owner.name&gt; == &#34;wings-software&#34; || &lt;+trigger.payload.repository.owner.name&gt; == &#34;harness&#34;)</code></li></ul><p>For details on Trigger settings, see <a href="https://ngdocs.harness.io/article/rset0jry8q-triggers-reference">Triggers Reference</a>.</p><div class="note-callout">If you select multiple conditions, the conditions are ANDed together (boolean AND operation). All Conditions must match an event payload for it to execute the Trigger. If you select any one condition, Trigger will execute based on the condition you entered.</div><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/10y3mvkdvk/1653320703452/trigger-conditions-anded.png" style="max-height:75%;max-width:75%;display:block;margin-left:0;margin-right:auto" data-hd-height="75%" data-hd-width="75%" data-hd-align="left"/></figure><p>Click <strong>Continue</strong>.</p><h3>Step 4: Set Pipeline Input</h3><p>Pipelines often have <a href="https://ngdocs.harness.io/article/f6yobn7iq0-runtime-inputs" target="_blank">Runtime Inputs</a> like codebase branch names or artifact versions and tags.</p><p>Provide values for the inputs. You can also use <a href="https://ngdocs.harness.io/article/3fqwa8et3d-input-sets">Input Sets</a>.</p><p>Click <strong>Create Trigger</strong>.</p><p>The Trigger is now added to the Triggers page.</p><h3>Step 5: Register Webhook in the Git Provider </h3><p>When you create or edit the custom webhook trigger, you need to copy the webook URL and add it to your repo webhooks. However, make sure you have the following permissions for GitHub Personal Access Token for webhook registration to work:</p><ul><li>Scopes: select all the repo, user, and admin:repo_hook options</li></ul><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/10y3mvkdvk/1638175305017/eu-ok-5-sb-rdm-9-hx-ynbpl-9-w-2-sg-35-h-4-hlgr-4-ply-swfg-n-2-wr-ykdjg-0-h-qe-mbkn-yjziwz-g-09-w-6-op-84-p-rt-uk-pjc-so-9-bpql-ykk-0-q-5-th-v-9-phmn-59-zztzytxfg-8-b-cjeoeyhh-hwlm-z-8-z-rzcrk" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p>You should also be repo admin.</p><ol><li>In the <strong>Pipeline Studio</strong>, click <strong>Triggers.</strong></li><li>Select your Custom Webhook.</li><li>Click on Webhook URL icon.</li><li>Click the link button to copy the webhook URL.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/10y3mvkdvk/1649719755964/trigger-copy-url.png" style="display:block;margin-left:0;margin-right:auto" data-hd-align="left"/></figure></li><li>Log in to your repo in the Git provider and navigate to its Webhook settings. <br/>All Webhook URLs in an account have the same format: <code>https://app.harness.io/gateway/ng/api/webhook?accountIdentifier=ACCOUNT_ID</code></li><li>Create a new webhook and paste the URL you copied from Harness in Step 4.</li><li>Make sure that the content type of the outbound requests is <strong>Application/json</strong>.</li><li>Make sure that <strong>Enable verification</strong> is enabled.</li><li>Select the events that you would like to trigger this webhook.<br/>In this example, we select <strong>Just the push event</strong>. It means that this webhook will only be triggered if there is a push event.</li><li>Click <strong>Update webhook</strong>.</li></ol><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/10y3mvkdvk/1638177750696/image.png" style="max-height:90;max-width:90" data-hd-height="90" data-hd-width="90"/></figure><h3>Step 6: Test Trigger</h3><p>Make a change on the repo and push the changes to Github and see if it executes the Trigger. For example, change a file, commit it on the main branch, and make a push event.</p><p>In your Git provider repo, you can see that the request and response were successful.</p><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/10y3mvkdvk/1638177429905/image.png" style="max-height:80%;max-width:80%" data-hd-height="80%" data-hd-width="80%"/></figure><p>Note that the webhook conditions specified in <a href="/article/10y3mvkdvk-trigger-pipelines-using-custom-payload-conditions#step_3_set_trigger_conditions" target="_blank">Step 3</a> match the Payload data. As a result, the Pipeline was triggered.</p><p>In Harness, view the <strong>Pipeline execution</strong>.</p><p>In Harness CI, click <strong>Builds</strong> (1). You can see the source branch (2), target branch (3), and the push request comment and number (4).</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/10y3mvkdvk/1656340605211/webhook-connector-build-fields.png" style="display:block;margin-left:0;margin-right:auto" data-hd-align="left"/></figure><p>Click the push request number and it opens the Git provider repo at the push request.</p><p>If you open the Trigger in the Pipeline, you will see a status in <strong>Last Activation Details</strong>.</p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/10y3mvkdvk/1638175614859/o-yjs-8-uq-ol-39-bla-kznpgmzg-9-t-mzw-yq-8-rr-ecox-msgyc-7-r-hptet-z-o-vryzzo-8-2-wah-2-h-r-f-1-y-0-o-vlt-41-c-z-c-ls-9-scwzn-qlln-1-mw-9-kznb-p-esbf-5-iz-84-zax-1-k-jsi-2-d-w-ufl-utqbbw" style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><p></p><p>Activation indicates that the Trigger was successful in requesting Pipeline execution.</p><h3>See Also</h3><ul><li><a href="https://ngdocs.harness.io/article/rset0jry8q-triggers-reference">Triggers Reference</a></li><li><a href="https://ngdocs.harness.io/article/utikdyxgfz" target="_blank">Harness Git Sync Overview</a></li><li><a href="https://ngdocs.harness.io/article/hndnde8usz" target="_blank">Trigger Pipelines Using Git Events</a></li></ul><p></p>