type: article
article_id: n41cqkjrla
user_id: 2te4j9f9g7
category_id: m8tm1mgn2g
author:
  name: Rashmi Nanda Sahoo
  profile_image: https://www.gravatar.com/avatar/b7bfd905f8714099535f2ff657fa3975?d=mm&s=150
title: Create a Secret Manager Template
slug: create-a-secret-manager-template
description: This topic shows how to add a Secret Manager Template.
short_version: This topic shows how to add a Secret Manager Template.
tags:
- Custom Secret Manager
- Secret Manager Template
- Script Template
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: ""
  source: API
  triggered_at: 2022-09-09T12:15:39.737373Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Create a Secret Manager Template
  description: This topic shows how to add a Secret Manager Template.
  short_version: This topic shows how to add a Secret Manager Template.
  body: '<p>Harness enables you to add Templates to create reusable logic and Harness
    entities like Steps, Stages, Pipelines, and Secret Managers.</p><p>Harness Secret
    Manager Template lets you add a shell script that you can execute either on a
    Delegate or on a remote host which is connected to the Delegate. Harness fetches
    and reads your secrets from the third-party Secret Manager through this shell
    script.</p><p>This topic explains how to create a Secret Manager Template in Harness.</p><h3>Objectives</h3><p>You
    will learn how to:</p><ul><li>Create a Secret Manager Template.</li><li>Add a
    shell script to the Secret Manager Template.</li><li>Configure Input Variables
    for the shell script.</li><li>Use the Secret Manager Template in a Custom Secret
    Manager.</li></ul><h3>Before you begin</h3><ul><li><a href="/article/6tl8zyxeol-template">Templates
    Overview</a></li><li><a href="/article/hngrlb7rd6-harness-secret-manager-overview">Harness
    Secrets Management Overview</a></li></ul><h3>Required permissions</h3><ul><li>Make
    sure you have <strong>Create/Edit</strong> permissions for Templates.</li><li>Make
    sure you have <strong>Create/Edit</strong> permissions for Secrets.</li><li>Make
    sure you have <strong>Create/Edit</strong> permissions for Connectors.</li></ul><h3>Templates
    Overview</h3><ul><li>You can add Secret Manager Templates to Template Libraries
    at any <a href="/article/vz5cq0nfg2-rbac-in-harness#scope">scope</a>.</li><li><a
    href="/article/i8t053o0sq-tags-reference">Tags</a> can be used to group Templates.
    You can search or filter Templates using these tags.</li><li>If you change the
    Template inputs, then you need to update the entities referencing the Template for
    the changes to get reflected.</li></ul><h3>Secret Manager Template scope</h3><p>You
    can add Secret ManagerTemplates at any <a href="/article/vz5cq0nfg2-rbac-in-harness">scope</a> in
    Harness.</p><p>The following table shows what it means to add Templates at different
    scopes or hierarchies:</p><table><tbody><tr><td><p><strong>Scope</strong></p></td><td><p><strong>When
    to add Templates?</strong></p></td></tr><tr><td><p><strong>Account</strong></p></td><td><p>To
    share Secret Manager Templates with users in the Account, as well as users within
    the Organizations and Projects created within this Account.</p></td></tr><tr><td><p><strong>Organization</strong></p></td><td><p>To
    share Secret Manager Templates with users in the Organization as well as within
    the Projects created within the Org.</p></td></tr><tr><td><p><strong>Project</strong></p></td><td><p>To
    share Secret Manager Templates with users within the Project.</p></td></tr></tbody></table><h3>Step
    1: Create a Secret Manager Template</h3><p>You can create a Secret Manager Template
    in Account, Org, or Project scope.​</p><p>This topic shows you how to create a
    Secret Manager Template at the Project scope.​</p><ol><li>In your Harness Account,
    go to your Project.​</li><li>In <strong>Project Setup</strong>, click <strong>Templates</strong>
    and then click <strong>New Template</strong>.​<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/n41cqkjrla/1661432712554/screenshot-2022-08-25-at-5-39-14-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click
    <strong>Secret Manager</strong>. The Secret Manager Template settings appear.​</li><li>Enter
    a <strong>Name</strong> for your Secret Manager Template.​</li><li>In <strong>Version
    Label</strong>, enter the version of the Secret Manager Template.<br/>For example v1. <br/><a
    href="/article/6tl8zyxeol-template">Versioning</a> a Template enables you to create
    a new Template without modifying the existing one. For more information, see <a
    href="/article/6tl8zyxeol-template">Versioning</a>.</li><li>Click <strong>Start</strong>.​<figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/n41cqkjrla/1661432761259/screenshot-2022-08-25-at-5-41-34-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li></ol><h3>Step
    2: Add a shell script to the Secret Manager Template</h3><ol><li>Enter your shell
    script in <strong>Script</strong>.​<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/n41cqkjrla/1661757992321/screenshot-2022-08-29-at-12-55-29-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure>Here
    is an example:<pre class="hljs bash">curl -o secret.json -X GET https://vaultqa.harness.io/v1/&lt;+spec.environmentVariables.engineName&gt;/&lt;+spec.environmentVariables.path&gt;
    -H &#39;X-Vault-Token: &lt;+secrets.getValue(&#34;vaultTokenOne&#34;)&gt;&#39;<br/>secret=$(jq
    -r &#39;.data.&#34;&lt;+spec.environmentVariables.key&gt;&#34;&#39; secret.json)</pre>In
    this example, this script assigns the secret variable to your final value. Here
    are the details of the entries in the script.<ul><li>This script makes a cURL
    call to the API URL of the third-party Secrets Manager and gets the output to
    the file secret.json. </li><li>It includes some parameters such as engine name
    and path. </li><li>It uses an existing, already configured Secrets Manager for
    API access.</li><li>After getting the file, as shown in the example, it gets the
    secret by using a third-party tool to retrieve the key from the data object. The
    key is also a parameter that can be assigned later.</li></ul><div class="note-callout">Make
    sure the output variable is always named <code>secret</code> and is used to store
    the result fetched after executing the cURL command.</div></li></ol><h3>Configure
    Input Variables for the shell script</h3><p>All the parameters (engine name, path,
    and key in this case) can be defined as Input Variables while creating or editing
    the Secret Manager Template.</p><p>To do this, perform the following steps:</p><ol><li>Click
    <strong>Configuration</strong> and click <strong>Add Input Variable</strong>.</li><li>Add
    <strong>Name</strong>, <strong>Type</strong>, and <strong>Value</strong> for the
    Input Variables in your script.<br/>Harness allows you to use <a href="https://docs.harness.io/article/f6yobn7iq0-runtime-inputs">Fixed
    Values and Runtime Inputs</a>.</li></ol><figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/n41cqkjrla/1661760011284/screenshot-2022-08-29-at-1-29-20-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure><ol><li
    style="counter-increment:li 2" start="3">Select <strong>Execution Target</strong>.
    This is where you want to execute the script that you just added.<br/>If you want
    to run the Shell Script on a target host and not on the Harness Delegate, you
    must first create the required connection attributes.<br/>To access an SSH-based
    Custom Secrets Manager, create an SSH credential first. See <a href="/article/xmp9j0dk8b-add-use-ssh-secrets">Add
    SSH Keys</a> for the procedure to create SSH credentials.<br/>This does not apply
    if you want to run the Custom Secrets Manager on the Harness Delegate.<ol><li>Select
    <strong>Specify Host</strong> to execute the script on a specific host.<figure><img
    src="https://files.helpdocs.io/kw8ldg1itf/articles/n41cqkjrla/1661762431468/screenshot-2022-08-29-at-2-09-46-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure>In
    <strong>Target Host</strong>, enter the host address.<br/>In <strong>SSH Connection
    Attribute</strong>, create or select an existing secret that has the SSh credential
    as its value.<br/>In <strong>Working Directory</strong>, enter the directory name.</li><li>Select
    <strong>Delegate</strong>, to execute the script on a specific Delegate.</li></ol></li><li>Click
    <strong>Save</strong>. Your Secret Manager Template is now listed in the Template
    Library.</li></ol><h3>See also</h3><ul><li><a href="/article/mg09uspsx1-custom-secret-manager">Add
    a Custom Secret Manager</a></li></ul><p></p>'
  slug: create-a-secret-manager-template
  tags:
  - Custom Secret Manager
  - Secret Manager Template
  - Script Template
  is_live: true
