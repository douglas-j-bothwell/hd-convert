type: article
article_id: 6r8hin2z20
user_id: 2te4j9f9g7
category_id: fe0577j8ie
author:
  name: Rashmi Nanda Sahoo
  profile_image: https://www.gravatar.com/avatar/b7bfd905f8714099535f2ff657fa3975?d=mm&s=150
title: Provision Users and Groups using Azure AD (SCIM)
slug: provision-users-and-groups-using-azure-ad-scim
description: Explains how to use Harness' SCIM integration with Azure Active Directory
  (AD) to automatically provision users and/or groups.
short_version: Explains how to use Harness' SCIM integration with Azure Active Directory
  (AD) to automatically provision users and/or groups.
tags:
- Platform
- AccessManagement
show_toc: true
is_private: false
is_published: true
is_featured: false
stale_status:
  is_stale: false
  reason: ""
  source: API
  triggered_at: 2022-09-14T16:11:20.484978Z
  expires_at: null
permission_groups: []
multilingual:
- language_code: en
  title: Provision Users and Groups using Azure AD (SCIM)
  description: Explains how to use Harness' SCIM integration with Azure Active Directory
    (AD) to automatically provision users and/or groups.
  short_version: Explains how to use Harness' SCIM integration with Azure Active Directory
    (AD) to automatically provision users and/or groups.
  body: '<p>System for Cross-Domain Identity Management (SCIM) is an open standard
    protocol for the automation of user provisioning.</p><p>Automatic provisioning
    refers to creating users and user groups in Harness. In addition to creating these,
    automatic provisioning includes the maintenance and removal of users and user
    groups as and when required.</p><p>This topic explains how to configure Azure
    Active Directory (Azure AD) to automatically provision users or groups to Harness.</p><p>In
    this topic:</p><ul><li><a href="#before_you_begin">Before You Begin</a></li><li><a
    href="#review_harness_azure_ad_scim_integration">Review: Harness Azure AD SCIM
    Integration</a><ul><li><a href="#features_supported">Features Supported</a></li></ul></li><li><a
    href="#limitations">Limitations</a></li><li><a href="#step_1_add_harness_from_the_gallery">Step
    1: Add Harness from the Gallery</a></li><li><a href="#step_2_provision_users_to_harness">Step
    2: Provision Users to Harness</a></li><li><a href="#copy_groups">Copy Groups</a></li></ul><h3>Before
    You Begin</h3><ul><li>This topic assumes you understand the System for Cross-domain
    Identity Management (SCIM). For an overview, see the article <a href="https://medium.com/@pamodaaw/system-for-cross-domain-identity-management-scim-def45ea83ae7"
    target="_blank">Introduction to System for Cross-domain Identity Management (SCIM)</a>.</li><li><a
    href="https://newdocs.helpdocs.io/article/hv2758ro4e-learn-harness-key-concepts">Learn
    Harness&#39; Key Concepts</a></li><li><a href="https://newdocs.helpdocs.io/article/vz5cq0nfg2-rbac-in-harness">Access
    Management (RBAC) Overview</a></li><li>Make sure you are an Administrator in your
    Azure AD account and have the <strong>Account Admin</strong> permissions in Harness.</li><li>Make
    sure you have a Harness <a href="/article/tdoad7xrh9-add-and-manage-api-keys">API
    Key</a> and a valid Token under it. The API Key must have all permissions on the
    Users and User Groups.</li></ul><h3>Review: Harness Azure AD SCIM Integration</h3><p>By
    using Azure AD as your identity provider, you can efficiently provision and manage
    users in your Harness Account, Org and Project. Harness&#39; <a href="https://www.okta.com/blog/2017/01/what-is-scim/"
    target="_blank">SCIM</a> integration enables Azure AD to serve as a single identity
    manager, for adding and removing users, and for provisioning User Groups. This
    is especially efficient for managing many users.</p><p>In exchange for the convenience
    of Azure AD-provisioned users and groups, you must configure several aspects of
    Azure AD, as described in the following sections. You will also have restrictions
    on modifying Azure AD-provisioned users and groups natively within Harness, as
    described in <a href="#limitations">Limitations</a>.</p><h4>Features Supported</h4><p>Once
    you have set up the SCIM integration between Azure AD and Harness (as described
    below), Administrators will be able to perform the following Harness actions within
    Azure AD:</p><ul><li>Create users, individually, in your Harness app.</li><li>Assign
    Azure AD-defined groups to your Harness app.</li><li>Group push already-assigned
    groups to Harness.</li><li>Update User Attributes from Azure AD to Harness.</li><li>Deactivate
    Users in Azure AD and Harness.</li></ul><h3>Limitations</h3><p>This integration
    does not support updating a configured user&#39;s <strong>Primary email</strong> or <strong>Username</strong> in
    Azure AD. (However, you can freely update the <strong>Display name</strong> field.</p><p>When
    you provision Harness User Groups and users from Azure AD, you will not be able
    to modify some of their attributes in Harness Manager. You must do so in Azure
    AD.</p><p>Operations that you <em>cannot</em> perform on Azure AD-provisioned
    User Groups within Harness Manager are:</p><ul><li>Managing users within the User
    Group.</li><li>Adding users to the User Group.</li><li>Removing users from the
    User Group.</li><li>Renaming the User Group.</li><li>Deleting the User Group.</li></ul><p>If
    a User Group provisioned from Azure AD duplicates the name of an existing Harness
    User Group, Harness will maintain both groups. To prevent confusion, you are free
    to rename the native User Group (but not the Azure AD-provisioned group).</p><p>Where
    a User Group has been provisioned from Azure AD, you cannot use Harness Manager
    to edit the member users&#39; details (<strong>Email Address</strong>, <strong>Full Name</strong>,
    or <strong>User Groups</strong> assignments).</p><p>You must use Azure AD to assign
    these users to other User Groups (to grant corresponding permissions). You must
    also use Azure AD to delete these users from Harness, by removing them from the
    corresponding Azure AD app.</p><div class="tip-callout">When you use Azure AD
    to directly assign users to Harness, those users initially have no User Group
    assignments in Harness. With this method, you are free to use Harness Manager
    to add and modify User Group assignments.</div><h3>Step 1: Add Harness from the
    Gallery</h3><p>Before you configure Harness for automatic user provisioning with
    Azure AD, you need to add Harness from the Azure AD application gallery to your
    list of managed SaaS applications.</p><ol><li>In the <a href="https://portal.azure.com/">Azure
    portal</a>, in the left pane, select <strong>Azure Active Directory</strong>.<figure><img
    src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643020693486/screenshot-2022-01-24-at-4-07-08-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Select <strong>Enterprise
    applications</strong> &gt; <strong>All applications</strong>.</li><li>Click <strong>New
    application</strong> to add a new application.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643021057746/screenshot-2022-01-24-at-4-13-06-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>In
    the search box, enter <strong>Harness</strong>, select <strong>Harness</strong> in
    the results list, and then select the <strong>Add</strong> button to add the application.
    You can now provision users to Harness.</li></ol><h3>Step 2: Provision Users to
    Harness</h3><ol><li>In your Azure portal, go to Enterprise Applications &gt; All
    applications.</li><li>In the applications list, select <strong>Harness</strong>.</li><li>Select <strong>Provisioning</strong>.<figure><img
    src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643021509106/screenshot-2022-01-24-at-4-20-38-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>In
    the <strong>Provisioning Mode</strong> drop-down list, select <strong>Automatic</strong>.</li><li>Under <strong>Admin
    Credentials</strong>, do the following:<ol><li>In the <strong>Tenant URL</strong> box,
    enter <code>https://app.harness.io/gateway/ng/api/scim/account/&lt;your_harness_account_ID&gt;</code>.<br/>You
    can obtain your Harness account ID from the <strong>Account Overview</strong>
    of your Harness account.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643021974887/screenshot-2022-01-24-at-10-24-06-am.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>In
    the <strong>Secret Token</strong> box, enter the SCIM Authentication Token value.
    This is your Harness API token within your API Key. Make sure this key&#39;s permissions
    are inherited from the <strong>Account Administrator</strong> User Group.<br/>For
    more information on how to create API token, see <a href="/article/tdoad7xrh9-add-and-manage-api-keys">Add
    and Manage API Keys</a>.</li><li>Select <strong>Test Connection</strong> to ensure
    that Azure AD can connect to Harness.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643040979573/screenshot-2022-01-21-at-6-26-24-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure>If
    the connection fails, ensure that your Harness account has Admin permissions,
    and then try again.</li></ol></li><li>In <strong>Settings</strong>, in the <strong>Notification
    Email</strong> box, enter the email address of a person or group that should receive
    the provisioning error notifications.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643041846028/screenshot-2022-01-24-at-9-58-47-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Select <strong>Save</strong>.</li><li>Under <strong>Mappings</strong>,
    enable <strong>Provision Azure Active Directory Groups,</strong> and <strong>Provision
    Azure Active Directory Users</strong>.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643042438054/screenshot-2022-01-24-at-10-08-04-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click
    <strong>Provision Azure Active Directory Users</strong>.</li><li>Under <strong>Attribute
    Mappings</strong>, review the user attributes that are synchronized from Azure
    AD to Harness. The attributes selected as <em>Matching</em> are used to match
    the user accounts in Harness for update operations. Select <strong>Save</strong> to
    commit any changes.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643042936200/screenshot-2022-01-24-at-10-18-13-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>In
    <strong>Provisioning</strong>, click <strong>Provision Azure Active Directory
    Groups</strong>.</li><li>Under <strong>Attribute Mappings</strong>, review the
    group attributes that are synchronized from Azure AD to Harness. The attributes
    selected as <em>Matching</em> properties are used to match the groups in Harness
    for update operations. Select <strong>Save</strong> to commit any changes.<figure><img
    src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643043238804/screenshot-2022-01-24-at-10-23-16-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>To
    configure scoping filters, see <a href="https://docs.microsoft.com/en-us/azure/active-directory/app-provisioning/define-conditional-rules-for-provisioning-user-accounts">Attribute-based
    application provisioning with scoping filters</a>.</li><li>In <strong>Provisioning</strong>,
    under <strong>Settings</strong>, to enable the Azure AD provisioning service for
    Harness, toggle the <strong>Provisioning Status</strong> switch to <strong>On</strong>.<figure><img
    src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643043452900/screenshot-2022-01-24-at-10-26-30-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Under <strong>Settings</strong>,
    in the <strong>Scope</strong> drop-down list, select how you want to sync the
    users or groups that you&#39;re provisioning to Harness.<figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/6r8hin2z20/1643043617564/screenshot-2022-01-24-at-10-28-28-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li><li>Click
    <strong>Save</strong>.</li></ol><p>This operation starts the initial sync of the
    users or groups you&#39;re provisioning. The initial sync takes longer to perform
    than later ones. Syncs occur approximately every 40 minutes, as long as the Azure
    AD provisioning service is running. To monitor progress, go to the <strong>Synchronization
    Details</strong> section. You can also follow links to a provisioning activity
    report, which describes all actions performed by the Azure AD provisioning service
    on Harness.</p><p>For more information about how to read the Azure AD provisioning
    logs, see <a href="https://docs.microsoft.com/en-us/azure/active-directory/app-provisioning/check-status-user-account-provisioning">Report
    on automatic user account provisioning</a>.</p><h3>What If I Already Have App
    Integration for Harness FirstGen?</h3><p>If you currently have a Harness FirstGen
    App Integration setup in your IDP and are now trying to set up one for Harness
    NextGen, make sure the user information is also included in the FirstGen App Integration
    before attempting to log into Harness NextGen through SSO.</p><div class="note-callout">Harness
    authenticates users using either the FirstGen App Integration or the NextGen App
    Integration. If you have set up both, Harness continues to use your existing App
    Integration in FirstGen to authenticate users that attempt to log in using SSO.</div><p>Let
    us look at the following example:</p><ol><li>An App Integration is already set
    up for FirstGen with 2 users as members:<br/><code>user1@example.com</code> and
    <code>user2@example.com</code>.</li><li>Now you set up a separate App Integration
    for Harness NextGen and add <code>user1@example.com</code> and <code>user_2@example.com</code>
    as the members.</li><li>You provision these users to Harness NextGen through SCIM.</li><li><code>user1@example.com</code>
    and <code>user_2@example.com</code> try to log in to Harness NextGen through SSO.</li><li>The
    FirstGen App Integration is used for user authentication.<br/><code>user1@example.com</code>
    is a member of the FirstGen App Integration and hence is authenticated and successfully
    logged in to Harness NextGen.<br/><code>user_2@example.com</code> is not a member
    of the FirstGen App Integration, hence the authentication fails and the user cannot
    log in to Harness NextGen.<figure><img src="https://files.helpdocs.io/kw8ldg1itf/articles/umv2xdnofv/1659510080231/screenshot-2022-08-03-at-12-30-23-pm.png"
    style="max-height:50%;max-width:50%" data-hd-height="50%" data-hd-width="50%"/></figure></li></ol><p></p>'
  slug: provision-users-and-groups-using-azure-ad-scim
  tags:
  - Platform
  - AccessManagement
  is_live: true
