<p>Remove any deployed Kubernetes resources with the <strong>K8s Delete</strong> step.</p><div class="note-callout">Looking for Canary Delete? See <a href="/article/922mtcvank-kubernetes-delegate-step">Canary Delete Step</a>.</div><h3>Before You Begin</h3><ul><li> <a href="/article/ssbq0xh0hx-define-kubernetes-manifests">Define Kubernetes Manifests</a></li><li> <a href="/article/i5p4feil89-create-a-kubernetes-canary-deployment">Create a Kubernetes Canary Deployment</a></li><li> <a href="/article/mog5tnk5pi-create-a-kubernetes-blue-green-deployment">Create a Kubernetes Blue/Green Deployment</a></li><li> <a href="/article/xsla71qg8t-create-a-kubernetes-rolling-deployment">Create a Kubernetes Rolling Deployment</a></li></ul><h3>Where to add the Kubernetes Delete Step</h3><p>You can add a Kubernetes Delete step anywhere in your Pipeline, but the resource you want to delete must already exist by the time Pipeline execution reaches the Kubernetes Delete step.</p><p>If you are using a Kubernetes Apply step, Canary Deployment, Rolling Deployment, or some provisioning step to create resources, ensure that you only add the Kubernetes Delete step after its target resource is created.</p><h3>Step 1: Add Delete Step</h3><p>In your Harness stage Execution, click <strong>Add Step</strong>, and select <strong>K8s</strong> <strong>Delete</strong>. The K8s Delete settings appear:</p><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/eaj0xuegln/1629243266634/clean-shot-2021-08-17-at-16-34-16.png"/></figure><p>You can add a K8s Delete step anywhere in your stage.</p><p>Enter a name for the step.</p><h3>Step 2: Select Resources to Delete</h3><p>In <strong>Delete resources by</strong>, select how you want to select the resources to be deleted.</p><p>There are a few ways to specify the resource to be removed.</p><h4>Option: Resource Name</h4><p>Identify a resource name in the format <code>[namespace]/Kind/Name</code>, with <code>namespace</code> being optional.</p><p>You must add a <code>Kind</code> before the resource name, like this: </p><p><code>Deployment/harness-example-deployment-canary</code></p><p>Enter multiple resources using <strong>Add</strong>.</p><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/eaj0xuegln/1629312559709/clean-shot-2021-08-18-at-11-48-49.png"/></figure><p>To delete all resources, use the <strong>Release Name</strong> option, explained below.</p><h4>Option: Manifest Path</h4><p>Enter the path to the manifest for the resource you want to delete. The path is relative to the folder path entered in <strong>File/Folder Path</strong> in the <strong>Manifest Details</strong> settings:</p><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/eaj0xuegln/1629312597584/clean-shot-2021-08-18-at-11-49-44.png"/></figure><p>Enter multiple resources using <strong>Add File</strong>.</p><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/eaj0xuegln/1629312682513/clean-shot-2021-08-18-at-11-51-16.png"/></figure><p></p><h4>Option: Release Name</h4><p>During deployment Harness creates a ConfigMap listing the resources of the release and uses the release name for tracking them. The release name is defined in the <strong>Infrastructure</strong> settings, in <strong>Cluster Details</strong>, in <strong>Advanced</strong>.</p><p>If you want to delete all of the resources for a release, select <strong>Release Name</strong>.</p><p>If you select the <strong>Delete namespace</strong> option, Harness will delete the namespace(s) defined in the release.</p><p></p><figure><img src="https://files.helpdocs.io/i5nl071jo5/articles/eaj0xuegln/1629313001220/clean-shot-2021-08-18-at-11-56-34.png"/></figure><div class="warning-callout">Ensure that you are not deleting a namespace that is used by other deployments.</div><p></p><h3>Example: Deleting a Deployment</h3><p>Here is an example of the log from a Delete command:</p><pre class="hljs sql">Initializing..<br/>...<br/>Resources to delete are: <br/>- Deployment/harness-example-deployment-canary<br/>Done.</pre><h3>Example 2: Deleting All Resources and Namespaces</h3><p>Here is an example deleting all resources in the release and the namespace:</p><pre class="hljs sql">All Resources are selected for deletion<br/>Delete Namespace is set to: true<br/>Fetching all resources created for release: release-44e74aca-279f-3b4a-bb15-06d750393a8d<br/><br/>Resources to delete are: <br/>- adwait-12/Deployment/harness-example-deployment<br/>- adwait-12/Service/harness-example-svc<br/>- adwait-12/ConfigMap/release-44e74aca-279f-3b4a-bb15-06d750393a8d<br/>- adwait-12/ConfigMap/harness-example-2<br/>- adwait-12/ConfigMap/harness-example-1<br/>- adwait-12/Secret/harness-example-2<br/>- adwait-12/Secret/harness-example-1<br/>- adwait-12/Namespace/adwait-12<br/>Done.</pre><h3>Notes</h3><ul><li><strong>Delete and Traffic Management</strong>: If you are splitting traffic using the <strong>Apply step</strong>, move the <strong>K8s</strong> <strong>Delete</strong> step after the traffic shifting. This will prevent any traffic from being routed to deleted pods before traffic is routed to stable pods.</li></ul><h3>See Also</h3><ul><li><a href="/article/922mtcvank-kubernetes-delegate-step">Canary Delete Step</a></li></ul><p></p>